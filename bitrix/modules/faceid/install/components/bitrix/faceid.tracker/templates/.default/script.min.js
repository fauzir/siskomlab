var domNode=BX.create("script",{attrs:{src:"/bitrix/js/main/webrtc/adapter.js",type:"text/javascript"}});document.head.insertBefore(domNode,document.head.firstChild);var jsDetectionInProgress=false;var Module,isModuleInitialized,isBxFaceIdInitialized;if(typeof Module==="undefined"){Module={}}Module.onRuntimeInitialized=function(){isModuleInitialized=true;_BXFaceIdStart()};function BXFaceIdStart(){isBxFaceIdInitialized=true;_BXFaceIdStart()}function _BXFaceIdStart(){if(!isModuleInitialized||!isBxFaceIdInitialized){return}var e=false;var a=false;var t=null;var r=null;var s=null;var c=null;var n=BX.localStorage.get("faceid-default-camera");var d=null;var o={cameraRatio:0,screenRatio:window.screen.width/window.screen.height,cameraSmallWidth:340,cameraSmallHeight:0,cameraFullWidth:0,cameraFullHeight:0,snapshotWidth:640,snapshotHeight:0,trackingSmallRatio:0,trackingFullRatio:0,cameraWidth:0,cameraHeight:0,trackingRatio:0};var l=null;var f=null;var u=[];var m={};var h=new Module.WebPhotoMakerM;h.setStopAfterBestShot(true);h.setMovementThreshold(.03);h.setBestShotScoreThreshold(.05);h.setRotationThreshold(50);h.setMinFaceScaleFactor(.15);h.setMaxNumberOfFramesWithoutDetection(8);var v=o.snapshotWidth*o.snapshotWidth*4;var g=Module._malloc(v);var p=new Uint8ClampedArray(Module.HEAPU8.buffer,g,v);var k=[-1,-1,-1,-1,-1,-1];var B=["","","","","",""];function X(){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices){b(BX.message("FACEID_TRACKER_CMP_JS_CAMERA_ERROR"));return}navigator.mediaDevices.enumerateDevices().then(function(e){var a=document.getElementById("faceid-cameralist");var i="faceid-tracker-sidebar-photo-settings-checked";e.forEach(function(e){if(e.kind=="videoinput"){if(n==null){n=e.deviceId;BX.localStorage.set("faceid-default-camera",n,3600*24*360)}var t="faceid-tracker-sidebar-photo-settings-inner-list-item";var r=e.label.replace(/\(\w{4}:\w{4}\)/g,"");if(!r.length){r=BX.message("FACEID_TRACKER_CMP_JS_CAMERA_DEFAULT")}if(e.deviceId==n){t+=" "+i}var s=BX.create("div",{text:r,attrs:{"class":t,"data-camera-id":e.deviceId}});a.appendChild(s);BX.bind(s,"click",function(){if(BX.hasClass(BX(this),i)){return}var e,t=BX.findChildren(a);for(e in t){BX.removeClass(t[e],i)}BX.addClass(BX(this),i);n=this.getAttribute("data-camera-id");BX.localStorage.set("faceid-default-camera",n,3600*24*360);_();BX.toggle(BX("faceid-settings-container"))})}});C()}).catch(function(e){console.log(e.name+": "+e.message);b(BX.message("FACEID_TRACKER_CMP_JS_CAMERA_ERROR"))})}if(window.FACEID_AGREEMENT){X()}BX.bind(BX("faceid-settings-button"),"click",function(){BX.toggle(BX("faceid-settings-container"))});function _(){navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;navigator.getMedia({video:{deviceId:{exact:n}},audio:false},function(e){if(navigator.mozGetUserMedia){t.mozSrcObject=e}else{var a=window.URL||window.webkitURL;t.src=a.createObjectURL(e)}t.play()},function(e){console.log("An error occured! "+e);BX.localStorage.remove("faceid-default-camera");var a;if(e.toString().indexOf("DevicesNotFound")>=0){a=BX.message("FACEID_TRACKER_CMP_JS_CAMERA_NOT_FOUND")}else{a=BX.message("FACEID_TRACKER_CMP_JS_CAMERA_NO_SUPPORT")}b(a)})}function C(){t=document.getElementById("faceid-video");r=document.getElementById("faceid-canvas");c=document.getElementById("faceid-startbutton");_();l=document.getElementById("faceid-overlay-face-border");f=l.getContext("2d");t.addEventListener("canplay",function(e){if(!a){o.cameraRatio=t.videoWidth/t.videoHeight;o.cameraSmallHeight=t.videoHeight/(t.videoWidth/o.cameraSmallWidth);if(o.screenRatio>=o.cameraRatio){o.cameraFullHeight=window.screen.height;o.cameraFullWidth=t.videoWidth/(t.videoHeight/o.cameraFullHeight)}else{o.cameraFullWidth=window.screen.width;o.cameraFullHeight=t.videoHeight/(t.videoWidth/o.cameraFullWidth)}o.snapshotHeight=t.videoHeight/(t.videoWidth/o.snapshotWidth);o.trackingSmallRatio=o.cameraSmallWidth/o.snapshotWidth;o.trackingFullRatio=o.cameraFullWidth/o.snapshotWidth;o.cameraWidth=o.cameraSmallWidth;o.cameraHeight=o.cameraSmallHeight;o.trackingRatio=o.trackingSmallRatio;t.setAttribute("width",o.cameraWidth);t.setAttribute("height",o.cameraHeight);r.setAttribute("width",o.snapshotWidth);r.setAttribute("height",o.snapshotHeight);l.setAttribute("width",o.cameraWidth);l.setAttribute("height",o.cameraHeight);a=true;A()}},false);c.addEventListener("click",function(e){w();e.preventDefault()},false);if(window.FACEID_LAST_VISITORS){for(i in window.FACEID_LAST_VISITORS){y(window.FACEID_LAST_VISITORS[i],false)}}}function b(e){BX("faceid-camera-error").innerHTML=e;BX.show(BX("faceid-camera-error"))}function A(){requestAnimationFrame(A);if($("#faceid-auto-identify").prop("checked")==false){return}if(e){return}if(u.length){}e=true;var a=r.getContext("2d");a.drawImage(t,0,0,o.snapshotWidth,o.snapshotHeight);var i=r.toDataURL("image/jpeg",1);var s=new Image;s.onload=function(){var a=T(r,true);if(a.length>0){var i=[];for(var t in a){if(!m[a[t].frameId]&&h.getBestShotFrameNumber(a[t].frameId)>=0&&h.getCurrentFrameNumber()>=h.getBestShotFrameNumber(a[t].frameId)){i.push(a[t])}}if(i.length){x(i,s)}}e=false};s.onerror=function(){e=false};s.src=i;requestAnimationFrame(A)}function S(e){for(var a=0;a<k.length;a++){var i=0;for(var t=0;t<e.length;t++){if(e[t]!=k[a])i++;else break}if(i==e.length){k[a]=-1;B[a]=""}}for(var t=0;t<e.length;t++){var r=true;for(var a=0;a<k.length;a++){if(e[t]==k[a]){r=false;break}}if(r){for(var a=0;a<k.length;a++){if(k[a]==-1){k[a]=e[t];break}}}}}function R(e,a,i,t,r){e.save();e.strokeStyle="rgba("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")";e.lineWidth=3;try{var s=a.x;var c=a.y;var n=a.x+a.width;var d=a.y+a.height;var o=i;var l=Math.PI/180;if(n-s-2*o<0){o=(n-s)/2}if(d-c-2*o<0){o=(d-c)/2}e.beginPath();e.moveTo(s+o,c);e.lineTo(n-o,c);e.arc(n-o,c+o,o,l*270,l*360,false);e.lineTo(n,d-o);e.arc(n-o,d-o,o,l*0,l*90,false);e.lineTo(s+o,d);e.arc(s+o,d-o,o,l*90,l*180,false);e.lineTo(s,c+o);e.arc(s+o,c+o,o,l*180,l*270,false);e.closePath();e.font="bold 11px opensans";e.fillStyle="#91ff4f";var f="";if(m[r]){f=m[r].name}e.fillText(f.toUpperCase(),s,c-5);e.stroke();e.restore()}catch(u){console.log("BAD VALUE OF DETECTION");console.log(u)}}function w(e){if(!e){var a=r.getContext("2d");a.drawImage(t,0,0,o.snapshotWidth,o.snapshotHeight);e=r.toDataURL("image/jpeg",1)}var i=new Image;i.onload=function(){var e=true;if(e){var a=T(r);x(a,i)}else{E(i.getAttribute("src"))}};i.src=e}function T(e,a){var i=[];var r=e.getContext("2d");r.drawImage(t,0,0,o.snapshotWidth,o.snapshotHeight);var s=e;var c=s.getContext("2d");var n=c.getImageData(0,0,o.snapshotWidth,o.snapshotHeight);p.set(n.data,0);h.submitRawImage(g,o.snapshotWidth,o.snapshotHeight);h.update();f.clearRect(0,0,l.width,l.height);var d=h.getIds();var m=JSON.parse(d);var v=m["ids"];S(v);if(v.length){for(var k=0;k<v.length;k++){var B=v[k];var X=h.getSmoothedFaceDetection(B);var _=h.faceDetectionIsPredicted(B);var C=[145,255,79,255];var b="";var A=h.isSlowMovement(B);if(!A)b="TOO FAST!!!";if(_)b="PREDICT";if(_||!A){C=[255,0,0,255]}var w=JSON.parse(JSON.stringify(X));w.x=X.x*o.trackingRatio;w.y=X.y*o.trackingRatio;w.width=X.width*o.trackingRatio;w.height=X.height*o.trackingRatio;R(f,w,10,C,B);if(u.indexOf(B)==-1){i.push({frameId:B,width:X.width,height:X.height,positionX:X.x,positionY:X.y})}}}if(!a){I()}return i}function I(){requestAnimationFrame(function(){requestAnimationFrame(function(){h.reset();f.clearRect(0,0,l.width,l.height)})})}function x(e,a){var t=false;if(e.length>0){for(i=0;i<e.length;i++){{var r=e[i];var s=document.createElement("canvas");s.setAttribute("width",100);s.setAttribute("height",100);var c=s.getContext("2d");var n=.6;var d=Math.max(0,r.positionX-r.width*n/2);var o=Math.max(0,r.positionY-r.height*n/2);var l=r.width+r.width*n;var f=r.height+r.height*n;var u=100;var m=100;var h=0;var v=0;c.drawImage(a,d,o,l,f,h,v,u,m);var g=s.toDataURL("image/jpeg");E(g,r.frameId);t=true}}}if(!t){E(a.src,false,true)}}function E(e,a,i){BX.addClass(BX("faceid-tracker-main-user-start-block"),"faceid-tracker-animate-hidden");var t=BX.create("div",{attrs:{"class":"faceid-tracker-main-user-item faceid-tracker-first-item"}});t.innerHTML='<div class="faceid-tracker-main-user-photo"> 					<div class="faceid-tracker-main-user-photo-platform"> 						<span class="faceid-tracker-main-user-photo-platform-item">CRM</span> 					</div> 					<div class="faceid-tracker-main-user-photo-item"> 						<img width="100" height="100"> 					</div> 					<div class="faceid-tracker-main-user-photo-count"> 						<span class="faceid-tracker-main-user-photo-count-item">58%</span> 						<div class="faceid-tracker-main-user-photo-count-info"> 							<div class="faceid-tracker-main-user-photo-count-info-desc"></div> 							<div class="faceid-tracker-main-user-photo-item"></div> 						</div> 					</div> 				</div> 				<div class="faceid-tracker-main-user-info"> 					<div class="faceid-tracker-user-loader"> 						<div class="faceid-tracker-user-loader-item"> 							<div class="faceid-tracker-loader"> 								<svg class="faceid-tracker-circular" viewBox="25 25 50 50"> 									<circle class="faceid-tracker-path" cx="50" cy="50" r="20" fill="none" stroke-width="1" stroke-miterlimit="10"/> 								</svg> 							</div> 						</div> 					</div> 				</div>';BX.prepend(t,BX("faceid-tracker-main-user-container"));var r=20;var s=BX.findChildren(BX("faceid-tracker-main-user-container"),{"class":"faceid-tracker-main-user-item"});if(s.length>r){d=s[s.length-2].getAttribute("data-last-visit-ts");var c=s[s.length-1];c.remove()}var n=BX.findChild(t,{"class":"faceid-tracker-main-user-photo-item"},true);var o=BX.findChild(n,{tag:"img"});o.setAttribute("src",e);if(i){BX.addClass(t,"faceid-tracker-user-warning");var l=BX.findChild(t,{"class":"faceid-tracker-main-user-info"},true);l.innerHTML='<div class="faceid-tracker-main-user-info-name"> 				<div class="faceid-tracker-main-user-info-name-warning">'+BX.message("FACEID_TRACKER_CMP_JS_FACE_NOT_FOUND")+"</div> 			</div>"}else{var f=a>=0?a:"faceid-ajax-unique-"+Math.random();M(f);BX.ajax({url:"/bitrix/components/bitrix/faceid.tracker/ajax.php",method:"POST",data:{action:"identify",image:e},dataType:"json",processData:false,start:true,onsuccess:function(i){F(f);var r=false;var s=BX.message("FACEID_TRACKER_CMP_JS_FACE_NOT_FOUND");if(i.length){var c=JSON.parse(i);if(c.visitor&&!W(c.visitor)){r=true;var n=c.visitor;n.image_src=n.shot_src;n.shot_src=e;var d=H(t,n);if(a>=0){m[a]={name:n.name}}if(d){O(n)}}else if(c.error&&c.error.msg){s=c.error.msg}if(c.status&&c.status.balance>=0){BX("faceid-credits-balance").innerText=c.status.balance}}if(!r){h.discardBestShot(a);BX.addClass(t,"faceid-tracker-user-warning");var o=BX.findChild(t,{"class":"faceid-tracker-main-user-info"},true);o.innerHTML='<div class="faceid-tracker-main-user-info-name"> 							<div class="faceid-tracker-main-user-info-name-warning">'+s+"</div> 						</div>"}},onfailure:function(){F(f);h.discardBestShot(a)}})}}function M(e){u.push(e)}function F(e){var a=u.indexOf(e);if(a>-1){u.splice(a,1)}}function y(e,a){BX.addClass(BX("faceid-tracker-main-user-start-block"),"faceid-tracker-animate-hidden");var i=BX.create("div",{attrs:{"class":"faceid-tracker-main-user-item faceid-tracker-first-item"}});var t=H(i,e);BX.prepend(i,BX("faceid-tracker-main-user-container"));if(e.last_visit_ts<d||d==null){d=e.last_visit_ts}if(t){O(e,a)}}function D(e,a){BX.addClass(BX("faceid-tracker-main-user-start-block"),"faceid-tracker-animate-hidden");var i=BX.create("div",{attrs:{"class":"faceid-tracker-main-user-item faceid-tracker-first-item"}});var t=H(i,e);if(BX("faceid-tracker-main-user-more")){BX("faceid-tracker-main-user-container").insertBefore(i,BX("faceid-tracker-main-user-more"))}else{BX.append(i,BX("faceid-tracker-main-user-container"))}if(e.last_visit_ts<d||d==null){d=e.last_visit_ts}if(t){O(e,a)}}function O(e,a){a=typeof a!=="undefined"?a:true;BX("faceid-stats-current-count").innerText=parseInt(BX("faceid-stats-current-count").innerText)+1;if(a){if(e.visits_count<=1){BX("faceid-stats-new-count").innerText=parseInt(BX("faceid-stats-new-count").innerText)+1}else{BX("faceid-stats-old-count").innerText=parseInt(BX("faceid-stats-old-count").innerText)+1}BX("faceid-stats-total-count").innerText=parseInt(BX("faceid-stats-total-count").innerText)+1;if(e.crm_url.length){BX("faceid-stats-crm-count").innerText=parseInt(BX("faceid-stats-crm-count").innerText)+1}}}function H(e,a){var i=true;var t=typeof a=="string"?JSON.parse(a):a;e.setAttribute("data-visitor-id",t.visitor_id);var r=BX.findChildren(BX("faceid-tracker-main-user-container"),{attr:{"data-visitor-id":t.visitor_id}});if(r){var s;for(s in r){if(r[s]!=e){r[s].remove();i=false}}}if(t.confidence>0){BX.addClass(e,"faceid-tracker-photo")}if(t.crm_url.length>0){BX.addClass(e,"faceid-tracker-platform")}if(t.vk_id.length>0){BX.addClass(e,"faceid-tracker-social-state")}e.setAttribute("data-last-visit-ts",t.last_visit_ts);var c='<div class="faceid-tracker-main-user-photo"> 						<div class="faceid-tracker-main-user-photo-platform"> 							<span class="faceid-tracker-main-user-photo-platform-item">CRM</span> 						</div> 						<div class="faceid-tracker-main-user-photo-item"> 							<img width="100" height="100"> 						</div> 						<div class="faceid-tracker-main-user-photo-count"> 							<span class="faceid-tracker-main-user-photo-count-item">'+t.confidence+'%</span> 							<div class="faceid-tracker-main-user-photo-count-info"> 								<div class="faceid-tracker-main-user-photo-count-info-desc">'+BX.message("FACEID_TRACKER_CMP_JS_FACE_ORIGINAL")+'</div> 								<div class="faceid-tracker-main-user-photo-item" style="background-image: url('+t.image_src+')"></div> 							</div> 						</div> 					</div> 					<div class="faceid-tracker-main-user-info"> 						<div class="faceid-tracker-main-user-info-description"> 							<span class="faceid-tracker-main-user-info-description-item">'+t.visit_info+'</span> 						</div> 						<div class="faceid-tracker-main-user-info-name">';if(t.crm_url.length)c+='<a href="'+t.crm_url+'" class="faceid-tracker-main-user-info-name-item">'+t.name+"</a>";else c+='<div class="faceid-tracker-main-user-info-name-item">'+t.name+"</div>";c+='						</div> 						<div class="faceid-tracker-main-user-info-control">';if(!t.crm_url.length)c+='							<div class="faceid-tracker-main-user-info-control-block'+(t.crm_url.length?" faceid-tracker-button-state":"")+'"> 								<div class="webform-small-button webform-small-button-blue faceid-tracker-main-user-info-control-button">'+BX.message("FACEID_TRACKER_CMP_JS_SAVE_CRM")+' 									<div class="faceid-tracker-user-loader"> 										<div class="faceid-tracker-user-loader-item"> 											<div class="faceid-tracker-loader"> 												<svg class="faceid-tracker-circular" viewBox="25 25 50 50"> 													<circle class="faceid-tracker-path" cx="50" cy="50" r="20" fill="none" stroke-width="1" stroke-miterlimit="10"/> 												</svg> 											</div> 										</div> 									</div> 								</div> 								<div class="webform-small-button webform-small-button-transparent faceid-tracker-main-user-info-control-button">'+BX.message("FACEID_TRACKER_CMP_JS_SAVE_CRM_DONE")+"</div> 							</div>";c+='							<div class="faceid-tracker-main-user-info-control-social"> 								<span class="faceid-tracker-main-user-info-control-social-name">'+BX.message("FACEID_TRACKER_CMP_JS_VK_LINK")+"</span>";if(t.vk_id.length)c+='									<a href="http://vk.com/'+BX.util.htmlspecialchars(t.vk_id)+'" class="faceid-tracker-main-user-info-control-social-item">'+"VK.com/"+BX.util.htmlspecialchars(t.vk_id)+"</a>";else c+='									<span class="faceid-tracker-main-user-info-control-social-item"><span>'+BX.message("FACEID_TRACKER_CMP_JS_VK_LINK_ACTION")+"</span></span>";c+="							</div> 						</div> 					</div>";e.innerHTML=c;var n=BX.findChild(e,{"class":"faceid-tracker-main-user-photo-item"},true);var d=BX.findChild(n,{tag:"img"});d.setAttribute("src",t.shot_src);if(!t.vk_id.length){var o=BX.clone(BX("faceid-tracker-profile-search-example"));o.id="";o.style.top=document.body.scrollTop+596+30+"px";var l=BX.findChild(e,{"class":"faceid-tracker-main-user-info-control-social-item"},true);var f=BX.findChild(o,{"class":"faceid-tracker-profile-search-header"},true);var u=0;var m=0;var h=function(e){var a=u-e.clientX;var i=m-e.clientY;o.style.left=parseInt(o.style.left)-a+"px";o.style.top=parseInt(o.style.top)-i+"px";u=e.clientX;m=e.clientY};var v=function(){BX.unbind(document,"mousemove",h);BX.unbind(document,"mouseup",v)};BX.bind(f,"mousedown",function(e){var a=BX.pos(o);o.style.left=a.left+"px";o.style.top=a.top+"px";u=e.clientX;m=e.clientY;o.style.transform="translate(0)";BX.bind(document,"mousemove",h);BX.bind(document,"mouseup",v)});document.body.appendChild(o);var g=BX.findChild(l,{tag:"span"});BX.bind(g,"click",function(){BX.show(o);if(o.getAttribute("data-in-progress")){return}o.setAttribute("data-in-progress","1");BX.ajax({url:"/bitrix/components/bitrix/faceid.tracker/ajax_vk.php",method:"POST",data:{action:"identify",image:t.shot_src,visitor_id:t.visitor_id},dataType:"json",processData:false,start:true,onsuccess:function(a){var i=JSON.parse(a);var r=i.items;if(i.status&&i.status.balance>=0){BX("faceid-credits-balance").innerText=i.status.balance}if(r.length){var s,c="";c=N(r[0],true);var n=BX.findChild(o,{"class":"faceid-tracker-profile-search-main"},true);n.innerHTML=c+n.innerHTML;c="";r.splice(0,1);for(s in r){c+=N(r[s])}n=BX.findChild(o,{"class":"faceid-tracker-profile-search-found-container"},true);n.innerHTML=c;var d=BX.findChild(o,{"class":"faceid-tracker-profile-search-found-more-count"},true);d.innerHTML=r.length+" "+BX.message("FACEID_TRACKER_CMP_JS_VK_FOUND_PEOPLE");var f=BX.findChild(o,{"class":"faceid-tracker-profile-search-loading"},true);BX.addClass(f,"faceid-tracker-animate-hidden");var u=BX.findChildren(o,{"class":"faceid-tracker-main-user-info-control-button"},true);for(s in u){BX.bind(u[s],"click",function(){var a=BX(this).parentNode.parentNode;var i=BX.findChild(a,{"class":"faceid-tracker-main-user-social-link-item"},true).innerText;var r=l.parentNode;l.remove();r.innerHTML+='<a href="http://'+i+'" class="faceid-tracker-main-user-info-control-social-item">'+i.replace("vk.com","VK.com")+"</a>";BX.addClass(e,"faceid-tracker-social-state");BX.hide(o);BX.ajax({url:"/bitrix/components/bitrix/faceid.tracker/ajax_vk.php",method:"POST",data:{action:"save",vk_id:i.replace("vk.com/",""),visitor_id:t.visitor_id},dataType:"json",processData:false,start:true,onsuccess:function(a){var i=JSON.parse(a);var r=BX.findChild(e,{"class":"faceid-tracker-main-user-info-name"},true);r.innerHTML='<a href="'+i.url+'" class="faceid-tracker-main-user-info-name-item">'+t.name+"</a>"}})})}}else if(i.error&&i.error.msg){var f=BX.findChild(o,{"class":"faceid-tracker-loader"},true);BX.hide(f);var m=BX.findChild(o,{"class":"faceid-tracker-profile-search-loading-desc"},true);BX.hide(m);var h=BX.findChild(o,{"class":"faceid-tracker-error"},true);h.innerHTML=i.error.msg;BX.show(h)}}})});var p=BX.findChild(o,{"class":"faceid-tracker-header-description-close-item"},true);BX.bind(p,"click",function(){BX.hide(o)})}var k=BX.findChild(e,{"class":"webform-small-button-blue"},true);BX.bind(k,"click",function(){var a=BX(this).parentNode;if(!BX.hasClass(a,"faceid-tracker-button-state")&&!BX.hasClass(a,"faceid-control-loader-state")){BX.addClass(a,"faceid-control-loader-state");BX.ajax({url:"/bitrix/components/bitrix/faceid.tracker/ajax_crm.php",method:"POST",data:{action:"addLead",lead_title:t.name,visitor_id:t.visitor_id},dataType:"json",processData:false,start:true,onsuccess:function(i){var r=JSON.parse(i);var s=BX.findChild(e,{"class":"faceid-tracker-main-user-info-name"},true);s.innerHTML='<a href="'+r.url+'" class="faceid-tracker-main-user-info-name-item">'+t.name+"</a>";BX.removeClass(a,".faceid-control-loader-state");BX.addClass(a,"faceid-tracker-button-state")}})}});return i}function N(e,a){var i='<div class="faceid-tracker-main-user-item faceid-tracker-profile-search-found faceid-tracker-photo'+(a?" faceid-tracker-found-user":"")+'"> 					<div class="faceid-tracker-main-user-photo"> 						<div class="faceid-tracker-main-user-photo-platform"> 							<span class="faceid-tracker-main-user-photo-platform-item">CRM</span> 						</div> 						<div class="faceid-tracker-main-user-photo-item" style="background-image: url('+BX.util.htmlspecialchars(e.photo)+')"></div> 						<div class="faceid-tracker-main-user-photo-count"> 							<span class="faceid-tracker-main-user-photo-count-item">'+Math.round(e.confidence*100)+'%</span> 						</div> 					</div> 					<div class="faceid-tracker-main-user-info"> 						<div class="faceid-tracker-main-user-info-name"> 							<div class="faceid-tracker-main-user-info-name-item">'+BX.util.htmlspecialchars(e.name)+'</div> 							<div class="faceid-tracker-main-user-date"> 								<span class="faceid-tracker-main-user-date-item">'+BX.util.htmlspecialchars(e.personal)+'</span> 							</div> 							<div class="faceid-tracker-main-user-social-link"> 								<a href="http://vk.com/'+BX.util.htmlspecialchars(e.id)+'" class="faceid-tracker-main-user-social-link-item">vk.com/'+BX.util.htmlspecialchars(e.id)+'</a> 							</div> 						</div> 						<div class="faceid-tracker-main-user-info-control"> 							<div class="webform-small-button webform-small-button-blue faceid-tracker-main-user-info-control-button '+(a?"":"faceid-tracker-search-button")+'">'+BX.message("FACEID_TRACKER_CMP_JS_VK_SELECT")+"</div> 						</div> 					</div> 				</div>";return i}BX.ready(function(){BX.bind(BX("faceid-tracker-main-user-more"),"click",function(){if(!d){return}BX.ajax({url:"/bitrix/components/bitrix/faceid.tracker/ajax_more.php",method:"POST",data:{last:d},dataType:"json",processData:false,start:true,onsuccess:function(e){var a,i=JSON.parse(e);if(i.items.length){for(a in i.items){D(i.items[a],false)}}if(i.more==0){BX("faceid-tracker-main-user-more").remove()}}})});BX.bind(BX("faceid-tracker-header-description-close"),"click",function(){BX.localStorage.set("faceid-description-read","1",3600*24*360);BX(this).parentNode.remove()});if(!BX.localStorage.get("faceid-description-read")){BX.show(BX("faceid-tracker-header-description-close").parentNode)}BX.bind(BX("faceid-auto-identify"),"change",function(){if(!BX(this).checked){I()}})});function W(e){if(e.hasOwnProperty("length"))return e.length==0;for(var a in e){if(e.hasOwnProperty(a))return false}return JSON.stringify(e)===JSON.stringify({})}BX.bind(BX("faceid-fullscreen-button"),"click",function(){var e=t;var a=BX.findParent(e,{"class":"faceid-tracker-wrapper"});var i=BX("faceid-video").parentNode;if(BX.getFullScreenElement()){BX.cancelFullScreen()}else{BX.requestFullScreen(i)}});BX.bind(document,"fullscreenchange",function(){var e=BX.findParent(t,{"class":"faceid-tracker-wrapper"});var a=BX("faceid-fullscreen-button");BX.toggleClass(e,"faceid-tracker-full-mode");BX.toggleClass(a,"faceid-tracker-sidebar-photo-full-mode");BX.toggleClass(a,"faceid-tracker-sidebar-photo-fullback-mode");if(!BX.getFullScreenElement()){o.cameraWidth=o.cameraSmallWidth;o.cameraHeight=o.cameraSmallHeight;o.trackingRatio=o.trackingSmallRatio}else{o.cameraWidth=o.cameraFullWidth;o.cameraHeight=o.cameraFullHeight;o.trackingRatio=o.trackingFullRatio}t.setAttribute("width",o.cameraWidth);t.setAttribute("height",o.cameraHeight);l.setAttribute("width",o.cameraWidth);l.setAttribute("height",o.cameraHeight)})}
//# sourceMappingURL=script.map.js