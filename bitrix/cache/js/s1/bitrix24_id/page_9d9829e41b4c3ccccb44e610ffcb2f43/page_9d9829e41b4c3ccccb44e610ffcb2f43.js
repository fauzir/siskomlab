
; /* Start:"a:4:{s:4:"full";s:93:"/bitrix/components/bitrix/socialnetwork.admin.set/templates/.default/script.js?15113165822527";s:6:"source";s:78:"/bitrix/components/bitrix/socialnetwork.admin.set/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
var waitDiv = null;
var waitPopup = null;
var waitTimeout = null;
var waitTime = 500;

function __SASSetAdmin()
{
	__SASShowWait();
	BX.ajax({
		url: '/bitrix/components/bitrix/socialnetwork.admin.set/ajax.php',
		method: 'POST',
		dataType: 'json',
		data: {'ACTION': 'SET', 'sessid': BX.bitrix_sessid(), 'site': BX.util.urlencode(BX.message('SASSiteId'))},
		onsuccess: function(data) { __SASProcessAJAXResponse(data); }
	});
}

function __SASProcessAJAXResponse(data)
{
	if (data["SUCCESS"] != "undefined" && data["SUCCESS"] == "Y")
	{
		BX.reload();
		return false;
	}
	else if (data["ERROR"] != "undefined" && data["ERROR"].length > 0)
	{
		if (data["ERROR"].indexOf("SESSION_ERROR", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorSessionWrong'));
			BX.reload();
		}
		else if (data["ERROR"].indexOf("CURRENT_USER_NOT_ADMIN", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorNotAdmin'));
			return false;
		}
		else if (data["ERROR"].indexOf("CURRENT_USER_NOT_AUTH", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorCurrentUserNotAuthorized'));
			return false;
		}
		else if (data["ERROR"].indexOf("SONET_MODULE_NOT_INSTALLED", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorModuleNotInstalled'));
			return false;
		}
		else
		{
			__SASShowError(data["ERROR"]);
			return false;		
		}
	}
}
				
function __SASShowError(errorText) 
{
	__SASCloseWait();

	var errorPopup = new BX.PopupWindow('sas-error' + Math.random(), window, {
		autoHide: true,
		lightShadow: false,
		zIndex: 2,
		content: BX.create('DIV', {props: {'className': 'sonet-adminset-error-text-block'}, html: errorText}),
		closeByEsc: true,
		closeIcon: true
	});
	errorPopup.show();

}

function __SASShowWait(timeout)
{
	if (timeout !== 0)
	{
		return (waitTimeout = setTimeout(function(){
			__SASShowWait(0)
		}, 50));
	}

	if (!waitPopup)
	{
		waitPopup = new BX.PopupWindow('sas_wait', window, {
			autoHide: true,
			lightShadow: true,
			zIndex: 2,
			content: BX.create('DIV', {
				props: {
					className: 'sonet-adminset-wait-cont'
				},
				children: [
					BX.create('DIV', {
						props: {
							className: 'sonet-adminset-wait-icon'
						}
					}),
					BX.create('DIV', {
						props: {
							className: 'sonet-adminset-wait-text'
						},
						html: BX.message('SASWaitTitle')
					})
				]
			})
		});
	}
	else
		waitPopup.setBindElement(window);

	waitPopup.show();
}

function __SASCloseWait()
{
	if (waitTimeout)
	{
		clearTimeout(waitTimeout);
		waitTimeout = null;
	}

	if (waitPopup)
		waitPopup.close();
}
/* End */
;
; /* Start:"a:4:{s:4:"full";s:93:"/bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.min.js?15113164847121";s:6:"source";s:74:"/bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.js";s:3:"min";s:78:"/bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.min.js";s:3:"map";s:78:"/bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.map.js";}"*/
BX.namespace("BX.Disk");BX.Disk.FolderToolbarClass=function(){var e=function(e){this.id=e.id;this.destFormName=e.destFormName;this.toolbarContainer=e.toolbarContainer||null;this.createBlankFileUrl=e.createBlankFileUrl;this.renameBlankFileUrl=e.renameBlankFileUrl;this.targetFolderId=e.targetFolderId;this.defaultService=e.defaultService;this.defaultServiceLabel=e.defaultServiceLabel;this.ajaxUrl="/bitrix/components/bitrix/disk.folder.toolbar/ajax.php";this.setEvents()};e.prototype.setEvents=function(){};e.prototype.emptyTrashCan=function(){BX.onCustomEvent("onEmptyTrashCan",[])};e.prototype.createFolder=function(){BX.Disk.modalWindow({modalId:"bx-disk-create-folder",title:BX.message("DISK_FOLDER_TOOLBAR_TITLE_CREATE_FOLDER"),contentClassName:"",contentStyle:{paddingTop:"30px",paddingBottom:"70px"},events:{onAfterPopupShow:function(){BX.focus(BX("disk-new-create-filename"))},onPopupClose:function(){this.destroy()}},content:[BX.create("label",{props:{className:"bx-disk-popup-label","for":"disk-new-create-filename"},children:[BX.create("span",{props:{className:"req"},text:"*"}),BX.message("DISK_FOLDER_TOOLBAR_LABEL_NAME_CREATE_FOLDER")]}),BX.create("input",{props:{id:"disk-new-create-filename",className:"bx-disk-popup-input",type:"text",value:""},style:{fontSize:"16px",marginTop:"10px"}})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CREATE_FOLDER"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){var e=BX("disk-new-create-filename").value;if(!e){BX.focus(BX("disk-new-create-filename"));return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","addFolder"),data:{targetFolderId:this.targetFolderId,name:e},onsuccess:function(e){if(!e){return}if(e.status&&e.status=="success"){document.location=BX.Disk.getUrlToShowObjectInGrid(e.folder.id)}else{BX.Disk.showModalWithStatusAction(e)}}})},this)}}),new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CLOSE"),events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})};e.prototype.removeShared=function(e){var i=e.item.id;var s=e.item.name;var a=e.item.avatar;var o=e.type;delete t[i];var r=BX.findChild(BX("bx-disk-popup-shared-people-list"),{attribute:{"data-dest-id":""+i+""}},true);if(r){BX.remove(r)}};var t={};var i=0;e.prototype.appendNewShared=function(e){t[e.item.id]={destFormName:this.destFormName,item:e.item,type:e.type,right:"disk_access_read"};BX.Disk.appendNewShared(e)};e.prototype.createExtendedFolder=function(){t={};BX.onCustomEvent("onCreateExtendedFolder",[])};e.prototype.createFile=function(){BX.Disk.modalWindow({modalId:"bx-disk-create-file",title:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_FILE_TITLE"),contentClassName:"tac bx-disk-create-file-big",contentStyle:{paddingTop:"30px",paddingBottom:"70px"},events:{onPopupClose:function(){BX.PopupMenu.destroy("disk_open_menu_with_services")}},content:[BX.create("div",{props:{className:"bx-disk-create-file-section"},children:[BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_FILE_TEXT")+" ",BX.create("span",{style:{cursor:"pointer"},children:[BX.create("span",{text:this.defaultServiceLabel,props:{className:"bx-disk-create-file-bdbdotted",id:"bx-disk-default-service-label"}}),BX.create("SPAN",{html:"&nbsp;"}),BX.create("span",{props:{className:"bx-disk-create-file-big-icon"}})],events:{click:BX.delegate(function(e){this.openMenuWithServices(BX("bx-disk-default-service-label"));BX.PreventDefault(e)},this)}})]}),BX.create("div",{props:{className:"bx-disk-create-file-section"},children:[BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_TYPE_DOC"),props:{className:"bx-disk-create-file-big-icon bx-disk-create-file-big-doc"},style:{cursor:"pointer"},events:{click:BX.delegate(function(e){this.runCreatingFile("docx");BX.PreventDefault(e)},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_TYPE_XLS"),props:{className:"bx-disk-create-file-big-icon bx-disk-create-file-big-table"},style:{cursor:"pointer"},events:{click:BX.delegate(function(e){this.runCreatingFile("xlsx");BX.PreventDefault(e)},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_TYPE_PPT"),props:{className:"bx-disk-create-file-big-icon bx-disk-create-file-big-pres"},style:{cursor:"pointer"},events:{click:BX.delegate(function(e){this.runCreatingFile("pptx");BX.PreventDefault(e)},this)}})]})]})};e.prototype.openMenuWithServices=function(e){var t=new BX.CViewer({});BX.PopupMenu.show("disk_open_menu_with_services",BX(e),[{text:BX.message("DISK_FOLDER_TOOLBAR_LABEL_LOCAL_BDISK_EDIT"),className:"bx-viewer-popup-item item-b24",href:"#",onclick:BX.delegate(function(e){if(BX.CViewer.isEnableLocalEditInDesktop()){this.setEditService("l");BX.adjust(BX("bx-disk-default-service-label"),{text:BX.message("DISK_FOLDER_TOOLBAR_LABEL_LOCAL_BDISK_EDIT")});BX.PopupMenu.destroy("disk_open_menu_with_services")}else{this.helpDiskDialog()}return BX.PreventDefault(e)},t)},{text:t.getNameEditService("google"),className:"bx-viewer-popup-item item-gdocs",href:"#",onclick:BX.delegate(function(e){this.setEditService("google");BX.adjust(BX("bx-disk-default-service-label"),{text:this.getNameEditService("google")});BX.PopupMenu.destroy("disk_open_menu_with_services");return BX.PreventDefault(e)},t)},{text:t.getNameEditService("office365"),className:"bx-viewer-popup-item item-office365",href:"#",onclick:BX.delegate(function(e){this.setEditService("office365");BX.adjust(BX("bx-disk-default-service-label"),{text:this.getNameEditService("office365")});BX.PopupMenu.destroy("disk_open_menu_with_services");return BX.PreventDefault(e)},t)},{text:t.getNameEditService("skydrive"),className:"bx-viewer-popup-item item-office",href:"#",onclick:BX.delegate(function(e){this.setEditService("skydrive");BX.adjust(BX("bx-disk-default-service-label"),{text:this.getNameEditService("skydrive")});BX.PopupMenu.destroy("disk_open_menu_with_services");return BX.PreventDefault(e)},t)}],{angle:{position:"top",offset:45},autoHide:true,overlay:{opacity:.01}})};e.prototype.blockFeatures=function(){BX.PopupWindowManager.create("bx-disk-business-tools-info",null,{content:BX("bx-bitrix24-business-tools-info"),closeIcon:true,onPopupClose:function(){this.destroy()},autoHide:true,zIndex:11e3}).show()};e.prototype.runCreatingFile=function(e){if(BX.message("disk_restriction")){this.blockFeatures();return}var t=new BX.CViewer({createDoc:true});var i=t.createBlankElementByParams({targetFolderId:this.targetFolderId,docType:e,editUrl:this.createBlankFileUrl,renameUrl:this.renameBlankFileUrl});t.setCurrent(i);i.afterSuccessCreate=function(e){if(e&&e.status=="success"){if(!BX.CViewer.isLocalEditService(t.initEditService())){window.document.location=BX.Disk.getUrlToShowObjectInGrid(e.objectId)}else{window.onbeforeunload=function(){if(!window.diskUnloadCreateDoc){window.diskUnloadCreateDoc=true;setTimeout(function(){window.document.location=BX.Disk.getUrlToShowObjectInGrid(e.objectId)},250)}}}}};t.runActionByCurrentElement("create",{obElementViewer:t});try{BX.PreventDefault()}catch(s){}return false};return e}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:91:"/bitrix/components/bitrix/disk.folder.list/templates/.default/script.min.js?151131648493149";s:6:"source";s:71:"/bitrix/components/bitrix/disk.folder.list/templates/.default/script.js";s:3:"min";s:75:"/bitrix/components/bitrix/disk.folder.list/templates/.default/script.min.js";s:3:"map";s:75:"/bitrix/components/bitrix/disk.folder.list/templates/.default/script.map.js";}"*/
BX.namespace("BX.Disk");BX.Disk.FolderListClass=function(){var e=function(e){this.errors=e.errors||[];this.information=e.information||"";this.currentFolder=e.currentFolder||{};this.grid=e.grid;this.infoPanelContainer=BX(e.infoPanelContainer);this.gridGroupActionButton=BX(e.gridGroupActionButton);this.gridShowTreeButton=BX(e.gridShowTreeButton);this.rootObject=e.rootObject||{};this.storage=e.storage||{};this.storage.manage=this.storage.manage||{};this.enabledModZip=e.enabledModZip||false;this.enabledExternalLink=e.enabledExternalLink;this.enabledObjectLock=e.enabledObjectLock;this.currentObjectIdInInfoPanel=null;this.getFilesCountAndSize=e.getFilesCountAndSize||{};this.containerWithExtAndIntLinks=null;this.cacheExternalLinks={};this.actionGroupButton=e.actionGroupButton||"move";this.grid.SetActionName(this.actionGroupButton);this.checkboxes={};this.isBitrix24=e.isBitrix24||false;this.destFormName=e.destFormName||"folder-list-destFormName";this.resetCheckboxes();this.ajaxUrl="/bitrix/components/bitrix/disk.folder.list/ajax.php";this.setGroupActionTargetObjectId(this.rootObject.id);this.setEvents();this.initGroupActionButton();this.workWithLocationHash();if(this.errors.length)this.showErrors();if(this.information.length)this.showInformation();var t=BX.findChildren(this.grid.tableNode,{className:"draggable",tagName:"div"},true);var s=this.grid.isTile?"bx-disk-interface-tile":"bx-disk-interface-filelist";for(var i=0;i<t.length;i++){window.jsDD.registerObject(t[i]);t[i].onbxdragstart=function(){this._parent=this.parentNode;document.body.appendChild(BX.create("div",{props:{className:s},style:{paddingTop:0,border:"none"},children:[this]}));this.style.border="1px solid #E8E8E8";this.style.top="-1000px";this.style.left="-1000px"};t[i].onbxdragrelease=function(){this._parent.appendChild(this);this.style.border="";this.style.position="";this.style.top="";this.style.left="";this.style.zIndex=""};t[i].onbxdrag=function(e,t){this.style.position="absolute";this.style.zIndex=9999999;this.style.left=e+"px";this.style.top=t+"px"};t[i].onbxdragfinish=BX.delegate(function(e,t,s){var i=BX.proxy_context;var a=i.getAttribute("data-object-id");BX.remove(i._parent);BX.remove(i);try{this.removeRow(a)}catch(n){}},this);var a=BX.findChild(t[i],{tagName:"div",className:"bx-file-icon-container-small"});if(!a&&BX.hasClass(t[i],"bx-file-icon-container-small")){a=t[i]}if(a&&BX.hasClass(a,"bx-disk-folder-icon")){window.jsDD.registerDest(t[i]);t[i].onbxdestdraghout=function(){BX.removeClass(this,"selected")};t[i].onbxdestdragfinish=BX.delegate(function(e,t,s){if(e.getAttribute("data-object-id")==BX.proxy_context.getAttribute("data-object-id")){return false}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","moveTo"),data:{objectId:e.getAttribute("data-object-id"),targetObjectId:BX.proxy_context.getAttribute("data-object-id")},onsuccess:function(e){BX.Disk.showModalWithStatusAction(e)}});return true},this);t[i].onbxdestdraghover=function(e,t,s){if(BX.hasClass(this,"selected")){return}BX.addClass(this,"selected");return true}}else if(a){var n=BX.findChild(a,{className:"js-disk-locked-document-tooltip"},false);if(n){BX.tooltip(n.getAttribute("data-lock-created-by"),n.getAttribute("id"))}}}};e.prototype.resetCheckboxes=function(){var e=BX.findChildren(this.grid.tableNode,{tagName:"input",attr:{type:"checkbox"}},true);for(var t in e){if(!e.hasOwnProperty(t)){continue}var s=e[t];if(s.getAttribute("name")==="ID[]"){s.checked=false}}};e.prototype.showInformation=function(){BX.Disk.showModalWithStatusAction({status:"success",message:this.information})};e.prototype.showErrors=function(){BX.Disk.showModalWithStatusAction({status:"error",errors:this.errors})};e.prototype.onKeyPress=function(e){var t=e.which||e.keyCode;var s=String.fromCharCode(t);var i=BX.findChildren(this.grid.tableNode,{tagName:"a",className:"bx-disk-folder-title"},true);var a=Object.create(null);for(var n in i){if(!i.hasOwnProperty(n))continue;var o=i[n];a[o.getAttribute("data-bx-title")]=o}for(var r in a){if(r.indexOf(s)===0){var d=this.getCheckbox(a[r].getAttribute("id").split("disk_obj_").pop());if(d){d.checked=true;var l=this.getRowByCheckBox(d);BX.addClass(l,"active");BX.scrollToNode(l);this.grid.SelectRow(d)}return}}};e.prototype.onHashChange=function(){var e=document.location.hash.match(/hl-([0-9]+)/g);if(e){var t=(document.location.hash.match(/!([a-zA-Z]+)/g)||[]).pop();for(var s in e){if(!e.hasOwnProperty(s)){continue}var i=e[s];var a=i.match(/hl-([0-9]+)/);if(a&&a[1]){var n=this.getCheckbox(a[1]);if(n){n.checked=true;var o=this.getRowByCheckBox(n);BX.addClass(o,"active");BX.scrollToNode(o);this.grid.SelectRow(n);this.runCommandOnObjectId(t,a[1])}else if(t){if(window.BXIM&&BXIM.isOpenNotify()){document.location.reload();BXIM.closeMessenger()}}}}if(window.BXIM&&BXIM.isOpenNotify()){BXIM.closeMessenger()}}};e.prototype.workWithLocationHash=function(){setTimeout(BX.delegate(function(){this.onHashChange()},this),350)};e.prototype.setEvents=function(){BX.bind(BX("delete_button_"+this.grid.table_id),"click",BX.proxy(this.onClickDeleteGroup,this));BX.bind(this.gridGroupActionButton,"click",BX.proxy(this.onClickGridGroupActionButton,this));BX.bind(this.gridShowTreeButton,"click",BX.proxy(this.onClickGridShowTreeButton,this));BX.bind(this.getFilesCountAndSize.button,"click",BX.proxy(this.onClickGetFilesCountAndSizeButtonButton,this));BX.bind(BX(this.storage.manage.connectButtonId),"click",BX.proxy(this.onClickManageConnectButton,this));BX.bind(window,"hashchange",BX.proxy(this.onHashChange,this));BX.addCustomEvent("onIframeElementLoadDataToView",BX.proxy(this.onIframeElementLoadDataToView,this));BX.addCustomEvent("onBeforeElementShow",BX.proxy(this.onBeforeElementShow,this));BX.addCustomEvent("onSelectRow",BX.proxy(this.onSelectRow,this));BX.addCustomEvent("onUnSelectRow",BX.proxy(this.onUnSelectRow,this));BX.addCustomEvent("onCreateExtendedFolder",BX.proxy(this.onCreateExtendedFolder,this));BX.addCustomEvent("onPullEvent-disk",BX.delegate(function(e,s){s=s||{};switch(s.action){case"commit":if(!s.objectId){break}if(parseInt(s.contentVersion,10)<2){break}var i=BX.delegate(t,this)(s.objectId);var a=i.row;var n=i.title;if(!n){break}BX.Disk.showModalWithStatusAction({message:BX.message("DISK_FOLDER_LIST_LABEL_LIVE_UPDATE_FILE").replace("#NAME#",n.text),dontCloseCurrentPopupWindow:true});break}},this))};e.prototype.initGroupActionButton=function(){var e=BX(this.gridGroupActionButton);if(!e){return}var t=e.getAttribute("data-group-action");var s=BX.findChild(e,{tagName:"span",className:"js-text-group-action"});if(t==="move"){BX.adjust(s,{text:BX.message("DISK_FOLDER_LIST_TITLE_GRID_TOOLBAR_MOVE_BUTTON")})}if(t==="copy"){BX.adjust(s,{text:BX.message("DISK_FOLDER_LIST_TITLE_GRID_TOOLBAR_COPY_BUTTON")})}this.actionGroupButton=t;this.grid.SetActionName(t)};e.prototype.runCommandOnObjectId=function(e,s){if(!e){return}var a=BX.delegate(t,this)(s);var n=a.row;var o=a.title;var r=a.icon;switch(e.toLowerCase()){case"!disconnect":case"!detach":this.openConfirmDetach({object:{id:s,name:o.text,isFolder:BX.hasClass(r,"bx-disk-folder-icon")}});break;case"!share":var d=i(this.getRow(s),"share");if(d.ONCLICK){if(d.ONCLICK.indexOf("showSharingDetailWithoutEdit")!==-1){BX.Disk.showSharingDetailWithoutEdit({ajaxUrl:this.ajaxUrl,object:{id:s,name:o.text,isFolder:BX.hasClass(r,"bx-disk-folder-icon")}})}else if(d.ONCLICK.indexOf("showSharingDetailWithChangeRights")!==-1){this.showSharingDetailWithChangeRights({object:{id:s,name:o.text,isFolder:BX.hasClass(r,"bx-disk-folder-icon")}})}else if(d.ONCLICK.indexOf("showSharingDetailWithSharing")!==-1){this.showSharingDetailWithSharing({object:{id:s,name:o.text,isFolder:BX.hasClass(r,"bx-disk-folder-icon")}})}}break;case"!show":var l=BX("disk_obj_"+s);if(!!l){BX.fireEvent(l,"click")}break;default:break}};function t(e){var t=this.getRow(e);return{row:this.getRow(e),title:BX.findChild(t,{tagName:"a",className:"bx-disk-folder-title"},true),icon:BX.findChild(t,function(e){return BX.type.isElementNode(e)&&(BX.hasClass(e,"bx-disk-file-icon")||BX.hasClass(e,"bx-disk-folder-icon"))},true)}}function s(e){var t=this.getRow(e);var s=BX.findChild(t,{tagName:"a",className:"bx-disk-folder-title"},true);return BX.findChild(t,function(e){return BX.type.isElementNode(e)&&(BX.hasClass(e,"bx-disk-file-icon")||BX.hasClass(e,"bx-disk-folder-icon"))},true)}e.prototype.setGroupActionTargetObjectId=function(e){var t=BX("grid_group_action_target_object");if(!t){this.grid.GetForm().appendChild(BX.create("input",{props:{id:"grid_group_action_target_object",name:"grid_group_action_target_object",type:"hidden",value:e}}))}else{t.value=e}};e.prototype.onClickManageConnectButton=function(e){var t=BX.proxy_context;if(!BX.type.isDomNode(BX.proxy_context))return;var s=this.storage.rootObject.id;if(BX.hasClass(t,"connect")){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","connectToUserStorage"),data:{objectId:this.storage.rootObject.id},onsuccess:BX.delegate(function(e){BX.Disk.showModalWithStatusAction(e);if(e.status!="success"){return}var s=BX.findChild(t,{className:"popup-current-icon"},true);if(!!s){BX.removeClass(s,"popup-current-icon-connect");BX.addClass(s,"popup-current-icon-disconnect")}var i=BX.findChild(t,{className:"bx-disk-disconnect-connect-disk-text"},true);if(!!i){BX.adjust(i,{text:BX.message("DISK_FOLDER_LIST_LABEL_ALREADY_CONNECT_DISK")})}BX.removeClass(t,"connect");BX.addClass(t,"disconnect");if(!!e.manage.link){this.storage.manage.link=BX.clone(e.manage.link,true)}},this)});BX.PreventDefault(e)}else if(BX.hasClass(t,"disconnect")){this.openConfirmDetach({object:{id:this.storage.manage.link.object.id,name:this.storage.name,isFolder:true},onSuccess:function(e){if(e&&e.status=="success"){e.message=BX.message("DISK_FOLDER_LIST_LABEL_DISCONNECTED_DISK")}BX.Disk.showModalWithStatusAction(e);var s=BX.findChild(t,{className:"popup-current-icon"},true);if(!!s){BX.removeClass(s,"popup-current-icon-disconnect");BX.addClass(s,"popup-current-icon-connect")}var i=BX.findChild(t,{className:"bx-disk-disconnect-connect-disk-text"},true);if(!!i){BX.adjust(i,{text:BX.message("DISK_FOLDER_LIST_LABEL_CONNECT_DISK")})}BX.removeClass(t,"disconnect");BX.addClass(t,"connect")}});BX.PreventDefault(e)}};e.prototype.onClickGridShowTreeButton=function(e){var t=null;var s=null;BX.addCustomEvent("onSelectFolder",BX.delegate(function(e){if(!e.getAttribute("data-can-add")){BX.removeClass(e,"selected");return}if(s){BX.removeClass(s,"selected")}t=e.getAttribute("data-object-id");s=e;var i=BX.findChild(s,{className:"bx-disk-wf-folder-name"},true);if(i){var a=BX.findChild(this.gridShowTreeButton,{tagName:"span"});if(a){var n=BX.findChild(i,{tagName:"span"})||{};BX.adjust(a,{text:n.textContent||n.innerText})}}t&&this.setGroupActionTargetObjectId(t);if(BX.PopupWindowManager.isPopupExists("bx-disk-toolbar-tree")){if(BX.PopupWindowManager.getCurrentPopup()){BX.PopupWindowManager.getCurrentPopup().close()}}},this));BX.addCustomEvent("onUnSelectFolder",function(e){t=null;s=null;var i=BX("grid_group_action_target_object");i&&BX.remove(i)});var i=this.rootObject;if(BX.PopupWindowManager.isPopupExists("bx-disk-toolbar-tree")){BX.PopupWindowManager.create("bx-disk-toolbar-tree").show();return}BX.Disk.ajax({url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSubFoldersToAdd"),method:"POST",dataType:"json",data:{objectId:i.id},onsuccess:BX.delegate(function(t){if(!t||t.status!="success"){BX.Disk.showModalWithStatusAction(t);return}var s=this.buildTreeNode(i);var a=BX.create("ul",{props:{className:"bx-disk-wood-folder"}});s.appendChild(a);var n=e.target?e.target:e.srcElement?e.srcElement:null;if(n){n=BX.findParent(n,{className:"popup-control",tagName:"span"},this.grid.tableNode)||n}this.buildTree(s,t);BX.Disk.modalWindow({bindElement:n,overlay:false,autoHide:true,modalId:"bx-disk-toolbar-tree",events:{onPopupClose:function(){}},content:[BX.create("ul",{props:{className:"bx-disk-wood-folder"},children:[s]})]})},this)})};e.prototype.onClickGetFilesCountAndSizeButtonButton=function(e){BX.Disk.ajax({url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","calculateFileSizeAndCount"),method:"POST",dataType:"json",data:{folderId:this.currentFolder.id},onsuccess:BX.delegate(function(e){if(!e||e.status!="success"){BX.Disk.showModalWithStatusAction(e);return}BX.adjust(this.getFilesCountAndSize.sizeContainer,{text:e.size});BX.adjust(this.getFilesCountAndSize.countContainer,{text:e.count})},this)})};e.prototype.onClickGridGroupActionButton=function(e){BX.PopupMenu.show("folder-list-action-all-btn-menu",BX("folder-list-action-all-btn"),[this.grid.getDeleteButton()?{text:BX.message("DISK_FOLDER_LIST_TITLE_GRID_TOOLBAR_MOVE_BUTTON"),onclick:BX.delegate(function(e){var t=BX.PopupMenu.getMenuById("folder-list-action-all-btn-menu");if(t){t.bindElement.setAttribute("data-group-action","move");this.initGroupActionButton();t.popupWindow.close()}},this)}:null,{text:BX.message("DISK_FOLDER_LIST_TITLE_GRID_TOOLBAR_COPY_BUTTON"),onclick:BX.delegate(function(e){var t=BX.PopupMenu.getMenuById("folder-list-action-all-btn-menu");if(t){t.bindElement.setAttribute("data-group-action","copy");this.initGroupActionButton();t.popupWindow.close()}},this)}],{autoHide:true})};e.prototype.onClickDeleteGroup=function(e){if(!this.grid.IsActionEnabled())return false;var t=document.getElementById("actallrows_"+this.grid.table_id);this.openConfirmDeleteGroup({attemptDeleteAll:t&&t.checked});BX.PreventDefault(e);return false};e.prototype.removeRow=function(e,t){this.grid.removeRow(e,t);BX.onCustomEvent("onRemoveRowFromDiskList",[e])};e.prototype.getRow=function(e){return this.grid.getRow(e)};e.prototype.getActionButtonByPseudoName=function(e,t){var s=this.getActionButtons(e,true);for(var i in s){if(!s.hasOwnProperty(i)){continue}if(s[i].getAttribute("data-pseudo-name")===t){return s[i]}}return null};e.prototype.getActionButtons=function(e,t){t=t||false;var s=[];var i=this.getActions(e);for(var a in i){if(!i.hasOwnProperty(a)){continue}var n=i[a];if(n&&n["PSEUDO_NAME"]){var o=n["PSEUDO_NAME"].toLowerCase();switch(o){case"open":if(s.length>0){s.push(BX.create("SPAN",{html:"&nbsp;"}))}s.push(BX.create("a",{attrs:{onclick:n["ONCLICK"]},text:n["TEXT"],style:{width:"145px"},props:{className:"bx-disk-btn bx-disk-btn-medium bx-disk-btn-green"}}));break;case"lock":case"unlock":case"share":case"delete":case"copy":case"connect":if(o==="lock"||o==="unlock"){if(!this.enabledObjectLock){break}if(!n["SHOW"]&&!t){break}}if(s.length>0){s.push(BX.create("SPAN",{html:"&nbsp;"}))}s.push(BX.create("a",{attrs:{onclick:n["ONCLICK"],"data-pseudo-name":o},text:n["TEXT"],style:{width:"145px"},props:{className:"js-panel-button bx-disk-btn bx-disk-btn-medium bx-disk-btn-lightgray"}}));break;case"internal_link":internalLink=n["PSEUDO_VALUE"];break}}}return s};e.prototype.getActions=function(e){var t=this.getRow(e);if(!t){return null}return t.oncontextmenu()};e.prototype.getActionByPseudoName=function(e,t){var s=this.getActions(e);if(!s){return null}for(var i in s){if(!s.hasOwnProperty(i)){continue}if(s[i].PSEUDO_NAME===t){return s[i]}}return null};e.prototype.getRowByCheckBox=function(e){return this.grid.getRowByCheckBox(e)};e.prototype.getCheckbox=function(e){return this.grid.getCheckbox(e)};e.prototype.renameInline=function(e){var t=this.getCheckbox(e);var s=this.grid;var i=s.table_id;if(t.checked!==true){t.checked=true;s.SelectRow(t);s.EnableActions()}var a={};for(var n in s.oSaveData){if(!s.oSaveData.hasOwnProperty(n)){continue}a[n]={};for(o in s.oSaveData[n]){if(!s.oSaveData[n].hasOwnProperty(o)){continue}a[n][o]=s.oSaveData[n][o]}}s.ActionEdit();for(n in a){if(!a.hasOwnProperty(n)){continue}for(var o in a[n]){if(!a[n].hasOwnProperty(o)){continue}s.oSaveData[n][o]=a[n][o]}}var r=BX.findChild(this.getRowByCheckBox(t),{tag:"input",attr:{type:"text"}},true);if(r){BX.focus(r)}var d=BX.findChild(BX("bx_grid_"+i+"_action_buttons"),{tag:"input",attr:{type:"button"}});d.onclick=function(){s.ActionCancel();var e=BX.findChild(BX(i),{tag:"td","class":"bx-checkbox-col"},true,true);for(var t=0;t<e.length;t++){var a=BX.findChild(e[t],{tag:"input"});if(BX.type.isDomNode(a)&&a.checked){a.checked=false;s.SelectRow(a)}}s.EnableActions()}};e.prototype.openConfirmDelete=function(e){var t=e.object.name;var s=e.object.id;var i=e.object.isFolder;var a=e.canDelete;var n="";if(i){n=BX.message(a?"DISK_FOLDER_LIST_TRASH_DELETE_DESTROY_FOLDER_CONFIRM":"DISK_FOLDER_LIST_TRASH_DELETE_FOLDER_CONFIRM")}else{n=BX.message(a?"DISK_FOLDER_LIST_TRASH_DELETE_DESTROY_FILE_CONFIRM":"DISK_FOLDER_LIST_TRASH_DELETE_FILE_CONFIRM")}var o=[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_TRASH_DELETE_BUTTON"),className:"popup-window-button-accept",events:{click:BX.delegate(function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","markDelete"),data:{objectId:s},onsuccess:BX.delegate(function(e){if(!e){return}if(e.status=="success"){this.removeRow(s,function(){BX.Disk.showModalWithStatusAction(e)});return}BX.Disk.showModalWithStatusAction(e)},this)});return false},this)}})];if(a){o.push(new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_TRASH_DESTROY_BUTTON"),events:{click:BX.delegate(function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","delete"),data:{objectId:s},onsuccess:BX.delegate(function(e){if(!e){return}if(e.status=="success"){this.removeRow(s,function(){BX.Disk.showModalWithStatusAction(e)});return}BX.Disk.showModalWithStatusAction(e)},this)});return false},this)}}))}o.push(new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_TRASH_CANCEL_DELETE_BUTTON"),events:{click:function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);return false}}}));BX.Disk.modalWindow({modalId:"bx-link-unlink-confirm",title:BX.message("DISK_FOLDER_LIST_TRASH_DELETE_TITLE"),contentClassName:"tac",contentStyle:{paddingTop:"70px",paddingBottom:"70px"},content:n.replace("#NAME#",t),buttons:o})};e.prototype.openConfirmDetach=function(e){var t=e.object.name;var s=e.object.id;var i=e.object.isFolder;var a=e.onSuccess;var n="";if(i){n=BX.message("DISK_FOLDER_LIST_DETACH_FOLDER_CONFIRM")}else{n=BX.message("DISK_FOLDER_LIST_DETACH_FILE_CONFIRM")}var o=[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_DETACH_BUTTON"),className:"popup-window-button-accept",events:{click:BX.delegate(function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","detach"),data:{objectId:s},onsuccess:BX.delegate(function(e){if(!e){return}if(e.status=="success"){if(BX.type.isFunction(a)){BX.delegate(a,this)(e)}else{this.removeRow(s,function(){BX.Disk.showModalWithStatusAction(e)})}return}BX.Disk.showModalWithStatusAction(e)},this)});return false},this)}}),new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_TRASH_CANCEL_DELETE_BUTTON"),events:{click:function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);return false}}})];BX.Disk.modalWindow({modalId:"bx-link-unlink-confirm",title:i?BX.message("DISK_FOLDER_LIST_DETACH_FOLDER_TITLE"):BX.message("DISK_FOLDER_LIST_DETACH_FILE_TITLE"),contentClassName:"tac",contentStyle:{paddingTop:"70px",paddingBottom:"70px"},content:n.replace("#NAME#",t),buttons:o})};e.prototype.openConfirmDeleteGroup=function(e){var t=BX.message("DISK_FOLDER_LIST_TRASH_DELETE_GROUP_CONFIRM");var s=[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_TRASH_DELETE_BUTTON"),className:"popup-window-button-accept",events:{click:BX.delegate(function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);this.grid.ActionDelete();return false},this)}}),new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_TRASH_CANCEL_DELETE_BUTTON"),events:{click:function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);return false}}})];BX.Disk.modalWindow({modalId:"bx-link-unlink-confirm",title:BX.message("DISK_FOLDER_LIST_TRASH_DELETE_TITLE"),contentClassName:"tac",contentStyle:{paddingTop:"70px",paddingBottom:"70px"},content:t,buttons:s})};e.prototype.connectObjectToDisk=function(e){var t=e.object.name;var s=e.object.id;var i=e.object.isFolder;BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","connectToUserStorage"),{id:"folder_list_connect_object_"+s,responseType:"json",postData:{objectId:s},afterSuccessLoad:function(e){if(!e){return}if(e.status=="success"){BX.Disk.showModalWithStatusAction({status:"success",message:i?BX.message("DISK_FOLDER_LIST_SUCCESS_CONNECT_TO_DISK_FOLDER").replace("#NAME#",t):BX.message("DISK_FOLDER_LIST_SUCCESS_CONNECT_TO_DISK_FILE").replace("#NAME#",t)})}else{e.errors=e.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:e.errors.pop().message})}}})};e.prototype.unlockFile=function(e){var t=e.object.name;var s=e.object.id;BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","unlock"),{id:"folder_list_unlock_object_"+s,responseType:"json",postData:{objectId:s},afterSuccessLoad:BX.delegate(function(e){if(!e){return}if(e.status=="success"){var i=this.getActionByPseudoName(s,"lock");if(i){i.SHOW=true}i=this.getActionByPseudoName(s,"unlock");if(i){i.SHOW=false}var a=this.getButtonInInfoPanelByPseudoName("unlock");if(a){a.parentNode.replaceChild(this.getActionButtonByPseudoName(s,"lock"),a)}this.hideLockIcon(s);BX.Disk.showModalWithStatusAction({status:"success",message:BX.message("DISK_FOLDER_LIST_SUCCESS_UNLOCKED_FILE").replace("#NAME#",t)})}else{e.errors=e.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:e.errors.pop().message})}},this)})};e.prototype.lockFile=function(e){var t=e.object.name;var s=e.object.id;BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","lock"),{id:"folder_list_lock_object_"+s,responseType:"json",postData:{objectId:s},afterSuccessLoad:BX.delegate(function(e){if(!e){return}if(e.status=="success"){var i=this.getActionByPseudoName(s,"lock");if(i){i.SHOW=false}i=this.getActionByPseudoName(s,"unlock");if(i){i.SHOW=true}var a=this.getButtonInInfoPanelByPseudoName("lock");if(a){a.parentNode.replaceChild(this.getActionButtonByPseudoName(s,"unlock"),a)}this.showLockIcon(s);BX.Disk.showModalWithStatusAction({status:"success",message:BX.message("DISK_FOLDER_LIST_SUCCESS_LOCKED_FILE").replace("#NAME#",t)})}else{e.errors=e.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:e.errors.pop().message})}},this)})};e.prototype.showLockIcon=function(e){var t=this.getRow(e);var s=BX.findChildByClassName(t,"js-lock-icon",true);if(s){BX.show(s,"block")}};e.prototype.hideLockIcon=function(e){var t=this.getRow(e);var s=BX.findChildByClassName(t,"js-lock-icon",true);if(s){BX.hide(s,"block")}};e.prototype.showShareInfoSmallView=function(e){var t=e.object.name;var s=e.object.id;var i=e.object.isFolder;var a=null;var n=window.event;if(n){a=n.target||n.srcElement}function o(e){if(e.type=="users"){return BX.create("a",{props:{href:e.url||BX.Disk.getPathToUser(e.entityId),target:"_blank",className:"bx-disk-people"},children:[e.avatar?BX.create("span",{style:{backgroundImage:"url("+e.avatar+")"},props:{className:"bx-disk-avatar"}}):null,BX.create("span",{text:e.name})]})}else{return BX.create("span",{props:{className:"bx-disk-people"},children:[e.avatar?BX.create("span",{style:{backgroundImage:"url("+e.avatar+")"},props:{className:"bx-disk-avatar"}}):null,BX.create("span",{text:e.name})]})}}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","showShareInfoSmallView"),data:{objectId:s},onsuccess:function(e){if(!e||e.status!="success"){return}var t=[];e.members=e.members||[];for(var s in e.members){if(!e.members.hasOwnProperty(s)){continue}t.push(o(e.members[s]));t.push(", ")}if(t){t.pop()}BX.Disk.modalWindow({closeIcon:null,autoHide:true,overlay:false,bindElement:a,modalId:"bx-disk-share-info-small-view",withoutContentWrap:true,events:{onAfterPopupShow:function(){},onPopupClose:function(){this.destroy()}},content:[BX.create("div",{props:{className:"bx-disk-popup-share-list"},style:{width:"450px"},children:[BX.message("DISK_FOLDER_LIST_DETAIL_SHARE_INFO_OWNER")+":",BX.create("br"),o(e.owner),BX.create("br"),BX.message("DISK_FOLDER_LIST_DETAIL_SHARE_INFO_HAVE_ACCESS")+":",BX.create("br")].concat(t)})]})}})};e.prototype.getFirstSelectedCheckbox=function(){var e;for(e in this.checkboxes){if(this.checkboxes.hasOwnProperty(e)&&typeof e!=="function"&&this.checkboxes[e]==true){break}}return this.getCheckbox(e)};e.prototype.addCheckbox=function(e){var t=e.value;if(!this.checkboxes[t]){this.checkboxes[t]=true}};e.prototype.deleteCheckbox=function(e){var t=e.value;if(this.checkboxes[t]){this.checkboxes[t]=false}};e.prototype.onClickGetDownloadArchiveInfoPanelButton=function(e,t){t=t||[];BX.Disk.ajax({url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","getUrlToDownloadArchive"),method:"POST",dataType:"json",data:{folderId:this.currentFolder.id,objectIds:t},onsuccess:BX.delegate(function(e){if(!e||e.status!="success"){BX.Disk.showModalWithStatusAction(e);return}document.location=e.downloadArchiveUrl},this)})};e.prototype.onClickCopyInInfoPanelButton=function(e){var t=null;var s=null;BX.addCustomEvent("onSelectFolder",BX.delegate(function(e){if(s){BX.removeClass(s,"selected")}t=e.getAttribute("data-object-id");s=e;var i=BX.findChild(s,{className:"bx-disk-wf-folder-name"},true);if(i){var a=BX.findChild(this.gridShowTreeButton,{tagName:"span"});if(a){var n=BX.findChild(i,{tagName:"span"})||{};BX.adjust(a,{text:n.textContent||n.innerText})}}t&&this.setGroupActionTargetObjectId(t);if(BX.PopupWindowManager.isPopupExists("bx-disk-toolbar-tree")){if(BX.PopupWindowManager.getCurrentPopup()){BX.PopupWindowManager.getCurrentPopup().close()}}},this));BX.addCustomEvent("onUnSelectFolder",function(e){t=null;s=null;var i=BX("grid_group_action_target_object");i&&BX.remove(i)});BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSubFoldersToAdd"),{id:"bx-disk-copy-modal-loader",responseType:"json",postData:{objectId:this.rootObject.id},afterSuccessLoad:BX.delegate(function(e){if(!e||e.status!="success"){BX.Disk.showModalWithStatusAction(e);return}var t=this.buildTreeNode(this.rootObject);var s=BX.create("ul",{props:{className:"bx-disk-wood-folder"}});t.appendChild(s);BX.Disk.modalWindow({modalId:"bx-disk-copy-tree",title:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_TREE"),events:{onPopupClose:function(){this.destroy()}},content:[BX.create("div",{props:{className:"bx-disk-popup-content-title"},text:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_MANY_COPY_TO")}),BX.create("ul",{props:{className:"bx-disk-wood-folder"},children:[t]})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_COPY_TO_BUTTON"),className:"webform-button-active",events:{click:BX.delegate(function(e){BX.PopupWindowManager.getCurrentPopup().close();BX.PreventDefault(e);this.actionGroupButton="copy";this.grid.SetActionName("copy");BX.submit(this.grid.GetForm());return false},this)}})]});this.buildTree(t,e)},this)})};e.prototype.areObjectsFiles=function(e){for(var s in e){if(!e.hasOwnProperty(s)){continue}var i=e[s];var a=BX.delegate(t,this)(i);if(BX.hasClass(a.icon,"bx-disk-folder-icon")){return false}}return true};e.prototype.showInfoPanelManyObject=function(e){var t="bx-disk-folder-icon double";var s=[];if(this.enabledModZip&&this.areObjectsFiles(e)){s.push(BX.create("a",{text:BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_MANY_DOWNLOAD_BUTTON"),style:{width:"145px"},props:{className:"bx-disk-btn bx-disk-btn-medium bx-disk-btn-green"},events:{click:BX.delegate(function(t){return this.onClickGetDownloadArchiveInfoPanelButton(t,e)},this)}}));s.push(BX.create("SPAN",{html:"&nbsp;"}))}s.push(BX.create("a",{text:BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_MANY_COPY_TO_BUTTON"),style:{width:"145px"},props:{className:"bx-disk-btn bx-disk-btn-medium bx-disk-btn-lightgray"},events:{click:BX.proxy(this.onClickCopyInInfoPanelButton,this)}}));s.push(BX.create("SPAN",{html:"&nbsp;"}));s.push(BX.create("a",{text:BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_MANY_DELETE_BUTTON"),style:{width:"145px"},props:{className:"bx-disk-btn bx-disk-btn-medium bx-disk-btn-lightgray"},events:{click:BX.delegate(function(e){BX.fireEvent(BX("delete_button_"+this.grid.table_id),"click")},this)}}));this.showInfoPanel({buttons:s,isFolder:false,isMany:true,icon:{className:t},title:{text:BX.Disk.getNumericCase(e.length,BX.message("DISK_FOLDER_LIST_SELECTED_OBJECT_1"),BX.message("DISK_FOLDER_LIST_SELECTED_OBJECT_21"),BX.message("DISK_FOLDER_LIST_SELECTED_OBJECT_2_4"),BX.message("DISK_FOLDER_LIST_SELECTED_OBJECT_5_20")).replace("#COUNT#",e.length)}})};e.prototype.showInfoPanelSingleObject=function(e){this.currentObjectIdInInfoPanel=e;var s="";var i=BX.delegate(t,this)(e);var a=i.row;var n=i.title;var o=i.icon;var r="bx-file-icon-container-small bx-disk-file-icon";if(o){r=o.className}if(!n){return}if(!a.oncontextmenu){return}this.showInfoPanel({buttons:this.getActionButtons(e),internalLink:s,isFolder:BX.hasClass(o,"bx-disk-folder-icon"),icon:{className:r},objectId:e,title:{text:n.text,date:n.getAttribute("data-bx-dateModify"),href:n.getAttribute("href")}})};function i(e,t){if(!e.oncontextmenu){return{}}var s=e.oncontextmenu();for(var i in s){if(!s.hasOwnProperty(i)){continue}var a=s[i];if(!a||!a["PSEUDO_NAME"]){continue}if(a["PSEUDO_NAME"]===t){return a}}return{}}e.prototype.getButtonInInfoPanelByPseudoName=function(e){var t=BX.findChildByClassName(this.infoPanelContainer,"js-info-panel-buttons");if(!t){return null}return BX.findChild(t,{className:"js-panel-button",attribute:{"data-pseudo-name":e}},true)};e.prototype.createButtonsInInfoPanel=function(e){var t=e.icon;var s=e.title;var i=e.buttons;return BX.create("div",{props:{className:"js-info-panel bx-disk-info-panel bx-disk-sidebar-section"},children:[BX.create("div",{props:{className:"bx-disk-info-panel-relative"},children:[BX.create("div",{props:{className:"bx-disk-info-panel-icon"},children:[BX.create("div",{props:{className:t.className}})]}),BX.create("div",{props:{className:"bx-disk-info-panel-element-name-container"},children:[BX.create("div",{props:{id:"disk_info_panel_name",className:"bx-disk-info-panel-name"},children:[BX.create("a",{text:s.text,props:{title:s.text,href:s.href||"javascript:void(0);"}})]}),BX.create("div",{text:s.date,props:{className:"bx-disk-info-panel-date"}})]}),BX.create("div",{props:{className:"bx-disk-info-panel-context"}})]}),BX.create("div",{props:{className:"tal js-info-panel-buttons"},children:i})]})};e.prototype.showInfoPanel=function(e){var t=e.title||{};var s=e.icon||{};var i=e.buttons||[];var a=e.internalLink||"";var n=e.isFolder;var o=!!e.isMany;var r=e.objectId||null;if(!t){return}var d=BX("disk_info_panel");var l=BX("bx_disk_empty_select_section");if(l)BX.hide(l);d.style.overflow="hidden";d.style.height=0;BX.cleanNode(d);this.containerWithExtAndIntLinks=null;var c=BX.create("div");d.appendChild(c);var p=this.createButtonsInInfoPanel({title:t,icon:s,buttons:i});c.appendChild(p);if(!n&&r&&!o&&this.enabledExternalLink){var u=this.getContainerWithExtAndIntLinks({objectId:r,internalLink:a});c.appendChild(u)}else{this.hideContainerWithExtAndIntLinks()}new BX.easing({duration:300,start:{opacity:0,height:0},finish:{opacity:100,height:c.offsetHeight},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(e){d.style.height=e.height+"px";d.style.opacity=e.opacity/100},complete:BX.delegate(function(){d.style.cssText="";d.style.display="block"},this)}).animate()};e.prototype.showContainerWithExtAndIntLinks=function(){if(!this.containerWithExtAndIntLinks){return}BX.show(this.containerWithExtAndIntLinks,"block")};e.prototype.hideContainerWithExtAndIntLinks=function(){if(!this.containerWithExtAndIntLinks){
return}BX.hide(this.containerWithExtAndIntLinks);this.switchOffExtLinkInPanel()};e.prototype.getExternalLinkByObjectId=function(e){if(this.cacheExternalLinks[e]){return this.cacheExternalLinks[e]}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","getExternalLink"),data:{objectId:e},onsuccess:BX.delegate(function(t){if(!t||t.status!="success"){return}if(t.link){this.switchOnExtLinkInPanel(t);this.cacheExternalLinks[e]=t.link}else{this.switchOffExtLinkInPanel()}},this)});return""};e.prototype.switchOffExtLinkInPanel=function(e){var t=BX("bx-disk-sidebar-shared-outlink-input");var s=BX("bx-disk-sidebar-shared-outlink-label");if(!t||!s)return;t.value="";BX.adjust(s,{text:BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_LINK_OFF")});BX.removeClass(s.parentNode,"on");BX.addClass(s.parentNode,"off");BX.hide(BX("bx-disk-sidebar-shared-param"))};e.prototype.switchOnExtLinkInPanel=function(e){var t=BX("bx-disk-sidebar-shared-outlink-input");var s=BX("bx-disk-sidebar-shared-outlink-label");if(!t||!s)return;t.value=e.link||"";BX.adjust(s,{text:BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_LINK_ON")});BX.removeClass(s.parentNode,"off");BX.addClass(s.parentNode,"on");BX.show(BX("bx-disk-sidebar-shared-param"),"block")};e.prototype.switchOffExtLinkInModal=function(e){var t=BX("bx-disk-ext-link-url");var s=BX("bx-disk-sidebar-shared-outlink-label-modal");if(!t||!s)return;t.value="";BX.adjust(s,{text:BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_LINK_OFF")});BX.removeClass(s.parentNode,"on");BX.addClass(s.parentNode,"off");BX("bx-disk-extended-settings-extlink")&&BX.hide(BX("bx-disk-extended-settings-extlink"));BX("bx-disk-extended-text-extlink")&&BX.hide(BX("bx-disk-extended-text-extlink"))};e.prototype.switchOnExtLinkInModal=function(e){var t=BX("bx-disk-ext-link-url");var s=BX("bx-disk-sidebar-shared-outlink-label-modal");if(!t||!s)return;t.value=e.link||"";BX.adjust(s,{text:BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_LINK_ON")});BX.removeClass(s.parentNode,"off");BX.addClass(s.parentNode,"on");BX.show(BX("bx-disk-extended-settings-extlink"),"block")};e.prototype.onClickExternalSwitcherSidebar=function(e){if(!this.currentObjectIdInInfoPanel){return}var t=e.target||e.srcElement;if(BX.hasClass(t.parentNode,"on")){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","disableExternalLink"),data:{objectId:this.currentObjectIdInInfoPanel},onsuccess:BX.delegate(function(e){this.cacheExternalLinks[this.currentObjectIdInInfoPanel]=""},this)});this.switchOffExtLinkInPanel()}else{BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","generateExternalLink"),data:{objectId:this.currentObjectIdInInfoPanel},onsuccess:BX.delegate(function(e){if(!e||e.status!="success"){return}this.switchOnExtLinkInPanel(e);this.cacheExternalLinks[this.currentObjectIdInInfoPanel]=e.link},this)})}};e.prototype.onClickExternalSwitcherModal=function(e){var t=e.target||e.srcElement;var s=t.getAttribute("bx-disk-objectId");if(BX.hasClass(t.parentNode,"on")){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","disableExternalLink"),data:{objectId:s},onsuccess:BX.delegate(function(e){this.cacheExternalLinks[s]=""},this)});this.switchOffExtLinkInPanel();this.switchOffExtLinkInModal()}else{BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","generateExternalLink"),data:{objectId:s},onsuccess:BX.delegate(function(e){if(!e||e.status!="success"){return}this.switchOnExtLinkInPanel(e);this.switchOnExtLinkInModal(e);this.cacheExternalLinks[s]=e.link},this)})}};e.prototype.openExternalLinkDetailSettings=function(e){BX.PreventDefault(e);BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","getDetailSettingsExternalLink"),{id:"bx-disk-external-link-loader",responseType:"json",postData:{objectId:this.currentObjectIdInInfoPanel},afterSuccessLoad:BX.delegate(function(e){if(!e||e.status!="success"){BX.Disk.showModalWithStatusAction(e);return}var t;if(e.linkData.hasDeathTime||e.linkData.hasPassword){t='<div class="bx-disk-popup-content-title noborder">'+e.object.name+" "+'<span class="fwn">'+e.object.size+", "+e.object.date+"</span>"+"</div>"+(e.linkData.hasDeathTime?"<div>"+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_USED_DEATH_TIME").replace("#DATE#",e.linkData.deathTime)+" </div>":"")+(e.linkData.hasPassword?"<div>"+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_USED_PASSWORD")+" </div>":"")}else{t='<div class="bx-disk-popup-content-title noborder">'+e.object.name+" "+'<span class="fwn">'+e.object.size+", "+e.object.date+"</span>"+"</div>"+'<form autocomplete="false" action="">'+'<ul class="bx-disk-popup-share-link-param-list">'+"<li>"+'<input id="bx-disk-ext-use-death-time" '+(e.linkData.hasDeathTime?'checked="checked"':"")+' type="checkbox">'+'<label for="bx-disk-ext-use-death-time">'+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_USE_DEATH_TIME")+" </label>"+'<span id="bx-disk-ext-use-death-time-table" '+(e.linkData.hasDeathTime?"":'style="display: none;"')+'><input id="bx-disk-ext-use-death-time-value" type="text" autocomplete="false" class="bx-disk-popup-input bx-disk-popup-share-input" style="height: 31px;">'+'<span id="bx-disk-ext-select-time" class="popup-control" style="vertical-align: initial;">'+'<span class="popup-current">'+'<span class="popup-current-text fwn" style="line-height: 29px;height: 29px;">'+'<span id="bx-disk-ext-select-time-text">'+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_HOUR")+"<span>"+'<span class="icon-arrow"></span>'+"</span>"+"</span>"+"</span></span>"+"</li>"+"<li>"+'<input id="bx-disk-ext-use-password" '+(e.linkData.hasPassword?'checked="checked"':"")+' type="checkbox">'+'<label for="bx-disk-ext-use-password">'+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_USE_PASSWORD")+"</label>"+'<table id="bx-disk-ext-use-password-table" class="bx-disk-popup-share-password" '+(e.linkData.hasPassword?"":'style="display: none;"')+">"+"<tbody><tr>"+"<td>"+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_INPUT_PASSWORD")+":</td>"+'<td><input id="bx-disk-ext-use-password-value" type="password" readonly onfocus="this.removeAttribute(\'readonly\');" class="bx-disk-popup-input" style="height: 31px;"></td>'+"</tr>"+"</tbody></table>"+"</li>"+"</ul>"+"</form>"}var s=60*60;var i=[new BX.PopupWindowButton({id:"bx-disk-btn-save",text:BX.message("DISK_FOLDER_LIST_BTN_SAVE"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){var e=(parseInt(BX("bx-disk-ext-use-death-time-value").value,10)||0)*s;BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","saveSettingsExternalLink"),data:{objectId:this.currentObjectIdInInfoPanel,deathTime:e,password:BX("bx-disk-ext-use-password-value").value},onsuccess:function(e){BX.PopupWindowManager.getCurrentPopup().close();BX.Disk.showModalWithStatusAction(e)}})},this)}}),new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CLOSE"),events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})];var a=BX.delegate(function(){var e=false;return function(){if(e)return;e=true;BX.show(BX("bx-disk-btn-save"))}},this)();BX.Disk.modalWindow({modalId:"bx-disk-external-link",title:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_GET_EXT_LINK"),events:{onPopupShow:function(){BX.hide(BX("bx-disk-btn-save"))},onAfterPopupShow:BX.delegate(function(){BX.bind(BX("bx-disk-ext-use-password"),"click",function(e){if(this.checked){BX.show(BX("bx-disk-ext-use-password-table"),"block")}else{BX("bx-disk-ext-use-password-value").value="";BX.hide(BX("bx-disk-ext-use-password-table"))}});BX.bind(BX("bx-disk-ext-use-password-value"),"change",BX.once(BX("bx-disk-ext-use-password-value"),"change",BX.delegate(a,this)));BX.bind(BX("bx-disk-ext-use-death-time-value"),"change",BX.once(BX("bx-disk-ext-use-death-time-value"),"change",BX.delegate(a,this)));BX.bind(BX("bx-disk-ext-use-death-time"),"click",function(e){if(this.checked){BX.show(BX("bx-disk-ext-use-death-time-table"),"inline")}else{BX.hide(BX("bx-disk-ext-use-death-time-table"))}});var e=this;BX.bind(BX("bx-disk-ext-select-time"),"click",function(){BX.PopupMenu.show("bx-disk-ext-select-time",this,[{text:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_MIN"),title:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_MIN"),href:"#",onclick:function(t,i){BX.PreventDefault(t);BX.delegate(a,e)();BX.adjust(BX("bx-disk-ext-select-time-text"),{text:i.text});s=60}},{text:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_HOUR"),title:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_HOUR"),href:"#",onclick:function(t,i){BX.PreventDefault(t);BX.delegate(a,e)();BX.adjust(BX("bx-disk-ext-select-time-text"),{text:i.text});s=60*60}},{text:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_DAY"),title:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_DAY"),href:"#",onclick:function(t,i){BX.PreventDefault(t);BX.delegate(a,e)();BX.adjust(BX("bx-disk-ext-select-time-text"),{text:i.text});s=24*60*60}}],{autoHide:true,offsetTop:0,zIndex:1e4,offsetLeft:55,angle:{offset:45},events:{onPopupClose:function(){}}})})},this),onPopupClose:function(){BX.PopupMenu.destroy("bx-disk-ext-select-time");this.destroy()}},content:[t],buttons:i})},this)});return false};e.prototype.openExternalLinkDetailSettingsWithEditing=function(e){BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","getDetailSettingsExternalLinkForceCreate"),{id:"bx-disk-external-link-loader",responseType:"json",postData:{objectId:e},afterSuccessLoad:BX.delegate(function(t){if(!t||t.status!="success"){BX.Disk.showModalWithStatusAction(t);return}var s="";s+='<input id="bx-disk-ext-link-url" style="max-width: 400px;" class="bx-disk-popup-input" type="text" value="'+t.linkData.link+'">';if(t.linkData.hasDeathTime||t.linkData.hasPassword){s+='<div id="bx-disk-extended-text-extlink" style="padding-top: 10px;">'+(t.linkData.hasDeathTime?"<div>"+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_USED_DEATH_TIME").replace("#DATE#",t.linkData.deathTime)+" </div>":"")+(t.linkData.hasPassword?"<div>"+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_USED_PASSWORD")+" </div>":"")+"</div>"}s+='<div id="bx-disk-extended-settings-extlink"'+(t.linkData.hasDeathTime||t.linkData.hasPassword?'style="display:none"':"")+">"+'<div style="padding-top: 10px;">'+'<a class="bx-disk-popup-share-link-more" href="#" onclick="BX.toggle(BX(\'bx-disk-popup-share-link-param-modal\')); return false;">'+BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_PARAMS")+"</a>"+"</div>"+'<div id="bx-disk-popup-share-link-param-modal" style="display: none;"><form autocomplete="false" action="">'+'<ul class="bx-disk-popup-share-link-param-list">'+"<li>"+'<input id="bx-disk-ext-use-death-time" '+(t.linkData.hasDeathTime?'checked="checked"':"")+' type="checkbox">'+'<label for="bx-disk-ext-use-death-time">'+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_USE_DEATH_TIME")+" </label>"+'<span id="bx-disk-ext-use-death-time-table" '+(t.linkData.hasDeathTime?"":'style="display: none;"')+'><input id="bx-disk-ext-use-death-time-value" type="text" autocomplete="false" class="bx-disk-popup-input bx-disk-popup-share-input" style="height: 31px;">'+'<span id="bx-disk-ext-select-time" class="popup-control" style="vertical-align: initial;">'+'<span class="popup-current">'+'<span class="popup-current-text fwn" style="line-height: 29px;height: 29px;">'+'<span id="bx-disk-ext-select-time-text">'+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_HOUR")+"<span>"+'<span class="icon-arrow"></span>'+"</span>"+"</span>"+"</span></span>"+"</li>"+"<li>"+'<input id="bx-disk-ext-use-password" '+(t.linkData.hasPassword?'checked="checked"':"")+' type="checkbox">'+'<label for="bx-disk-ext-use-password">'+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_USE_PASSWORD")+"</label>"+'<table id="bx-disk-ext-use-password-table" class="bx-disk-popup-share-password" '+(t.linkData.hasPassword?"":'style="display: none;"')+">"+"<tbody><tr>"+"<td>"+BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_INPUT_PASSWORD")+":</td>"+'<td><input autocomplete="false" id="bx-disk-ext-use-password-value" type="password" readonly onfocus="this.removeAttribute(\'readonly\');" class="bx-disk-popup-input" style="height: 31px;"></td>'+"</tr>"+"</tbody></table>"+"</li>"+"</ul>"+"</form></div>"+"</div>";var i=60*60;var a=[new BX.PopupWindowButton({id:"bx-disk-btn-save",text:BX.message("DISK_FOLDER_LIST_BTN_SAVE"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){var t=(parseInt(BX("bx-disk-ext-use-death-time-value").value,10)||0)*i;BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","saveSettingsExternalLink"),data:{objectId:e,deathTime:t,password:BX("bx-disk-ext-use-password").checked?BX("bx-disk-ext-use-password-value").value:""},onsuccess:function(e){BX.PopupWindowManager.getCurrentPopup().close();BX.Disk.showModalWithStatusAction(e)}})},this)}}),new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CLOSE"),events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})];var n=BX.delegate(function(){var e=false;return function(){if(e)return;e=true;BX.show(BX("bx-disk-btn-save"))}},this)();BX.Disk.modalWindow({modalId:"bx-disk-external-link",title:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_GET_EXT_LINK"),events:{onPopupShow:function(){BX.hide(BX("bx-disk-btn-save"))},onAfterPopupShow:BX.delegate(function(){BX.focus(BX("bx-disk-ext-link-url"));BX("bx-disk-ext-link-url").setSelectionRange(0,BX("bx-disk-ext-link-url").value.length);BX.bind(BX("bx-disk-ext-use-password"),"click",function(e){if(this.checked){BX.show(BX("bx-disk-ext-use-password-table"),"block")}else{BX("bx-disk-ext-use-password-value").value="";BX.hide(BX("bx-disk-ext-use-password-table"))}});BX.bind(BX("bx-disk-ext-use-password-value"),"change",BX.once(BX("bx-disk-ext-use-password-value"),"change",BX.delegate(n,this)));BX.bind(BX("bx-disk-ext-use-death-time-value"),"change",BX.once(BX("bx-disk-ext-use-death-time-value"),"change",BX.delegate(n,this)));BX.bind(BX("bx-disk-ext-use-death-time"),"click",function(e){if(this.checked){BX.show(BX("bx-disk-ext-use-death-time-table"),"inline")}else{BX.hide(BX("bx-disk-ext-use-death-time-table"))}});var e=this;BX.bind(BX("bx-disk-ext-select-time"),"click",function(){BX.PopupMenu.show("bx-disk-ext-select-time",this,[{text:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_MIN"),title:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_MIN"),href:"#",onclick:function(t,s){BX.PreventDefault(t);BX.delegate(n,e)();BX.adjust(BX("bx-disk-ext-select-time-text"),{text:s.text});i=60}},{text:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_HOUR"),title:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_HOUR"),href:"#",onclick:function(t,s){BX.PreventDefault(t);BX.delegate(n,e)();BX.adjust(BX("bx-disk-ext-select-time-text"),{text:s.text});i=60*60}},{text:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_DAY"),title:BX.message("DISK_FOLDER_LIST_TITLE_EXT_PARAMS_TIME_DAY"),href:"#",onclick:function(t,s){BX.PreventDefault(t);BX.delegate(n,e)();BX.adjust(BX("bx-disk-ext-select-time-text"),{text:s.text});i=24*60*60}}],{autoHide:true,offsetTop:0,zIndex:1e4,offsetLeft:55,angle:{offset:45},events:{onPopupClose:function(){}}})})},this),onPopupClose:function(){BX.PopupMenu.destroy("bx-disk-ext-select-time");this.destroy()}},content:[BX.create("div",{props:{className:"bx-disk-sidebar-shared-outlink-switcher-container"},children:[BX.create("div",{props:{className:"bx-disk-sidebar-shared-outlink-switcher-track on"},children:[BX.create("span",{props:{id:"bx-disk-sidebar-shared-outlink-label-modal"},text:BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_LINK_ON")}),BX.create("div",{props:{className:"bx-disk-sidebar-shared-outlink-switcher-point"},attrs:{"bx-disk-objectId":e},events:{click:BX.proxy(this.onClickExternalSwitcherModal,this)}})]})]}),BX.create("div",{html:s})],buttons:a})},this)});return false};e.prototype.getContainerWithExtAndIntLinks=function(e){var t=e.internalLink||"";var s=e.externalLink||"";var i=e.objectId||"";if(i&&!s){s=this.getExternalLinkByObjectId(i)}var a=BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_LINK_OFF");if(s){a=BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_LINK_ON")}if(!this.containerWithExtAndIntLinks){this.containerWithExtAndIntLinks=BX.create("div",{props:{className:"bx-disk-sidebar-section"},children:[BX.create("div",{props:{className:"bx-disk-sidebar-shared-container"},children:[BX.create("div",{props:{className:"bx-disk-sidebar-shared-title"},children:[BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_LINK"),BX.create("a",{text:BX.message("DISK_FOLDER_LIST_TITLE_SIDEBAR_EXT_PARAMS"),props:{id:"bx-disk-sidebar-shared-param",href:"#",className:"bx-disk-sidebar-shared-param"},events:{click:BX.proxy(this.openExternalLinkDetailSettings,this)}})]}),BX.create("div",{props:{className:"bx-disk-sidebar-shared-outlink-container"},children:[BX.create("div",{props:{className:"bx-disk-sidebar-shared-outlink-switcher-container"},children:[BX.create("div",{props:{className:"bx-disk-sidebar-shared-outlink-switcher-track "+(s?"on":"off")},children:[BX.create("span",{props:{id:"bx-disk-sidebar-shared-outlink-label"},text:a}),BX.create("div",{props:{className:"bx-disk-sidebar-shared-outlink-switcher-point"},events:{click:BX.proxy(this.onClickExternalSwitcherSidebar,this)}})]})]}),BX.create("div",{props:{className:"bx-disk-sidebar-shared-outlink-input-container"},children:[BX.create("input",{props:{id:"bx-disk-sidebar-shared-outlink-input",className:"bx-disk-sidebar-shared-outlink-input",type:"text",value:s},events:{click:function(e){BX.focus(this);this.setSelectionRange(0,this.value.length)}}})]})]})]})]});return this.containerWithExtAndIntLinks}if(s){this.switchOnExtLinkInPanel({link:s})}return this.containerWithExtAndIntLinks};var a;e.prototype.onScroll=function(){if(!BX.type.isFunction(a)){a=BX.throttle(function(){var e=BX("bx-disk-container",true);var t=BX("disk_info_panel",true);if(e){var s=e.getBoundingClientRect().top;if(s<=0){BX.style(t.parentNode,"paddingTop",t.offsetHeight+30+"px");BX.addClass(t,"attached-panel")}else{t.parentNode.style.cssText="";BX.removeClass(t,"attached-panel")}}},150,this)}a()};e.prototype.onBeforeElementShow=function(e,t,s){if(t.hasOwnProperty("image")||!BX.message("disk_restriction")){return}s.prevent=true;BX.PopupWindowManager.create("bx-disk-business-tools-info",null,{content:BX("bx-bitrix24-business-tools-info"),closeIcon:true,onPopupClose:function(){this.destroy()},autoHide:true,zIndex:11e3}).show()};e.prototype.onIframeElementLoadDataToView=function(e,t){if(t&&t.status==="restriction"&&BX("bx-bitrix24-business-tools-info")){if(BX.CViewer&&BX.CViewer.objNowInShow){if(e.currentModalWindow){e.currentModalWindow.close()}BX.CViewer.objNowInShow.close()}BX.PopupWindowManager.create("bx-disk-business-tools-info",null,{content:BX("bx-bitrix24-business-tools-info"),closeIcon:true,onPopupClose:function(){this.destroy()},autoHide:true,zIndex:11e3}).show()}};e.prototype.onSelectRow=function(e,t,s){this.addCheckbox(s);if(t==1){this.showInfoPanelSingleObject(s.value)}else{var i=this.grid.GetCheckedCheckboxes();var a=[];for(var n in i){if(!i.hasOwnProperty(n)||i[n].name!="ID[]"){continue}a.push(i[n].value)}this.showInfoPanelManyObject(a)}};e.prototype.onUnSelectRow=function(e,t,s){this.deleteCheckbox(s);if(t==0){var i=s.value;var a=BX("disk_info_panel");var n=BX.firstChild(a);new BX.easing({duration:300,start:{opacity:100,height:n.offsetHeight},finish:{opacity:0,height:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(e){a.style.height=e.height+"px";a.style.opacity=e.opacity/100},complete:BX.delegate(function(){a.style.cssText="";a.style.display="none";var e=BX("bx_disk_empty_select_section");if(e)BX.show(e,"block")},this)}).animate()}else{this.onSelectRow(e,t,this.getFirstSelectedCheckbox())}};e.prototype.getExternalLink=function(e){BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","generateExternalLink"),{id:"bx-disk-external-link-loader",responseType:"json",postData:{objectId:e},afterSuccessLoad:BX.delegate(function(t){if(!t||t.status!="success"){BX.Disk.showModalWithStatusAction(t);return}this.cacheExternalLinks[e]=t.link;BX.Disk.modalWindow({modalId:"bx-disk-external-link",title:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_GET_EXT_LINK"),contentClassName:"tac",contentStyle:{},events:{onAfterPopupShow:function(){var e=BX("disk-get-external-link");BX.focus(e);e.setSelectionRange(0,e.value.length)},onPopupClose:function(){this.destroy()}},content:[BX.create("label",{props:{className:"bx-disk-popup-label","for":"disk-get-external-link"}}),BX.create("input",{style:{marginTop:"10px"},props:{id:"disk-get-external-link",className:"bx-viewer-inp",type:"text",value:t.link}})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CLOSE"),events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})},this)});return false};e.prototype.getInternalLink=function(e){BX.Disk.modalWindow({modalId:"bx-disk-internal-link",title:BX.message("DISK_FOLDER_LIST_ACT_COPY_INTERNAL_LINK"),contentClassName:"tac",contentStyle:{},events:{onAfterPopupShow:function(){var e=BX("disk-get-internal-link");BX.focus(e);e.setSelectionRange(0,e.value.length)},onPopupClose:function(){this.destroy()}},content:[BX.create("label",{props:{className:"bx-disk-popup-label","for":"disk-get-internal-link"}}),BX.create("input",{style:{marginTop:"10px"},props:{id:"disk-get-internal-link",className:"bx-viewer-inp",type:"text",value:e}})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CLOSE"),events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})};e.prototype.loadSubFolders=function(e){if(!e){return}var t=e.getAttribute("data-object-id");if(!t){return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSubFoldersToAdd"),data:{objectId:t},onsuccess:BX.delegate(function(t){if(!t||t.status!="success"){BX.Disk.showModalWithStatusAction(t);return}this.buildTree(e,t)},this)})};e.prototype.buildTree=function(e,t,s){s=s||{};if(!t||t.status!="success"){BX.Disk.showModalWithStatusAction(t);return}var i=BX.create("ul",{props:{className:"bx-disk-wood-folder"}});e.appendChild(i);if(t.items&&t.items.length){for(var a in t.items){if(!t.items.hasOwnProperty(a)){continue}if(t.items[a].id==s.id)continue;i.appendChild(this.buildTreeNode(t.items[a]))}}else{var n=BX.findChild(e,{className:"bx-disk-wf-arrow"},true);if(n){BX.cleanNode(n)}}BX.removeClass(e,"bx-disk-close");BX.addClass(e,"bx-disk-open");BX.addClass(e,"bx-disk-loaded")};e.prototype.buildTreeNode=function(e){return BX.create("li",{props:{className:"bx-disk-folder-container bx-disk-parent bx-disk-close "+(!e.canAdd?"bx-disk-only-view":"bx-disk-can-select")},attrs:{"data-object-id":e.id,"data-can-add":!!e.canAdd},children:[BX.create("div",{props:{className:"bx-disk-folder-container"},children:[BX.create("table",{children:[BX.create("tr",{children:[BX.create("td",{props:{className:"bx-disk-wf-arrow"},events:{click:BX.delegate(function(e){var t=e.target||e.srcElement;var s=BX.findParent(t,{className:"bx-disk-parent"});if(BX.hasClass(s,"bx-disk-open")){BX.removeClass(s,"bx-disk-open");BX.addClass(s,"bx-disk-close");return}if(BX.hasClass(s,"bx-disk-loaded")){BX.removeClass(s,"bx-disk-close");BX.addClass(s,"bx-disk-open");return}this.loadSubFolders(s)},this)},children:[e.hasSubFolders?BX.create("span"):null]}),BX.create("td",{props:{className:"bx-disk-wf-folder-icon"},events:{click:BX.delegate(function(e){var t=e.target||e.srcElement;var s=BX.findParent(t,{className:"bx-disk-parent"});if(BX.hasClass(s,"selected")){BX.removeClass(s,"selected");BX.onCustomEvent("onUnSelectFolder",[s]);return}BX.addClass(s,"selected");BX.onCustomEvent("onSelectFolder",[s])},this)},children:[BX.create("span")]}),BX.create("td",{props:{className:"bx-disk-wf-folder-name"},events:{click:BX.delegate(function(e){var t=e.target||e.srcElement;var s=BX.findParent(t,{className:"bx-disk-parent"});if(BX.hasClass(s,"selected")){BX.removeClass(s,"selected");BX.onCustomEvent("onUnSelectFolder",[s]);return}BX.addClass(s,"selected");BX.onCustomEvent("onSelectFolder",[s])},this)},children:[BX.create("span",{text:e.name})]})]})]})]})]})};e.prototype.openCopyModalWindow=function(e,t){var s=null;var i=null;BX.addCustomEvent("onSelectFolder",function(e){if(!e.getAttribute("data-can-add")){BX.removeClass(e,"selected");return}if(i){BX.removeClass(i,"selected")}s=e.getAttribute("data-object-id");i=e});BX.addCustomEvent("onUnSelectFolder",function(e){s=null;i=null});BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSubFoldersToAdd"),{id:"bx-disk-copy-modal-loader",responseType:"json",postData:{objectId:e.id},afterSuccessLoad:BX.delegate(function(i){if(!i||i.status!="success"){BX.Disk.showModalWithStatusAction(i);return}var a=this.buildTreeNode(e);var n=BX.create("ul",{props:{className:"bx-disk-wood-folder"}});a.appendChild(n);BX.Disk.modalWindow({modalId:"bx-disk-copy-tree",title:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_TREE"),events:{onPopupClose:function(){this.destroy()}},content:[BX.create("div",{props:{className:"bx-disk-popup-content-title"},text:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_COPY_TO").replace("#NAME#",t.name)}),BX.create("ul",{props:{className:"bx-disk-wood-folder"},children:[a]})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_COPY_TO_BUTTON"),className:"webform-button-active",events:{click:BX.delegate(function(e){if(!s){BX.PreventDefault(e);return false}BX.PopupWindowManager.getCurrentPopup().close();BX.PreventDefault(e);BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","copyTo"),data:{objectId:t.id,targetObjectId:s},onsuccess:function(e){if(!e){return}if(e.status=="success"){BX.Disk.showModalWithStatusAction(e);return}BX.Disk.showModalWithStatusAction(e)}});return false},this)}})]});this.buildTree(a,i)},this)})};e.prototype.openMoveModalWindow=function(e,t){var s=null;var i=null;BX.addCustomEvent("onSelectFolder",function(e){if(!e.getAttribute("data-can-add")){BX.removeClass(e,"selected");return}if(i){BX.removeClass(i,"selected")}s=e.getAttribute("data-object-id");i=e});BX.addCustomEvent("onUnSelectFolder",function(e){s=null;i=null});BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSubFoldersToAdd"),{id:"bx-disk-move-modal-loader",responseType:"json",postData:{objectId:e.id},afterSuccessLoad:BX.delegate(function(i){if(!i||i.status!="success"){BX.Disk.showModalWithStatusAction(i);return}var a=this.buildTreeNode(e);var n=BX.create("ul",{props:{className:"bx-disk-wood-folder"}});a.appendChild(n);BX.Disk.modalWindow({modalId:"bx-disk-copy-tree",title:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_TREE"),events:{onPopupClose:function(){this.destroy()}},content:[BX.create("div",{props:{className:"bx-disk-popup-content-title"},text:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_MOVE_TO").replace("#NAME#",t.name)}),BX.create("ul",{props:{className:"bx-disk-wood-folder"},children:[a]})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_TITLE_MODAL_MOVE_TO_BUTTON"),className:"webform-button-active",events:{click:BX.delegate(function(e){if(!s){BX.PreventDefault(e);return false}BX.PopupWindowManager.getCurrentPopup().close();BX.PreventDefault(e);BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","moveTo"),data:{objectId:t.id,targetObjectId:s},onsuccess:BX.delegate(function(e){if(!e){return}if(e.status=="success"){this.removeRow(e.id);BX.Disk.showModalWithStatusAction(e);return}BX.Disk.showModalWithStatusAction(e)},this)});return false},this)}})]});this.buildTree(a,i,t)},this)})};var n=false;var o={};var r={};var d={};var l={};var c={};var p={};var u="";e.prototype.showSharingDetailWithChangeRights=function(e){c={};p={};e=e||{};var t=e.object.id;BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSharingDetailChangeRights"),{id:"folder_list_sharing_detail_object_"+t,responseType:"json",postData:{objectId:t},afterSuccessLoad:BX.delegate(function(e){if(e.status!="success"){e.errors=e.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:e.errors.pop().message})}var i={name:e.owner.name,avatar:e.owner.avatar,link:e.owner.link};BX.Disk.modalWindow({modalId:"bx-disk-detail-sharing-folder-change-right",title:BX.message("DISK_FOLDER_LIST_SHARING_TITLE_MODAL_2"),contentClassName:"",contentStyle:{},events:{onAfterPopupShow:BX.delegate(function(){BX.addCustomEvent("onChangeRightOfSharing",BX.proxy(this.onChangeRightOfSharing,this));for(var t in e.members){if(!e.members.hasOwnProperty(t)){continue}c[e.members[t].entityId]={item:{id:e.members[t].entityId,name:e.members[t].name,avatar:e.members[t].avatar},type:e.members[t].type,right:e.members[t].right}}BX.SocNetLogDestination.init({name:this.destFormName,searchInput:BX("feed-add-post-destination-input"),bindMainPopup:{node:BX("feed-add-post-destination-container"),offsetTop:"5px",offsetLeft:"15px"},bindSearchPopup:{node:BX("feed-add-post-destination-container"),offsetTop:"5px",offsetLeft:"15px"},callback:{select:BX.proxy(this.onSelectDestination,this),unSelect:BX.proxy(this.onUnSelectDestination,this),openDialog:BX.proxy(this.onOpenDialogDestination,this),closeDialog:BX.proxy(this.onCloseDialogDestination,this),openSearch:BX.proxy(this.onOpenSearchDestination,this),closeSearch:BX.proxy(this.onCloseSearchDestination,this)},items:e.destination.items,itemsLast:e.destination.itemsLast,itemsSelected:e.destination.itemsSelected});var s=this.destFormName;BX.bind(BX("feed-add-post-destination-container"),"click",function(e){BX.SocNetLogDestination.openDialog(s);BX.PreventDefault(e)});BX.bind(BX("feed-add-post-destination-input"),"keyup",BX.proxy(this.onKeyUpDestination,this));BX.bind(BX("feed-add-post-destination-input"),"keydown",BX.proxy(this.onKeyDownDestination,this))},this),onPopupClose:BX.delegate(function(){if(BX.SocNetLogDestination&&BX.SocNetLogDestination.isOpenDialog()){BX.SocNetLogDestination.closeDialog()}BX.removeCustomEvent("onChangeRightOfSharing",BX.proxy(this.onChangeRightOfSharing,this));BX.proxy_context.destroy()},this)},content:[BX.create("div",{props:{className:"bx-disk-popup-content"},children:[BX.create("table",{props:{className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_OWNER")+"</td>"+"</tr>"}),BX.create("tr",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-col1" style="border-bottom: none;"><a class="bx-disk-filepage-used-people-link" href="'+i.link+'"><span class="bx-disk-filepage-used-people-avatar" style="background-image: url('+i.avatar+');"></span>'+BX.util.htmlspecialchars(i.name)+"</a></td>"+"</tr>"})]}),BX.create("table",{props:{id:"bx-disk-popup-shared-people-list",className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS_USER")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col2">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col3"></td>'+"</tr>"})]}),BX.create("div",{props:{id:"feed-add-post-destination-container",className:"feed-add-post-destination-wrap"},children:[BX.create("span",{props:{className:"feed-add-post-destination-item"}}),BX.create("span",{props:{id:"feed-add-post-destination-input-box",className:"feed-add-destination-input-box"},style:{background:"transparent"},children:[BX.create("input",{props:{type:"text",value:"",id:"feed-add-post-destination-input",className:"feed-add-destination-inp"}})]}),BX.create("a",{props:{href:"#",id:"bx-destination-tag",className:"feed-add-destination-link"
},style:{background:"transparent"},text:BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_ADD_RIGHTS_USER"),events:{click:BX.delegate(function(){},this)}})]})]})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_BTN_SAVE"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","changeSharingAndRights"),data:{objectId:t,entityToNewShared:c},onsuccess:BX.delegate(function(e){if(!e){return}BX.Disk.showModalWithStatusAction(e);var i=BX.delegate(s,this)(t);if(i){if(!c||BX.Disk.isEmptyObject(c)){BX.removeClass(i,"icon-shared icon-shared_2 shared");BX.removeClass(i,"icon-shared_1")}else{BX.addClass(i,"icon-shared icon-shared_2 shared")}}},this)});BX.PopupWindowManager.getCurrentPopup().close()},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_LIST_BTN_CLOSE"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-transparent"},events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})},this)})};function h(e){e=e||{};return(e.provider?e.provider+": ":"")+e.name}e.prototype.showRights=function(e){e=e||{};var t=e.object.id;var s={};BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showRightsDetail"),{id:"folder_list_sharing_detail_object_"+t,responseType:"json",postData:{objectId:t},afterSuccessLoad:BX.delegate(function(e){if(e.status!="success"){e.errors=e.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:e.errors.pop().message})}for(var t in e.rights){if(!e.rights.hasOwnProperty(t)){continue}var i=e.rights[t];for(var a in i){if(!i.hasOwnProperty(a)){continue}s[t]={readOnly:true,item:{id:t,name:h(e.accessCodeNames[t]),avatar:null},type:"group",right:{title:i[a].TASK.TITLE}}}}BX.Disk.modalWindow({modalId:"bx-disk-detail-sharing-folder-change-right",title:BX.message("DISK_FOLDER_LIST_SHARING_TITLE_MODAL_2"),contentClassName:"",contentStyle:{},events:{onAfterPopupShow:BX.delegate(function(){for(var e in s){if(!s.hasOwnProperty(e)){continue}BX.Disk.appendRight(s[e])}},this),onPopupClose:BX.delegate(function(){BX.proxy_context.destroy()},this)},content:[BX.create("div",{props:{className:"bx-disk-popup-content"},children:[BX.create("table",{props:{id:"bx-disk-popup-shared-people-list",className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS_USER")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col2">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col3"></td>'+"</tr>"})]}),BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CREATE_FOLDER"),props:{id:"bx-disk-destination-object-modal",className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-transparent border"},events:{click:BX.delegate(function(){},this)},children:[BX.create("span",{props:{className:"bx-disk-btn-icon bx-disk-btn-icon-plus"}}),BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_ADD_RIGHTS_USER")]}),BX.create("div",{html:'<span class="feed-add-destination-input-box" id="feed-add-post-destination-input-box">'+'<input autocomplete="nope" type="text" value="" class="feed-add-destination-inp" id="feed-add-post-destination-input"/>'+"</span>"})]})],buttons:[]})},this)})};e.prototype.showRightsOnStorage=function(){o={};var e=this.storage.id;var t={};BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showRightsOnStorageDetail"),{id:"folder_list_rights_detail_storage_"+e,responseType:"json",postData:{storageId:e},afterSuccessLoad:BX.delegate(function(s,i){i&&i.close();if(s.status!="success"){s.errors=s.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:s.errors.pop().message})}if(BX.Disk.isEmptyObject(l)){l=BX.clone(s.tasks,true);BX.Disk.setModuleTasks(l)}for(var a in s.rights){if(!s.rights.hasOwnProperty(a)){continue}var r=s.rights[a];for(var d in r){if(!r.hasOwnProperty(d)){continue}t[a]={readOnly:!!r[d].READ_ONLY,item:{id:a,name:h(s.accessCodeNames[a]),avatar:null},type:"group",right:{title:r[d].TASK.TITLE,id:r[d].TASK.ID}}}}var c=!!s.showExtendedRights;var p=BX.Disk.modalWindow({modalId:"bx-disk-detail-sharing-folder-change-right",title:BX.message("DISK_FOLDER_LIST_RIGHTS_TITLE_MODAL"),withoutWindowManager:true,contentClassName:"",contentStyle:{},events:{onAfterPopupShow:BX.delegate(function(){o=BX.clone(t,true);n=false;BX.Access.Init({groups:{disabled:this.isBitrix24}});var e={};for(var s in o){if(!o.hasOwnProperty(s))continue;o[s].isBitrix24=this.isBitrix24;BX.Disk.appendSystemRight(o[s])}BX.addCustomEvent("onChangeSystemRight",BX.proxy(this.onChangeSystemRight,this));BX.addCustomEvent("onDetachSystemRight",BX.proxy(this.onDetachSystemRight,this));BX.bind(BX("feed-add-post-destination-container"),"click",BX.delegate(function(e){var t={};for(var s in o){if(!o.hasOwnProperty(s))continue;t[s]=true}BX.Access.SetSelected(t);BX.Access.ShowForm({showSelected:true,callback:BX.delegate(function(e){var t=[];for(var s in e){for(var i in e[s]){t.push(e[s][i]);this.onSelectSystemRight(e[s][i],s)}}},this)});return BX.PreventDefault(e)},this))},this),onPopupClose:BX.delegate(function(){BX.removeCustomEvent("onChangeSystemRight",BX.proxy(this.onChangeRight,this))},this)},content:[BX.create("div",{props:{className:"bx-disk-popup-content"},children:[BX.create("table",{props:{id:"bx-disk-popup-shared-people-list",className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS_USER")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col2">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col3"></td>'+"</tr>"})]}),BX.create("div",{props:{id:"feed-add-post-destination-container",className:"feed-add-post-destination-wrap"},children:[BX.create("span",{props:{className:"feed-add-post-destination-item"}}),BX.create("span",{props:{id:"feed-add-post-destination-input-box",className:"feed-add-destination-input-box"},style:{background:"transparent"},children:[BX.create("input",{props:{type:"text",value:"",id:"feed-add-post-destination-input",className:"feed-add-destination-inp"}})]}),BX.create("a",{props:{href:"#",id:"bx-destination-tag",className:"feed-add-destination-link"},style:{background:"transparent"},text:BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_ADD_RIGHTS_USER"),events:{click:BX.delegate(function(){},this)}})]}),BX.create("div",{style:{marginTop:"27px",marginBottom:"20px"},html:'<input type="checkbox" '+(c?'checked="checked"':"")+' id="showExtendedRights"/><label for="showExtendedRights">'+BX.message("DISK_FOLDER_LIST_LABEL_SHOW_EXTENDED_RIGHTS")+"</label>"})]})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_BTN_SAVE"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","saveRightsOnStorage"),data:{isChangedRights:n?1:0,showExtendedRights:BX("showExtendedRights").checked?1:0,storageId:e,storageNewRights:o},onsuccess:BX.delegate(function(e){if(!e){return}BX.Disk.showModalWithStatusAction(e);document.location.reload()},this)});if(!!p){p.close()}},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_LIST_BTN_CLOSE"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-transparent"},events:{click:function(){if(!!p){p.close()}}}})]})},this)})};e.prototype.showRightsOnObjectDetail=function(e){o={};var t=this.storage.id;var s={};e=e||{};var i=e.object.id;BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showRightsOnObjectDetail"),{id:"folder_list_rights_detail_object_"+i,responseType:"json",postData:{objectId:i,storageId:t},afterSuccessLoad:BX.delegate(function(e,t){t&&t.close();if(e.status!="success"){e.errors=e.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:e.errors.pop().message})}if(BX.Disk.isEmptyObject(l)){l=BX.clone(e.tasks,true);BX.Disk.setModuleTasks(l)}for(var a in e.rights){if(!e.rights.hasOwnProperty(a)){continue}var n=e.rights[a];for(var c in n){if(!n.hasOwnProperty(c)){continue}s[a]={item:{id:a,name:h(e.accessCodeNames[a]),avatar:null},type:"group",right:{title:n[c].TASK.TITLE,id:n[c].TASK.ID}}}}var p=BX.Disk.modalWindow({modalId:"bx-disk-detail-sharing-folder-change-right",title:BX.message("DISK_FOLDER_LIST_RIGHTS_TITLE_MODAL"),withoutWindowManager:true,contentClassName:"",contentStyle:{},events:{onAfterPopupShow:BX.delegate(function(){o=BX.clone(s,true);r=BX.clone(s,true);d={};BX.Access.Init({groups:{disabled:this.isBitrix24}});for(var e in o){if(!o.hasOwnProperty(e))continue;o[e].isBitrix24=this.isBitrix24;BX.Disk.appendSystemRight(o[e])}BX.addCustomEvent("onChangeSystemRight",BX.proxy(this.onChangeSystemRight,this));BX.addCustomEvent("onDetachSystemRight",BX.proxy(this.onDetachSystemRight,this));BX.bind(BX("feed-add-post-destination-container"),"click",BX.delegate(function(e){var t={};for(var s in o){if(!o.hasOwnProperty(s))continue;t[s]=true}BX.Access.SetSelected(t);BX.Access.ShowForm({showSelected:true,callback:BX.delegate(function(e){var t=[];for(var s in e){for(var i in e[s]){t.push(e[s][i]);this.onSelectSystemRight(e[s][i],s)}}},this)});return BX.PreventDefault(e)},this))},this),onPopupClose:BX.delegate(function(){BX.removeCustomEvent("onChangeSystemRight",BX.proxy(this.onChangeRight,this))},this)},content:[BX.create("div",{props:{className:"bx-disk-popup-content"},children:[BX.create("table",{props:{id:"bx-disk-popup-shared-people-list",className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS_USER")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col2">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col3"></td>'+"</tr>"})]}),BX.create("div",{props:{id:"feed-add-post-destination-container",className:"feed-add-post-destination-wrap"},children:[BX.create("span",{props:{className:"feed-add-post-destination-item"}}),BX.create("span",{props:{id:"feed-add-post-destination-input-box",className:"feed-add-destination-input-box"},style:{background:"transparent"},children:[BX.create("input",{props:{type:"text",value:"",id:"feed-add-post-destination-input",className:"feed-add-destination-inp"}})]}),BX.create("a",{props:{href:"#",id:"bx-destination-tag",className:"feed-add-destination-link"},style:{background:"transparent"},text:BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_ADD_RIGHTS_USER"),events:{click:BX.delegate(function(){},this)}})]})]})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_BTN_SAVE"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","saveRightsOnObject"),data:{objectId:i,objectNewRights:o,detachedRights:d},onsuccess:BX.delegate(function(e){if(!e){return}BX.Disk.showModalWithStatusAction(e)},this)});if(!!p){p.close()}},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_LIST_BTN_CLOSE"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-transparent"},events:{click:function(){if(!!p){p.close()}}}})]})},this)})};e.prototype.showSettingsOnBizproc=function(){var e=this.storage.id;var t="";BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSettingsOnBizproc"),{responseType:"json",postData:{storageId:e},afterSuccessLoad:BX.delegate(function(s){if(s.status!="success"){s.errors=s.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:s.errors.pop().message})}if(s.statusBizProc){t="checked"}BX.Disk.modalWindow({modalId:"bx-disk-settings-bizproc",title:BX.message("DISK_FOLDER_LIST_BIZPROC_TITLE_MODAL"),contentClassName:"",events:{},content:[BX.create("table",{html:'<tr><td><label for="activationBizProc">'+BX.message("DISK_FOLDER_LIST_BIZPROC_LABEL")+"</label></td>"+'<td><input type="checkbox" id="activationBizProc" '+t+" /></td>"+"</tr>"})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_BTN_SAVE"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","saveSettingsOnBizproc"),data:{storageId:e,activationBizproc:BX("activationBizProc").checked?1:0},onsuccess:BX.delegate(function(e){if(!e){return}if(e.status!="success"){e.errors=e.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:e.errors.pop().message})}else{BX.Disk.showModalWithStatusAction(e)}location.reload()},this)})},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_LIST_BTN_CLOSE"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-transparent"},events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})},this)})};e.prototype.openWindowForSelectDocumentService=function(e){var t=new BX.CViewer({});t.openWindowForSelectDocumentService({viewInUf:false})};e.prototype.showHiddenContent=function(e){e.style.display=e.style.display=="none"?"block":"none"};e.prototype.hide=function(e){if(!e.getAttribute("displayOld")){e.setAttribute("displayOld",e.style.display)}e.style.display="none"};e.prototype.showNetworkDriveConnect=function(e){e=e||{};var t=e.link,s=this.showHiddenContent,i=this.hide;s(BX("bx-disk-network-drive-full"));BX.Disk.modalWindow({modalId:"bx-disk-show-network-drive-connect",title:BX.message("DISK_FOLDER_LIST_PAGE_TITLE_NETWORK_DRIVE"),contentClassName:"tac",contentStyle:{},events:{onAfterPopupShow:function(){var e=BX("disk-get-network-drive-link");BX.focus(e);e.setSelectionRange(0,e.value.length)},onPopupClose:function(){i(BX("bx-disk-network-drive"));i(BX("bx-disk-network-drive-full"));document.body.appendChild(BX("bx-disk-network-drive-full"));this.destroy()}},content:[BX.create("label",{text:BX.message("DISK_FOLDER_LIST_PAGE_TITLE_NETWORK_DRIVE_DESCR_MODAL")+" :",props:{className:"bx-disk-popup-label","for":"disk-get-network-drive-link"}}),BX.create("input",{style:{marginTop:"10px"},props:{id:"disk-get-network-drive-link",className:"bx-disk-popup-input",type:"text",value:t}}),BX("bx-disk-network-drive-full")],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CLOSE"),events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]});if(BX("bx-disk-network-drive-secure-label")){i(BX.findChildByClassName(BX("bx-disk-show-network-drive-connect"),"bx-disk-popup-label"));i(BX.findChildByClassName(BX("bx-disk-show-network-drive-connect"),"bx-disk-popup-input"))}};e.prototype.showSharingDetailWithSharing=function(e){c={};p={};e=e||{};var t=e.object.id;BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSharingDetailAppendSharing"),{id:"folder_list_sharing_detail_object_"+t,responseType:"json",postData:{objectId:t},afterSuccessLoad:BX.delegate(function(e){if(e.status!="success"){e.errors=e.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:e.errors.pop().message})}var i={name:e.owner.name,avatar:e.owner.avatar,link:e.owner.link};u=e.owner.maxTaskName;BX.Disk.modalWindow({modalId:"bx-disk-detail-sharing-folder-change-right",title:BX.message("DISK_FOLDER_LIST_SHARING_TITLE_MODAL_2"),contentClassName:"",contentStyle:{},events:{onAfterPopupShow:BX.delegate(function(){BX.addCustomEvent("onChangeRightOfSharing",BX.proxy(this.onChangeRightOfSharing,this));for(var t in e.members){if(!e.members.hasOwnProperty(t)){continue}c[e.members[t].entityId]={item:{id:e.members[t].entityId,name:e.members[t].name,avatar:e.members[t].avatar},type:e.members[t].type,right:e.members[t].right}}p=BX.clone(c,true);BX.SocNetLogDestination.init({name:this.destFormName,searchInput:BX("feed-add-post-destination-input"),bindMainPopup:{node:BX("feed-add-post-destination-container"),offsetTop:"5px",offsetLeft:"15px"},bindSearchPopup:{node:BX("feed-add-post-destination-container"),offsetTop:"5px",offsetLeft:"15px"},callback:{select:BX.proxy(this.onSelectDestination,this),unSelect:BX.proxy(this.onUnSelectDestination,this),openDialog:BX.proxy(this.onOpenDialogDestination,this),closeDialog:BX.proxy(this.onCloseDialogDestination,this),openSearch:BX.proxy(this.onOpenSearchDestination,this),closeSearch:BX.proxy(this.onCloseSearchDestination,this)},items:e.destination.items,itemsLast:e.destination.itemsLast,itemsSelected:e.destination.itemsSelected});var s=this.destFormName;BX.bind(BX("feed-add-post-destination-container"),"click",function(e){BX.SocNetLogDestination.openDialog(s);BX.PreventDefault(e)});BX.bind(BX("feed-add-post-destination-input"),"keyup",BX.proxy(this.onKeyUpDestination,this));BX.bind(BX("feed-add-post-destination-input"),"keydown",BX.proxy(this.onKeyDownDestination,this))},this),onPopupClose:BX.delegate(function(){if(BX.SocNetLogDestination&&BX.SocNetLogDestination.isOpenDialog()){BX.SocNetLogDestination.closeDialog()}BX.removeCustomEvent("onChangeRightOfSharing",BX.proxy(this.onChangeRightOfSharing,this));BX.proxy_context.destroy()},this)},content:[BX.create("div",{props:{className:"bx-disk-popup-content"},children:[BX.create("table",{props:{className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_OWNER")+"</td>"+"</tr>"}),BX.create("tr",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-col1" style="border-bottom: none;"><a class="bx-disk-filepage-used-people-link" href="'+i.link+'"><span class="bx-disk-filepage-used-people-avatar" style="background-image: url('+i.avatar+');"></span>'+BX.util.htmlspecialchars(i.name)+"</a></td>"+"</tr>"})]}),BX.create("table",{props:{id:"bx-disk-popup-shared-people-list",className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS_USER")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col2">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col3"></td>'+"</tr>"})]}),BX.create("div",{props:{id:"feed-add-post-destination-container",className:"feed-add-post-destination-wrap"},children:[BX.create("span",{props:{className:"feed-add-post-destination-item"}}),BX.create("span",{props:{id:"feed-add-post-destination-input-box",className:"feed-add-destination-input-box"},style:{background:"transparent"},children:[BX.create("input",{props:{type:"text",value:"",id:"feed-add-post-destination-input",className:"feed-add-destination-inp"}})]}),BX.create("a",{props:{href:"#",id:"bx-destination-tag",className:"feed-add-destination-link"},style:{background:"transparent"},text:BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_ADD_RIGHTS_USER"),events:{click:BX.delegate(function(){},this)}})]})]})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_BTN_SAVE"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","appendSharing"),data:{objectId:t,entityToNewShared:c},onsuccess:BX.delegate(function(e){if(!e){return}BX.Disk.showModalWithStatusAction(e);var i=BX.delegate(s,this)(t);if(i){if(!c||BX.Disk.isEmptyObject(c)){BX.removeClass(i,"icon-shared icon-shared_2 shared");BX.removeClass(i,"icon-shared_1")}else{BX.addClass(i,"icon-shared icon-shared_2 shared")}}},this)});BX.PopupWindowManager.getCurrentPopup().close()},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_LIST_BTN_CLOSE"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-transparent"},events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})},this)})};e.prototype.onCreateExtendedFolder=function(){this.showCreateFolderWithSharing({})};e.prototype.showCreateFolderWithSharing=function(){c={};o={};var e=this.storage.id;var t={};BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","showCreateFolderWithSharingInCommon"),{id:"folder_list_rights_detail_storage_"+e,responseType:"json",postData:{storageId:e},afterSuccessLoad:BX.delegate(function(s){if(s.status!="success"){s.errors=s.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:s.errors.pop().message})}if(BX.Disk.isEmptyObject(l)){l=BX.clone(s.tasks,true);BX.Disk.setModuleTasks(l)}for(var i in s.rights){if(!s.rights.hasOwnProperty(i)){continue}var a=s.rights[i];for(var n in a){if(!a.hasOwnProperty(n)){continue}t[i]={detachOnly:true,item:{id:i,name:s.accessCodeNames[i].name,avatar:null},type:"group",right:{title:a[n].TASK.TITLE,id:a[n].TASK.ID}}}}BX.Disk.modalWindow({modalId:"bx-disk-detail-sharing-create-folder",title:BX.message("DISK_FOLDER_LIST_CREATE_FOLDER_MODAL"),contentClassName:"",contentStyle:{},events:{onAfterPopupShow:BX.delegate(function(){BX.focus(BX("disk-new-create-filename"));o=BX.clone(t,true);for(var e in t){if(!t.hasOwnProperty(e)){continue}BX.Disk.appendRight(t[e])}BX.addCustomEvent("onChangeRightOfSharing",BX.proxy(this.onChangeRightOfSharing,this));BX.addCustomEvent("onChangeRight",BX.proxy(this.onChangeRight,this));BX.addCustomEvent("onDetachRight",BX.proxy(this.onDetachRight,this));BX.SocNetLogDestination.init({name:this.destFormName,searchInput:BX("feed-add-post-destination-input"),bindMainPopup:{node:BX("feed-add-post-destination-container"),offsetTop:"5px",offsetLeft:"15px"},bindSearchPopup:{node:BX("feed-add-post-destination-container"),offsetTop:"5px",offsetLeft:"15px"},callback:{select:BX.proxy(this.onSelectDestination,this),unSelect:BX.proxy(this.onUnSelectDestination,this),openDialog:BX.proxy(this.onOpenDialogDestination,this),closeDialog:BX.proxy(this.onCloseDialogDestination,this),openSearch:BX.proxy(this.onOpenSearchDestination,this),closeSearch:BX.proxy(this.onCloseSearchDestination,this)},items:s.destination.items,itemsLast:s.destination.itemsLast,itemsSelected:s.destination.itemsSelected});var i=this.destFormName;BX.bind(BX("feed-add-post-destination-container"),"click",function(e){BX.SocNetLogDestination.openDialog(i);BX.PreventDefault(e)});BX.bind(BX("feed-add-post-destination-input"),"keyup",BX.proxy(this.onKeyUpDestination,this));BX.bind(BX("feed-add-post-destination-input"),"keydown",BX.proxy(this.onKeyDownDestination,this))},this),onPopupClose:BX.delegate(function(){if(BX.SocNetLogDestination&&BX.SocNetLogDestination.isOpenDialog()){BX.SocNetLogDestination.closeDialog()}BX.removeCustomEvent("onChangeRight",BX.proxy(this.onChangeRight,this));BX.proxy_context.destroy()},this)},content:[BX.create("div",{props:{className:"bx-disk-popup-content-small"},children:[BX.create("label",{props:{className:"bx-disk-popup-label","for":"disk-new-create-filename"},children:[BX.create("span",{props:{className:"req"},text:"*"}),BX.message("DISK_FOLDER_LIST_LABEL_NAME_CREATE_FOLDER")]}),BX.create("input",{props:{id:"disk-new-create-filename",className:"bx-disk-popup-input",type:"text",value:""},style:{fontSize:"16px",marginTop:"10px"}})]}),BX.create("div",{props:{className:"bx-disk-popup-content"},children:[BX.create("table",{props:{id:"bx-disk-popup-shared-people-list",className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS_USER")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col2">'+BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_RIGHTS")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col3"></td>'+"</tr>"})]}),BX.create("div",{props:{id:"feed-add-post-destination-container",className:"feed-add-post-destination-wrap"},children:[BX.create("span",{props:{className:"feed-add-post-destination-item"}}),BX.create("span",{props:{id:"feed-add-post-destination-input-box",className:"feed-add-destination-input-box"},style:{background:"transparent"},children:[BX.create("input",{props:{type:"text",value:"",id:"feed-add-post-destination-input",className:"feed-add-destination-inp"}})]}),BX.create("a",{props:{href:"#",id:"bx-destination-tag",className:"feed-add-destination-link"},style:{background:"transparent"},text:BX.message("DISK_FOLDER_LIST_SHARING_LABEL_NAME_ADD_RIGHTS_USER"),events:{click:BX.delegate(function(){},this)}})]})]})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_LIST_BTN_SAVE"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){var t=BX("disk-new-create-filename").value;if(!t){BX.focus(BX("disk-new-create-filename"));return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","createFolderWithSharing"),data:{name:t,storageId:e,storageNewRights:o||{},entityToNewShared:c||{}},onsuccess:BX.delegate(function(e){if(!e){return}BX.Disk.showModalWithStatusAction(e);if(e.status&&e.status=="success"){window.document.location=BX.Disk.getUrlToShowObjectInGrid(e.folder.id)}},this)});BX.PopupWindowManager.getCurrentPopup().close()},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_LIST_BTN_CLOSE"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-transparent"},events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})},this)})};e.prototype.onSelectSystemRight=function(e,t){o[e.id]=o[e.id]||{};n=true;var s=BX.Access.GetProviderPrefix(t,e.id);o[e.id]={item:{avatar:null,id:e.id,name:(s?s+": ":"")+e.name},type:"user",right:"read"};o[e.id].isBitrix24=this.isBitrix24;BX.Disk.appendSystemRight(o[e.id])};e.prototype.onSelectRightDestination=function(e,t,s){o[e.id]=o[e.id]||{};o[e.id]={item:e,type:t,right:o[e.id].right||{}};BX.Disk.appendRight({destFormName:this.destFormName,item:e,type:t,right:o[e.id].right})};e.prototype.onUnSelectRightDestination=function(e,t,s){var i=e.id;delete o[i];var a=BX.findChild(BX("bx-disk-popup-shared-people-list"),{attribute:{"data-dest-id":""+i+""}},true);if(a){BX.remove(a)}};e.prototype.onChangeSystemRight=function(e,t){if(o[e]){n=true;o[e].right={id:t.ID,title:t.TITLE}}};e.prototype.onDetachSystemRight=function(e){if(o[e]){n=true;BX.Access.DeleteSelected(e);d[e]=o[e];delete o[e]}};e.prototype.onChangeRight=function(e,t){if(o[e]){o[e].right={id:t.ID,title:t.TITLE}}};e.prototype.onDetachRight=function(e){if(o[e]){delete o[e]}};e.prototype.onSelectDestination=function(e,t,s){c[e.id]=c[e.id]||{};BX.Disk.appendNewShared({maxTaskName:u,readOnly:!!p[e.id],destFormName:this.destFormName,item:e,type:t,right:c[e.id].right});c[e.id]={item:e,type:t,right:c[e.id].right||"disk_access_read"}};e.prototype.onUnSelectDestination=function(e,t,s){var i=e.id;if(!!p[i]){return false}delete c[i];var a=BX.findChild(BX("bx-disk-popup-shared-people-list"),{attribute:{"data-dest-id":""+i+""}},true);if(a){BX.remove(a)}};e.prototype.onChangeRightOfSharing=function(e,t){if(c[e]){c[e].right=t}};e.prototype.onOpenDialogDestination=function(){BX.style(BX("feed-add-post-destination-input-box"),"display","inline-block");BX.style(BX("bx-destination-tag"),"display","none");BX.focus(BX("feed-add-post-destination-input"));if(BX.SocNetLogDestination.popupWindow)BX.SocNetLogDestination.popupWindow.adjustPosition({forceTop:true})};e.prototype.onCloseDialogDestination=function(){var e=BX("feed-add-post-destination-input");if(!BX.SocNetLogDestination.isOpenSearch()&&e&&e.value.length<=0){BX.style(BX("feed-add-post-destination-input-box"),"display","none");BX.style(BX("bx-destination-tag"),"display","inline-block")}};e.prototype.onOpenSearchDestination=function(){if(BX.SocNetLogDestination.popupSearchWindow)BX.SocNetLogDestination.popupSearchWindow.adjustPosition({forceTop:true})};e.prototype.onCloseSearchDestination=function(){var e=BX("feed-add-post-destination-input");if(!BX.SocNetLogDestination.isOpenSearch()&&e&&e.value.length>0){BX.style(BX("feed-add-post-destination-input-box"),"display","none");BX.style(BX("bx-destination-tag"),"display","inline-block");BX("feed-add-post-destination-input").value=""}};e.prototype.onKeyDownDestination=function(e){var t=this.destFormName;if(e.keyCode==8&&BX("feed-add-post-destination-input").value.length<=0){BX.SocNetLogDestination.sendEvent=false;BX.SocNetLogDestination.deleteLastItem(t)}return true};e.prototype.onKeyUpDestination=function(e){var t=this.destFormName;if(e.keyCode==16||e.keyCode==17||e.keyCode==18||e.keyCode==20||e.keyCode==244||e.keyCode==224||e.keyCode==91)return false;if(e.keyCode==13){BX.SocNetLogDestination.selectFirstSearchItem(t);return BX.PreventDefault(e)}if(e.keyCode==27){BX("feed-add-post-destination-input").value=""}else{BX.SocNetLogDestination.search(BX("feed-add-post-destination-input").value,true,t)}if(BX.SocNetLogDestination.sendEvent&&BX.SocNetLogDestination.isOpenDialog())BX.SocNetLogDestination.closeDialog();if(e.keyCode==8){BX.SocNetLogDestination.sendEvent=true}return BX.PreventDefault(e)};return e}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:90:"/bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.min.js?15113164843353";s:6:"source";s:71:"/bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.js";s:3:"min";s:75:"/bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.min.js";s:3:"map";s:75:"/bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.map.js";}"*/
BX.namespace("BX.Disk");BX.Disk.BreadcrumbsClass=function(){var t=function(t){this.containerId=t.containerId;this.collapsedCrumbs=t.collapsedCrumbs||[];this.showOnlyDeleted=t.showOnlyDeleted||0;this.container=BX(this.containerId);this.ajaxUrl="/bitrix/components/bitrix/disk.breadcrumbs/ajax.php";this.container.style.opacity=1;this.setEvents()};t.prototype.setEvents=function(){BX.bindDelegate(this.container,"click",{className:"icon-arrow"},BX.proxy(this.onClickArrow,this));BX.bind(BX("root_dots_"+this.containerId),"click",BX.proxy(this.onClickDots,this))};t.prototype.adjust=function(){var t=BX.findParent(this.container,{className:"bx-disk-interface-toolbar-container"},BX("workarea-content"));if(t){var e=BX.findChild(t,{className:"bx-disk-interface-sort"},true)}var i=this.container.offsetWidth;var a=t?t.offsetWidth:0;var r=e?e.offsetWidth:0;if(!a){return}var n=r+i;if(a>n){return}var o=BX.findChildren(this.container,{tagName:"span",className:"bx-disk-interface-bread-crumbs-item"},true);var s=o.shift();var d=o.pop();this.collapsedCrumbs=[];for(var c in o){if(r+this.container.offsetWidth-a<=0){break}if(!o.hasOwnProperty(c)){continue}var u=o[c];var l=BX.nextSibling(u);var h=0;if(BX.hasClass(l,"bx-disk-bread-crumbs-separator")){h=l.offsetWidth}else{l=null}this.collapsedCrumbs.push({text:u.getAttribute("data-objectName"),title:u.getAttribute("data-objectName"),href:u.getAttribute("data-objectParentPath")});BX.hide(u);l&&BX.hide(l)}if(r+this.container.offsetWidth-a>0){this.collapsedCrumbs.unshift({text:s.getAttribute("data-objectName"),title:s.getAttribute("data-objectName"),href:s.getAttribute("data-objectParentPath")});BX.hide(s)}BX("root_dots_"+this.containerId).style.display="inline-block";BX("root_arrow_"+this.containerId).style.display="none";BX.bind(BX("root_dots_"+this.containerId),"click",BX.proxy(this.onClickDots,this))};t.prototype.expand=function(t,e,i){var a=t.getAttribute("data-objectId");var r=t.getAttribute("data-objectParentPath");if(r=="/"){r=""}else if(r.lastIndexOf("/")==r.length-1){r=r.substr(0,r.length-1)}var n=[];for(var o in i){if(!i.hasOwnProperty(o)){continue}var s=i[o];n.push({text:s["name"],title:s["name"],href:r+"/"+encodeURIComponent(s["name"])+"/"})}BX.PopupMenu.show("disk_breadcrumbs_"+a,e,n,{autoHide:true,angle:{offset:0},events:{onPopupClose:function(){}}})};t.prototype.onClickDots=function(t){var e=t.srcElement||t.target;BX.PopupMenu.show("disk_breadcrumbs_dots",e,this.collapsedCrumbs,{autoHide:true,angle:{offset:0},events:{onPopupClose:function(){}}});BX.PreventDefault(t)};t.prototype.onClickArrow=function(t){var e=t.srcElement||t.target;var i=BX.findParent(e,{className:"bx-disk-interface-bread-crumbs-item-container"},this.container);var a=i.getAttribute("data-objectId");var r=i.getAttribute("data-isRoot");if(!a){BX.PreventDefault(t);return}var n=BX.PopupMenu.getMenuById("disk_breadcrumbs_"+a);if(n&&n.popupWindow){if(n.popupWindow.isShown()){BX.PopupMenu.destroy("disk_breadcrumbs_"+a)}else{n.popupWindow.show()}BX.PreventDefault(t);return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSubFolders"),data:{objectId:a,showOnlyDeleted:this.showOnlyDeleted?1:0,isRoot:r?1:0},onsuccess:BX.delegate(function(t){if(!t){return}this.expand(i,e,t.items)},this)});BX.PreventDefault(t)};return t}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:130:"/bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.min.js?151131648433670";s:6:"source";s:110:"/bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.js";s:3:"min";s:114:"/bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.min.js";s:3:"map";s:114:"/bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.map.js";}"*/
function BxDiskInterfaceGrid(e){this.oActions={};this.oColsMeta={};this.oColsNames={};this.oEditData={};this.oSaveData={};this.oOptions={};this.oVisibleCols=null;this.vars={};this.menu=null;this.settingsMenu=[];this.filterMenu=[];this.checkBoxCount=0;this.bColsChanged=false;this.bViewsChanged=false;this.oFilterRows={};this.activeRow=null;var t=this;this.table_id=e;this.tableNode=BX(this.table_id);this.InitTable=function(){var e=document.getElementById(this.table_id);if(!e||e.rows.length<1||e.rows[0].cells.length<1)return;var i;var s=e.rows[0].cells.length;for(i=0;i<s;i++){var a;for(a=0;a<2;a++){var n=e.rows[a].cells[i];n.onmouseover=function(){t.HighlightGutter(this,true)};n.onmouseout=function(){t.HighlightGutter(this,false)};if(a==1){if(n.className&&(n.className=="bx-disk-actions-col"||n.className=="bx-disk-checkbox-col"))continue;if(this.vars.user_authorized){n.onbxdragstart=t.DragStart;n.onbxdragstop=t.DragStop;n.onbxdrag=t.Drag;n.onbxdraghout=function(){t.HighlightGutter(this,false)};jsDD.registerObject(n);n.onbxdestdraghover=t.DragHover;n.onbxdestdraghout=t.DragOut;n.onbxdestdragfinish=t.DragFinish;jsDD.registerDest(n)}}}}var l=e.rows.length;for(i=0;i<l;i++){var r=e.rows[i];if(r.className&&r.className=="bx-disk-grid-footer")continue;r.cells[0].className+=" bx-disk-left";r.cells[r.cells.length-1].className+=" bx-disk-right";if(i>=2){var o=r.cells[0].childNodes[0];if(o&&o.tagName&&o.tagName.toUpperCase()=="INPUT"&&o.type.toUpperCase()=="CHECKBOX"){o.onclick=function(){t.SelectRow(this);t.EnableActions()};BX.bind(r,"click",t.OnClickRow);this.checkBoxCount++}}if(r.oncontextmenu)BX.bind(r,"contextmenu",this.OnRowContext)}if(e.rows.length>2){e.rows[2].className+=" bx-top";var c=e.rows[e.rows.length-1];if(c.className&&c.className=="bx-disk-grid-footer")c=e.rows[e.rows.length-2];c.className+=" bx-disk-bottom"}};this.OnRowContext=function(e){if(!t.menu)return;if(!e)e=window.event;if(!phpVars.opt_context_ctrl&&e.ctrlKey||phpVars.opt_context_ctrl&&!e.ctrlKey)return;var i;if(e.target)i=e.target;else if(e.srcElement)i=e.srcElement;var s=i;while(s&&!(s.tagName&&s.tagName.toUpperCase()=="TD"&&s.oncontextmenu))s=BX.findParent(s,{tag:"td"});var a=null;if(s&&s.oncontextmenu){a=s.oncontextmenu();a[a.length]={SEPARATOR:true}}s=i;while(s&&!(s.tagName&&s.tagName.toUpperCase()=="TR"&&s.oncontextmenu))s=BX.findParent(s,{tag:"tr"});if(s.tagName.toUpperCase()=="TR"){t.showNewPopupMenu(e,BX.util.array_merge(a,s.oncontextmenu()));e.returnValue=false;if(e.preventDefault)e.preventDefault();return}var n=t.menu;n.PopupHide();t.activeRow=s;if(t.activeRow)t.activeRow.className+=" bx-active";n.OnClose=function(){if(t.activeRow){t.activeRow.className=t.activeRow.className.replace(/\s*bx-active/i,"");t.activeRow=null}t.SaveColumns()};var l=BX.util.array_merge(a,s.oncontextmenu());if(l.length==0)return;n.SetItems(l);n.BuildItems();var r=BX.GetWindowScrollPos();var o=e.clientX+r.scrollLeft;var c=e.clientY+r.scrollTop;var h={};h["left"]=h["right"]=o;h["top"]=h["bottom"]=c;n.PopupShow(h);e.returnValue=false;if(e.preventDefault)e.preventDefault()};this.showNewPopupMenu=function(e,t){var i=[];for(var s in t){if(!t.hasOwnProperty(s)){continue}if(t[s].hasOwnProperty("SHOW")&&t[s]["SHOW"]==false){continue}if(BX.type.isArray(t[s]["MENU"])){i.push({onclick:function(e,t){var i=t.submenu;var s=[];for(var t in i){if(!i.hasOwnProperty(t)){continue}s.push({onclick:i[t]["ONCLICK"],text:i[t]["TEXT"]})}BX.PopupMenu.show("action_bizproc",e,s,{autoHide:true,closeByEsc:true,events:{onPopupClose:function(){BX.PopupMenu.destroy("action_bizproc")}}})},submenu:t[s]["MENU"],text:t[s]["TEXT"]})}else{i.push({onclick:t[s]["ONCLICK"],text:t[s]["TEXT"]})}}BX.PopupMenu.show("grid_action_pm",e,i,{autoHide:true,closeByEsc:true,events:{onAfterPopupShow:function(e){BX.bindDelegate(BX("popup-window-content-menu-popup-grid_action_pm"),"click",{className:"menu-popup-item"},function(t){e.close()})},onPopupClose:function(){BX.PopupMenu.destroy("grid_action_pm")}}})};this.ShowActionMenu=function(e,i){t.menu.PopupHide();t.activeRow=BX.findParent(e,{tag:"tr"});if(t.activeRow)t.activeRow.className+=" bx-active";this.showNewPopupMenu(e,t.oActions[i]);return};this.HighlightGutter=function(e,t){var i=e.parentNode.parentNode.parentNode;var s=i.rows[0].cells[e.cellIndex];var a=s.className.indexOf("bx-disk-sorted")!=-1;if(t){if(a){s.className+=" bx-over-sorted";e.className+=" bx-over-sorted"}else{s.className+=" bx-over";e.className+=" bx-over"}}else{if(a){s.className=s.className.replace(/\s*bx-over-sorted/i,"");e.className=e.className.replace(/\s*bx-over-sorted/i,"")}else{s.className=s.className.replace(/\s*bx-over/i,"");e.className=e.className.replace(/\s*bx-over/i,"")}}};this.HighlightRow=function(e,t){if(t)e.className+=" bx-over";else e.className=e.className.replace(/\s*bx-over/i,"")};this.SelectRow=function(e){var t=e.parentNode.parentNode;var i=t.parentNode.parentNode;var s=document.getElementById(i.id+"_selected_span");var a=parseInt(s.innerHTML);if(e.checked){t.className+=" bx-selected selected";a++}else{t.className=t.className.replace(/\s*bx-selected/gi,"");t.className=t.className.replace(/\s*selected/gi,"");a--}s.innerHTML=a.toString();var n=document.getElementById(i.id+"_check_all");if(a==this.checkBoxCount)n.checked=true;else n.checked=false;if(e.checked){BX.onCustomEvent("onSelectRow",[this,a,e])}else{BX.onCustomEvent("onUnSelectRow",[this,a,e])}};this.OnClickRow=function(e){if(!e)e=window.event;var i=e.target?e.target:e.srcElement?e.srcElement:null;if(!i)return;if(!i.parentNode.cells)return;var s=i.parentNode.cells[0].childNodes[0];if(s&&s.tagName&&s.tagName.toUpperCase()=="INPUT"&&s.type.toUpperCase()=="CHECKBOX"&&!s.disabled){s.checked=!s.checked;t.SelectRow(s)}else{var a=BX.findParent(i,{tagName:"tr",className:"bx-disk-table-body"},this.tableNode);if(a){var n=BX.findChild(a,{tagName:"td",className:"bx-disk-checkbox-col"});if(n){s=BX.findChild(n,{tagName:"input",property:{type:"checkbox"}});if(s){s.checked=!s.checked;t.SelectRow(s)}}}}t.EnableActions()};this.SelectAllRows=function(e){var t=document.getElementById(this.table_id);var i=e.checked;var s;var a=t.rows.length;for(s=2;s<a;s++){var n=t.rows[s].cells[0].childNodes[0];if(n&&n.tagName&&n.tagName.toUpperCase()=="INPUT"&&n.type.toUpperCase()=="CHECKBOX"){if(n.checked!=i&&!n.disabled){n.checked=i;this.SelectRow(n)}}}this.EnableActions()};this.EnableActions=function(){var e=document.forms["form_"+this.table_id];if(!e)return;var t=this.IsActionEnabled();var i=this.IsActionEnabled("edit");if(e.apply)e.apply.disabled=!t;var s=document.getElementById("edit_button_"+this.table_id);s=document.getElementById("delete_button_"+this.table_id)};this.IsActionEnabled=function(e){var t=document.forms["form_"+this.table_id];if(!t)return;var i=false;var s=document.getElementById(this.table_id+"_selected_span");if(s&&parseInt(s.innerHTML)>0)i=true;var a=t["action_all_rows_"+this.table_id];if(e=="edit")return!(a&&a.checked)&&i;else return a&&a.checked||i};this.SwitchActionButtons=function(e){var t=document.getElementById("bx_grid_"+this.table_id+"_action_buttons");var i=t;while(i=BX.findNextSibling(i,{tag:"td"}))i.style.display=e?"none":"";t.style.display=e?"":"none";if(e&&window.jsDD){window.jsDD.Disable()}else{window.jsDD.Enable()}};this.getSwitchActionButtonsContainer=function(){return BX("bx_grid_"+this.table_id+"_action_buttons")};this.ActionEdit=function(e){if(this.IsActionEnabled("edit")){var t=document.forms["form_"+this.table_id];if(!t)return;this.SwitchActionButtons(true);var i=t["ID[]"];if(!i.length)i=new Array(i);for(var s=0;s<i.length;s++){var a=i[s];if(a.checked){var n=BX.findParent(a,{tag:"tr"});BX.denyEvent(n,"dblclick");var l=BX.findParent(a,{tag:"td"});l=BX.findNextSibling(l,{tag:"td"});if(l.className=="bx-disk-actions-col")l=BX.findNextSibling(l,{tag:"td"});var r=a.value;this.oSaveData[r]={};for(var o in this.oColsMeta){if(this.oColsMeta[o].editable==true&&this.oEditData[r][o]!==false){this.oSaveData[r][o]=l.innerHTML;l.innerHTML="";var c=this.oEditData[r][o];var h="FIELDS["+r+"]["+o+"]";switch(this.oColsMeta[o].type){case"checkbox":l.appendChild(BX.create("INPUT",{props:{type:"hidden",name:h,value:"N"}}));l.appendChild(BX.create("INPUT",{props:{type:"checkbox",name:h,value:"Y",checked:c=="Y",defaultChecked:c=="Y"}}));break;case"list":var d=[];for(var f in this.oColsMeta[o].items){d[d.length]=BX.create("OPTION",{props:{value:f,selected:f==c},text:this.oColsMeta[o].items[f]})}l.appendChild(BX.create("SELECT",{props:{name:h},children:d}));break;case"date":var u=BX.create("SPAN",{style:{whiteSpace:"nowrap"}});u.appendChild(BX.create("INPUT",{props:{type:"text",name:h,value:c,size:this.oColsMeta[o].size?this.oColsMeta[o].size:10}}));u.appendChild(BX.create("A",{props:{href:"javascript:void(0);",title:this.vars.mess.calend_title},html:'<img src="'+this.vars.calendar_image+'" alt="'+this.vars.mess.calend_title+'" class="calendar-icon" onclick="BX.calendar({node:this, field:\''+h+"', bTime: true, currentTime: '"+this.vars.server_time+'\'});" onmouseover="this.className+=\' calendar-icon-hover\';" onmouseout="this.className = this.className.replace(/s*calendar-icon-hover/ig, \'\');" border="0"/>'}));l.appendChild(u);break;default:var v={className:"bx-disk-folder-title list",type:"text",name:h,value:c,size:this.oColsMeta[o].size?this.oColsMeta[o].size:15};if(this.oColsMeta[o].maxlength)v.maxLength=this.oColsMeta[o].maxlength;l.appendChild(BX.create("INPUT",{props:v}));break}}l=BX.findNextSibling(l,{tag:"td"})}}a.disabled=true}t.elements["action_button_"+this.table_id].value="edit"}};this.ActionCancel=function(){var e=document.forms["form_"+this.table_id];if(!e)return;this.SwitchActionButtons(false);var t=e["ID[]"];if(!t.length)t=new Array(t);for(var i=0;i<t.length;i++){var s=t[i];if(s.checked){var a=BX.findParent(s,{tag:"tr"});BX.allowEvent(a,"dblclick");var n=BX.findParent(s,{tag:"td"});n=BX.findNextSibling(n,{tag:"td"});if(n.className=="bx-disk-actions-col")n=BX.findNextSibling(n,{tag:"td"});var l=s.value;for(var r in this.oColsMeta){if(this.oColsMeta[r].editable==true&&this.oEditData[l][r]!==false)n.innerHTML=this.oSaveData[l][r];n=BX.findNextSibling(n,{tag:"td"})}}s.disabled=false}e.elements["action_button_"+this.table_id].value=""};this.ActionDelete=function(){var e=document.forms["form_"+this.table_id];if(!e)return;e.elements["action_button_"+this.table_id].value="delete";BX.submit(e)};this.SetActionName=function(e){var t=this.GetForm();if(!t)return;t.elements["action_button_"+this.table_id].value=e};this.GetForm=function(){return document.forms["form_"+this.table_id]};this.GetCheckedCheckboxes=function(){var e=[];for(var t=0,i=this.GetForm().elements.length;t<i;t++){var s=this.GetForm().elements[t];if(s.type.toLowerCase()=="checkbox"&&s.checked){e.push(s)}}return e};this.ActionCustom=function(e){this.SetActionName(e);BX.submit(form)};this.DeleteItem=function(e,t){var i=document.getElementById("ID_"+e);if(i){if(confirm(t)){var s=document.forms["form_"+this.table_id];if(!s)return;var a=s["ID[]"];if(!a.length)a=new Array(a);for(var n=0;n<a.length;n++){a[n].checked=false}i.checked=true;this.ActionDelete()}}};this.ForAllClick=function(e){if(e.checked&&!confirm(this.vars.mess.for_all_confirm)){e.checked=false;return}var t=e.form["ID[]"];if(t){if(!t.length)t=new Array(t);for(var i=0;i<t.length;i++)t[i].disabled=e.checked}this.EnableActions()};this.Sort=function(e,t,i,s){if(t==""){var a=null,n=false;if(s.length>0)a=s[0];if(!a)a=window.event;if(a)n=a.ctrlKey;e+=n?i=="acs"?"desc":"asc":i}else if(t=="asc")e+="desc";else e+="asc";this.Reload(e)};this.InitVisCols=function(){if(this.oVisibleCols==null){this.oVisibleCols={};for(var e in this.oColsMeta)this.oVisibleCols[e]=true}};this.CheckColumn=function(e,t){var i=this.menu.GetMenuByItemId(t.id);var s=!(i.GetItemInfo(t).ICON=="checked");i.SetItemIcon(t,s?"checked":"");this.InitVisCols();this.oVisibleCols[e]=s;this.bColsChanged=true};this.HideColumn=function(e){this.InitVisCols();this.oVisibleCols[e]=false;this.bColsChanged=true;this.SaveColumns()};this.ApplySaveColumns=function(){this.menu.PopupHide();this.SaveColumns()};this.SaveColumns=function(e){var i="";if(e){i=e}else{if(!t.bColsChanged)return;for(var s in t.oVisibleCols)if(t.oVisibleCols[s])i+=(i!=""?",":"")+s}BX.ajax.get("/bitrix/components"+t.vars.component_path+"/settings.php?GRID_ID="+t.table_id+"&action=showcolumns&columns="+i+"&sessid="+t.vars.sessid,function(){t.Reload()})};this.Reload=function(e){jsDD.Disable();if(!e){e=this.vars.current_url}if(this.vars.ajax.AJAX_ID!=""){BX.ajax.insertToNode(e+(e.indexOf("?")==-1?"?":"&")+"bxajaxid="+this.vars.ajax.AJAX_ID,"comp_"+this.vars.ajax.AJAX_ID)}else{window.location=e}};this.SetTheme=function(e,i){BX.loadCSS(this.vars.template_path+"/themes/"+i+"/style.css");BX(t.table_id).className="bx-disk-interface-grid bx-disk-interface-grid-theme-"+i;var s=this.menu.GetMenuByItemId(e.id);s.SetAllItemsIcon("");s.SetItemIcon(e,"checked");BX.ajax.get("/bitrix/components"+t.vars.component_path+"/settings.php?GRID_ID="+t.table_id+"&action=settheme&theme="+i+"&sessid="+t.vars.sessid)};this.SetView=function(e){var i=t.oOptions.views[e].saved_filter;var s=i&&t.oOptions.filters[i]?function(){t.ApplyFilter(i)}:function(){t.Reload()};BX.ajax.get("/bitrix/components"+t.vars.component_path+"/settings.php?GRID_ID="+t.table_id+"&action=setview&view_id="+e+"&sessid="+t.vars.sessid,s)};this.EditCurrentView=function(){this.ShowSettings(this.oOptions.views[this.oOptions.current_view],function(){t.SaveSettings(t.oOptions.current_view,true)})};this.AddView=function(){var e="view_"+Math.round(Math.random()*1e6);var i={};for(var s in this.oOptions.views[this.oOptions.current_view])i[s]=this.oOptions.views[this.oOptions.current_view][s];i.name=this.vars.mess.viewsNewView;this.ShowSettings(i,function(){var i=t.SaveSettings(e);t.oOptions.views[e]={name:i.name,columns:i.columns,sort_by:i.sort_by,sort_order:i.sort_order,page_size:i.page_size,saved_filter:i.saved_filter};t.bViewsChanged=true;var s=document["views_"+t.table_id];s.views_list.options[s.views_list.length]=new Option(i.name!=""?i.name:t.vars.mess.viewsNoName,e,true,true)})};this.EditView=function(e){this.ShowSettings(this.oOptions.views[e],function(){var i=t.SaveSettings(e);t.oOptions.views[e]={name:i.name,columns:i.columns,sort_by:i.sort_by,sort_order:i.sort_order,page_size:i.page_size,saved_filter:i.saved_filter};t.bViewsChanged=true;var s=document["views_"+t.table_id];s.views_list.options[s.views_list.selectedIndex].text=i.name!=""?i.name:t.vars.mess.viewsNoName})};this.DeleteView=function(e){if(!confirm(this.vars.mess.viewsDelete))return;var i=document["views_"+this.table_id];var s=i.views_list.selectedIndex;i.views_list.remove(s);i.views_list.selectedIndex=s<i.views_list.length?s:i.views_list.length-1;this.bViewsChanged=true;BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?GRID_ID="+this.table_id+"&action=delview&view_id="+e+"&sessid="+t.vars.sessid)};this.ShowSettings=function(e,t){var i=false;if(!window["settingsDialog"+this.table_id]){window["settingsDialog"+this.table_id]=new BX.CDialog({content:'<form name="settings_'+this.table_id+'"></form>',title:this.vars.mess.settingsTitle,width:this.vars.settingWndSize.width,height:this.vars.settingWndSize.height,resize_id:"InterfaceGridSettingWnd"});i=true}window["settingsDialog"+this.table_id].ClearButtons();window["settingsDialog"+this.table_id].SetButtons([{title:this.vars.mess.settingsSave,action:function(){t();this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]);window["settingsDialog"+this.table_id].Show();var s=document["settings_"+this.table_id];if(i)s.appendChild(BX("view_settings_"+this.table_id));s.view_name.focus();s.view_name.value=e.name;var a=[];if(e.columns!=""){a=e.columns.split(",")}else{for(var n in this.oColsMeta)a[a.length]=n}var l={},r;for(n=0,r=a.length;n<r;n++)l[a[n]]=true;jsSelectUtils.deleteAllOptions(s.view_all_cols);for(n in this.oColsNames)if(!l[n])s.view_all_cols.options[s.view_all_cols.length]=new Option(this.oColsNames[n],n,false,false);jsSelectUtils.deleteAllOptions(s.view_cols);for(n in l)s.view_cols.options[s.view_cols.length]=new Option(this.oColsNames[n],n,false,false);jsSelectUtils.selectOption(s.view_sort_by,e.sort_by);jsSelectUtils.selectOption(s.view_sort_order,e.sort_order);jsSelectUtils.selectOption(s.view_page_size,e.page_size);jsSelectUtils.deleteAllOptions(s.view_filters);s.view_filters.options[0]=new Option(this.vars.mess.viewsFilter,"");for(n in this.oOptions.filters)s.view_filters.options[s.view_filters.length]=new Option(this.oOptions.filters[n].name,n,n==e.saved_filter,n==e.saved_filter);if(s.set_default_settings){s.set_default_settings.checked=false;s.delete_users_settings.disabled=true}};this.SaveSettings=function(e,i){var s=document["settings_"+this.table_id];var a="";var n=s.view_cols.length;for(var l=0;l<n;l++)a+=(a!=""?",":"")+s.view_cols[l].value;var r={GRID_ID:this.table_id,view_id:e,action:"savesettings",sessid:this.vars.sessid,name:s.view_name.value,columns:a,sort_by:s.view_sort_by.value,sort_order:s.view_sort_order.value,page_size:s.view_page_size.value,saved_filter:s.view_filters.value};if(s.set_default_settings){r.set_default_settings=s.set_default_settings.checked?"Y":"N";r.delete_users_settings=s.delete_users_settings.checked?"Y":"N"}var o=null;if(i===true){o=function(){if(r.saved_filter&&t.oOptions.filters[r.saved_filter]){t.ApplyFilter(r.saved_filter)}else{t.Reload()}}}BX.ajax.post("/bitrix/components"+t.vars.component_path+"/settings.php",r,o);return r};this.ReloadViews=function(){if(t.bViewsChanged)t.Reload()};this.ShowViews=function(){this.bViewsChanged=false;var e=false;if(!window["viewsDialog"+this.table_id]){var i=new BX.CWindowButton({title:this.vars.mess.viewsApply,hint:this.vars.mess.viewsApplyTitle,action:function(){var e=document["views_"+t.table_id];if(e.views_list.selectedIndex!=-1)t.SetView(e.views_list.value);window["bxGrid_"+t.table_id].bViewsChanged=false;this.parentWindow.Close()}});window["viewsDialog"+this.table_id]=new BX.CDialog({content:'<form name="views_'+this.table_id+'"></form>',title:this.vars.mess.viewsTitle,buttons:[i,BX.CDialog.prototype.btnClose],width:this.vars.viewsWndSize.width,height:this.vars.viewsWndSize.height,resize_id:"InterfaceGridViewsWnd"});BX.addCustomEvent(window["viewsDialog"+this.table_id],"onWindowUnRegister",this.ReloadViews);e=true}window["viewsDialog"+this.table_id].Show();var s=document["views_"+this.table_id];if(e)s.appendChild(BX("views_list_"+this.table_id))};this.DragStart=function(){var e=document.body.appendChild(document.createElement("DIV"));e.style.position="absolute";e.style.zIndex=10;e.className="bx-drag-object";e.innerHTML=this.innerHTML;e.style.width=this.clientWidth+"px";this.__dragCopyDiv=e;this.className+=" bx-drag-source";var t=document.body.appendChild(document.createElement("DIV"));t.style.position="absolute";t.style.zIndex=20;t.className="bx-drag-arrow";this.__dragArrowDiv=t;return true};this.Drag=function(e,t){var i=this.__dragCopyDiv;i.style.left=e+"px";i.style.top=t+"px";return true};this.DragStop=function(){this.className=this.className.replace(/\s*bx-grid-drag-source/gi,"");this.__dragCopyDiv.parentNode.removeChild(this.__dragCopyDiv);this.__dragCopyDiv=null;this.__dragArrowDiv.parentNode.removeChild(this.__dragArrowDiv);this.__dragArrowDiv=null;return true};this.DragHover=function(e,i,s){if(BX.hasClass(e,"draggable")){return}t.HighlightGutter(this,true);this.className+=" bx-drag-over";var a=e.__dragArrowDiv;var n=BX.pos(this);if(typeof e.cellIndex=="undefined"){return}if(this.cellIndex<=e.cellIndex)a.style.left=n["left"]-6+"px";else a.style.left=n["right"]-6+"px";a.style.top=n["top"]-12+"px";return true};this.DragOut=function(e,i,s){if(BX.hasClass(e,"draggable")){return}if(typeof e.cellIndex=="undefined"){return}t.HighlightGutter(this,false);this.className=this.className.replace(/\s*bx-drag-over/gi,"");var a=e.__dragArrowDiv;a.style.left="-1000px";return true};this.DragFinish=function(e,i,s,a){if(e.tagName.toUpperCase()!="TD")return false;t.HighlightGutter(this,false);this.className=this.className.replace(/\s*bx-drag-over/gi,"");if(this==e)return true;var n=BX(t.table_id);var l=0;for(var r=0;r<2;r++){var o=n.rows[1].cells[r];if(o.className&&(o.className.indexOf("bx-disk-actions-col")!=-1||o.className.indexOf("bx-disk-checkbox-col")!=-1))l++}var c=[];for(var h in t.oColsMeta)c[c.length]=h;var d=e.cellIndex-l;var f=this.cellIndex-l;var u=c[d];if(f<d){for(r=d;r>f;r--)c[r]=c[r-1]}else{for(r=d;r<f;r++)c[r]=c[r+1]}c[f]=u;var v="";for(r=0;r<c.length;r++)v+=(v!=""?",":"")+c[r];t.SaveColumns(v);return true};this.InitFilter=function(){var e=BX("flt_header_"+this.table_id);if(e)BX.bind(e,"contextmenu",this.OnRowContext)};this.SwitchFilterRow=function(e,t){if(t){var i=this.menu.GetMenuByItemId(t.id);i.SetItemIcon(t,this.oFilterRows[e]?"":"checked")}else{var s=this.filterMenu[0].MENU;for(var a=0;a<s.length;a++){if(s[a].ID=="flt_"+this.table_id+"_"+e){s[a].ICONCLASS=this.oFilterRows[e]?"":"checked";break}}}var n=BX("flt_row_"+this.table_id+"_"+e);n.style.display=this.oFilterRows[e]?"none":"";this.oFilterRows[e]=this.oFilterRows[e]?false:true;var l=BX("a_minmax_"+this.table_id);if(l&&l.className.indexOf("bx-filter-max")!=-1)this.SwitchFilter(l);this.SaveFilterRows()};this.SwitchFilterRows=function(e){this.menu.PopupHide();var t=0;for(var i in this.oFilterRows){t++;if(t==1&&e==false)continue;this.oFilterRows[i]=e;var s=BX("flt_row_"+this.table_id+"_"+i);s.style.display=e?"":"none"}var a=this.filterMenu[0].MENU;for(t=0;t<a.length;t++){if(t==0&&e==false)continue;if(a[t].SEPARATOR==true)break;a[t].ICONCLASS=e?"checked":""}var n=BX("a_minmax_"+this.table_id);if(n&&n.className.indexOf("bx-filter-max")!=-1)this.SwitchFilter(n);this.SaveFilterRows()};this.SaveFilterRows=function(){var e="";for(var t in this.oFilterRows)if(this.oFilterRows[t])e+=(e!=""?",":"")+t;BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?GRID_ID="+this.table_id+"&action=filterrows&rows="+e+"&sessid="+this.vars.sessid)};this.SwitchFilter=function(e){var t=e.className.indexOf("bx-filter-min")!=-1;e.className=t?"bx-filter-btn bx-filter-max":"bx-filter-btn bx-filter-min";e.title=t?this.vars.mess.filterShow:this.vars.mess.filterHide;var i=BX("flt_content_"+this.table_id);i.style.display=t?"none":"";BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?GRID_ID="+this.table_id+"&action=filterswitch&show="+(t?"N":"Y")+"&sessid="+this.vars.sessid)};this.ClearFilter=function(e){for(var t=0,i=e.elements.length;t<i;t++){var s=e.elements[t];switch(s.type.toLowerCase()){case"text":case"textarea":s.value="";break;case"select-one":s.selectedIndex=0;break;case"select-multiple":for(var a=0,n=s.options.length;a<n;a++)s.options[a].selected=false;break;case"checkbox":s.checked=false;break;default:break}if(s.onchange)s.onchange()}BX.onCustomEvent(e,"onGridClearFilter",[]);e.clear_filter.value="Y";BX.submit(e)};this.ShowFilters=function(){var e=false;if(!window["filtersDialog"+this.table_id]){var i=new BX.CWindowButton({title:this.vars.mess.filtersApply,hint:this.vars.mess.filtersApplyTitle,action:function(){var e=document["filters_"+t.table_id];if(e.filters_list.value)t.ApplyFilter(e.filters_list.value);this.parentWindow.Close()}});window["filtersDialog"+this.table_id]=new BX.CDialog({content:'<form name="filters_'+this.table_id+'"></form>',title:this.vars.mess.filtersTitle,buttons:[i,BX.CDialog.prototype.btnClose],width:this.vars.filtersWndSize.width,height:this.vars.filtersWndSize.height,resize_id:"InterfaceGridFiltersWnd"});e=true}window["filtersDialog"+this.table_id].Show();var s=document["filters_"+this.table_id];if(e)s.appendChild(BX("filters_list_"+this.table_id))};this.AddFilter=function(e){if(!e)e={};var i="filter_"+Math.round(Math.random()*1e6);var s={name:this.vars.mess.filtersNew,fields:e};this.ShowFilterSettings(s,function(){var e=t.SaveFilter(i);t.oOptions.filters[i]={name:e.name,fields:e.fields};var s=document["filters_"+t.table_id];s.filters_list.options[s.filters_list.length]=new Option(e.name!=""?e.name:t.vars.mess.viewsNoName,i,true,true);if(t.filterMenu.length==4)t.filterMenu=BX.util.insertIntoArray(t.filterMenu,1,{SEPARATOR:true});var a={ID:"mnu_"+t.table_id+"_"+i,TEXT:BX.util.htmlspecialchars(e.name),TITLE:t.vars.mess.ApplyTitle,ONCLICK:"bxGrid_"+t.table_id+".ApplyFilter('"+i+"')"};t.filterMenu=BX.util.insertIntoArray(t.filterMenu,2,a)})};this.AddFilterAs=function(){var e=document.forms["filter_"+this.table_id];var t=this.GetFilterFields(e);this.ShowFilters();this.AddFilter(t)};this.EditFilter=function(e){this.ShowFilterSettings(this.oOptions.filters[e],function(){var i=t.SaveFilter(e);t.oOptions.filters[e]={name:i.name,fields:i.fields};var s=document["filters_"+t.table_id];s.filters_list.options[s.filters_list.selectedIndex].text=i.name!=""?i.name:t.vars.mess.viewsNoName;for(var a=0,n=t.filterMenu.length;a<n;a++){if(t.filterMenu[a].ID&&t.filterMenu[a].ID=="mnu_"+t.table_id+"_"+e){t.filterMenu[a].TEXT=BX.util.htmlspecialchars(i.name);break}}})};this.DeleteFilter=function(e){if(!confirm(this.vars.mess.filtersDelete))return;var i=document["filters_"+this.table_id];var s=i.filters_list.selectedIndex;i.filters_list.remove(s);i.filters_list.selectedIndex=s<i.filters_list.length?s:i.filters_list.length-1;for(var a=0,n=this.filterMenu.length;a<n;a++){if(t.filterMenu[a].ID&&t.filterMenu[a].ID=="mnu_"+t.table_id+"_"+e){this.filterMenu=BX.util.deleteFromArray(this.filterMenu,a);if(this.filterMenu.length==5)this.filterMenu=BX.util.deleteFromArray(this.filterMenu,1);break}}delete this.oOptions.filters[e];BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?GRID_ID="+this.table_id+"&action=delfilter&filter_id="+e+"&sessid="+t.vars.sessid)};this.ShowFilterSettings=function(e,t){var i=false;if(!window["filterSettingsDialog"+this.table_id]){window["filterSettingsDialog"+this.table_id]=new BX.CDialog({content:'<form name="flt_settings_'+this.table_id+'"></form>',title:this.vars.mess.filterSettingsTitle,width:this.vars.filterSettingWndSize.width,height:this.vars.filterSettingWndSize.height,resize_id:"InterfaceGridFilterSettingWnd"});i=true}window["filterSettingsDialog"+this.table_id].ClearButtons();window["filterSettingsDialog"+this.table_id].SetButtons([{title:this.vars.mess.settingsSave,action:function(){t();this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]);window["filterSettingsDialog"+this.table_id].Show();var s=document["flt_settings_"+this.table_id];if(i)s.appendChild(BX("filter_settings_"+this.table_id));s.filter_name.focus();s.filter_name.value=e.name;this.SetFilterFields(s,e.fields)};this.SetFilterFields=function(e,t){for(var i=0,s=e.elements.length;i<s;i++){var a=e.elements[i];if(a.name=="filter_name")continue;var n=t[a.name]||"";switch(a.type.toLowerCase()){case"select-one":case"text":case"textarea":a.value=n;break;case"radio":case"checkbox":a.checked=a.value==n;break;case"select-multiple":var l=a.name.substr(0,a.name.length-2);var r=false;for(var o=0,c=a.options.length;o<c;o++){var h=t[l]?t[l]["sel"+a.options[o].value]:null;a.options[o].selected=a.options[o].value==h;if(a.options[o].value==h)r=true}if(!r&&a.options.length>0&&a.options[0].value=="")a.options[0].selected=true;break;default:break}if(a.onchange)a.onchange()}};this.GetFilterFields=function(e){var t={};for(var i=0,s=e.elements.length;i<s;i++){var a=e.elements[i];if(a.name=="filter_name")continue;switch(a.type.toLowerCase()){case"select-one":case"text":case"textarea":t[a.name]=a.value;break;case"radio":case"checkbox":if(a.checked)t[a.name]=a.value;break;case"select-multiple":var n=a.name.substr(0,a.name.length-2);t[n]={};for(var l=0,r=a.options.length;l<r;l++)if(a.options[l].selected)t[n]["sel"+a.options[l].value]=a.options[l].value;break;default:break}}return t};this.SaveFilter=function(e){var i=document["flt_settings_"+this.table_id];var s={GRID_ID:this.table_id,filter_id:e,action:"savefilter",sessid:this.vars.sessid,name:i.filter_name.value,fields:this.GetFilterFields(i)};BX.ajax.post("/bitrix/components"+t.vars.component_path+"/settings.php",s);return s};this.ApplyFilter=function(e){var t=document.forms["filter_"+this.table_id];this.SetFilterFields(t,this.oOptions.filters[e].fields);BX.submit(t)};this.OnDateChange=function(e){var t=false,i=false,s=false,a=false,n=false;if(e.value=="interval")n=t=i=s=true;else if(e.value=="before")i=true;else if(e.value=="after"||e.value=="exact")t=true;else if(e.value=="days")a=true;BX.findNextSibling(e,{tag:"span","class":"bx-filter-from"}).style.display=t?"":"none";BX.findNextSibling(e,{tag:"span","class":"bx-filter-to"}).style.display=i?"":"none";BX.findNextSibling(e,{tag:"span","class":"bx-filter-hellip"}).style.display=s?"":"none";BX.findNextSibling(e,{tag:"span","class":"bx-filter-days"}).style.display=a?"":"none";var l=BX.findNextSibling(e,{tag:"span","class":"bx-filter-br"});if(l)l.style.display=n?"":"none"};this.getRowByCheckBox=function(e){return e.parentNode.parentNode};this.removeRow=function(e,t){var i=this.getRow(e);new BX.easing({duration:600,start:{opacity:100,height:i.scrollHeight},finish:{opacity:0,height:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(e){i.style.height=e.height+"px";i.style.opacity=e.opacity/10},complete:BX.delegate(function(){var s=this.getCheckbox(e);if(s.checked){s.checked=false;this.SelectRow(s)}BX.remove(i);t&&t()},this)}).animate();var s=BX("bx-disk-total-grid-item");if(s){BX.adjust(s,{text:""+(parseInt(s.textContent||s.innerText,10)-1)})}};this.getRow=function(e){var t=this.getCheckbox(e);return this.getRowByCheckBox(t)};this.getCheckbox=function(e){return BX("ID_"+e)};this.getDeleteButton=function(){return BX("delete_button_"+this.table_id)}}function BxInterfaceTile(e){BxInterfaceTile.superclass.constructor.apply(this,arguments);this.isTile=true;this.tableNode=BX(this.table_id);this.tileNode=BX.findChild(this.tableNode,{tagName:"div",className:"bx-disk-interface-tile"},false,false);var t=this;this.InitTable=function(){var e=BX.findChildren(this.tileNode,{tagName:"div",className:"bx-disk-file-container"});e=e||[];for(var t=0;t<e.length;t++){var i=e[t];if(i.oncontextmenu){BX.bind(i,"contextmenu",this.OnRowContext)}}};this.SetActionName=function(e){};this.OnRowContext=function(e){if(!t.menu)return;if(!e)e=window.event;if(!phpVars.opt_context_ctrl&&e.ctrlKey||phpVars.opt_context_ctrl&&!e.ctrlKey)return;var i=e.target||e.srcElement;var s=i;if(!BX.hasClass(s,"bx-disk-file-container")){s=BX.findParent(i,{tagName:"div",className:"bx-disk-file-container"},this.tileNode)}var a=t.menu;a.PopupHide();var n=s.oncontextmenu();if(n.length==0)return;t.showNewPopupMenu(e,s.oncontextmenu());e.returnValue=false;if(e.preventDefault)e.preventDefault()};this.clickAndSelectRow=function(e,t){var i=t||window.event;if(i){var s=i.target||i.srcElement;if(s.tagName.toUpperCase()=="A"){return}}var a=this.getCheckbox(e);if(a&&a.tagName&&a.tagName.toUpperCase()=="INPUT"&&a.type.toUpperCase()=="CHECKBOX"&&!a.disabled){a.checked=!a.checked;this.SelectRow(a);this.EnableActions();BX.PreventDefault(i)}};this.SelectRow=function(e){var t=this.getRowByCheckBox(e);var i=document.getElementById(this.table_id+"_selected_span");var s=parseInt(i.innerHTML);if(e.checked){t.className+=" checked";BX.addClass(BX.firstChild(t),"selected");s++}else{t.className=t.className.replace(/\s*checked/gi,"");BX.removeClass(BX.firstChild(t),"selected");s--}i.innerHTML=s.toString();if(e.checked){BX.onCustomEvent("onSelectRow",[this,s,e])}else{BX.onCustomEvent("onUnSelectRow",[this,s,e])}};this.SelectAllRows=function(e){var t=BX.findChildren(this.tableNode,{tagName:"input",attribute:{type:"checkbox"}},true);if(t==null){return}for(var i=0;i<t.length;i++){var s=t[i];if(s.checked!=e&&!s.disabled){s.checked=e;this.SelectRow(s)}}this.EnableActions()};this.getRowByCheckBox=function(e){return e.parentNode.parentNode.parentNode};this.ActionEdit=function(e){if(this.IsActionEnabled("edit")){var t=document.forms["form_"+this.table_id];if(!t)return;this.SwitchActionButtons(true);var i=t["ID[]"];
if(!i.length)i=new Array(i);for(var s=0;s<i.length;s++){var a=i[s];if(a.checked){var n=this.getRowByCheckBox(a);var l=BX.findChild(n,{tagName:"a",className:"bx-disk-folder-title"},true);if(!l){continue}BX.denyEvent(l,"dblclick");BX.denyEvent(l,"click");var r=a.value;this.oSaveData[r]={};if(this.oColsMeta["NAME"].editable==true&&this.oEditData[r]["NAME"]!==false){this.oSaveData[r]["NAME"]=l.innerHTML;l.innerHTML="";var o=this.oEditData[r]["NAME"];var c="FIELDS["+r+"]["+"NAME"+"]";var h="id-FIELDS-"+r+"-"+"NAME"+"";if(BX(h)){continue}switch(this.oColsMeta["NAME"].type){default:var d={className:"bx-disk-folder-title",id:h,type:"text",name:c,value:o,size:this.oColsMeta["NAME"].size?this.oColsMeta["NAME"].size:15};if(this.oColsMeta["NAME"].maxlength)d.maxLength=this.oColsMeta["NAME"].maxlength;l.parentNode.appendChild(BX.create("INPUT",{props:d}));break}}}a.disabled=true}t.elements["action_button_"+this.table_id].value="edit"}};this.ActionCancel=function(){var e=document.forms["form_"+this.table_id];if(!e)return;this.SwitchActionButtons(false);var t=e["ID[]"];if(!t.length)t=new Array(t);for(var i=0;i<t.length;i++){var s=t[i];if(s.checked){var a=this.getRowByCheckBox(s);var n=BX.findChild(a,{tagName:"a",className:"bx-disk-folder-title"},true);if(!n){continue}BX.allowEvent(n,"dblclick");BX.allowEvent(n,"click");var l=s.value;if(this.oColsMeta["NAME"].editable==true&&this.oEditData[l]["NAME"]!==false){BX.adjust(n,{text:this.oSaveData[l]["NAME"]});var r="id-FIELDS-"+l+"-"+"NAME"+"";BX.remove(BX(r))}}s.disabled=false}e.elements["action_button_"+this.table_id].value=""}}BX.extend(BxInterfaceTile,BxDiskInterfaceGrid);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:92:"/bitrix/components/bitrix/disk.help.network.drive/templates/.default/script.js?1511316484302";s:6:"source";s:78:"/bitrix/components/bitrix/disk.help.network.drive/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
BX.namespace("BX.Disk");
BX.Disk.HelpNetworkDriveClass = (function ()
{
	var HelpNetworkDriveClass = function (parameters){};
	HelpNetworkDriveClass.prototype.showContent = function (el)
	{
		el.style.display = (el.style.display == 'none') ? 'block' : 'none';
	};

	return HelpNetworkDriveClass;
})();

/* End */
;
; /* Start:"a:4:{s:4:"full";s:95:"/bitrix/components/bitrix/disk.breadcrumbs.tree/templates/.default/script.min.js?15113164846283";s:6:"source";s:76:"/bitrix/components/bitrix/disk.breadcrumbs.tree/templates/.default/script.js";s:3:"min";s:80:"/bitrix/components/bitrix/disk.breadcrumbs.tree/templates/.default/script.min.js";s:3:"map";s:80:"/bitrix/components/bitrix/disk.breadcrumbs.tree/templates/.default/script.map.js";}"*/
BX.namespace("BX.Disk");BX.Disk.BreadcrumbsTreeClass=function(){var e=[];var t=true;function s(){return e}function i(t){e.push(t)}var a=function(e){this.rootObject=e.rootObject||{};this.firstObject=e.firstObject||{};this.containerId=e.containerId;this.container=BX(this.containerId);this.storageBaseUrl=e.storageBaseUrl||"/";this.lastNode=null;this.ajaxUrl="/bitrix/components/bitrix/disk.breadcrumbs.tree/ajax.php";this.setEvents();this.drawFirstNode(this.firstObject)};a.prototype.onSelectFolder=function(e){var t=BX.findChild(e,{className:"bx-disk-wf-folder-name"},true);if(!t)return false;var s=[];var i=BX.findChild(t,{tagName:"span"});if(i){s.push(encodeURIComponent(i.textContent||i.innerText))}BX.findParent(e,function(e){if(BX.type.isElementNode(e)&&BX.hasClass(e,"bx-disk-parent")){var t=BX.findChild(e,{className:"bx-disk-wf-folder-name"},true);if(t){var i=BX.findChild(t,{tagName:"span"});if(i){s.push(encodeURIComponent(i.textContent||i.innerText))}}}},this.container);var a=this.storageBaseUrl+s.reverse().join("/");if(a.slice(-1)!="/"){a+="/"}document.location.href=a};a.prototype.onUnSelectFolder=function(e){};a.prototype.onRemoveRowFromDiskList=function(e){var t=BX.findChild(this.container,{tagName:"li",className:"bx-disk-folder-container",attribute:{"data-object-id":e}},true);if(t){BX.remove(t)}};a.prototype.setEvents=function(){BX.addCustomEvent(this.container,"onSelectFolder",BX.proxy(this.onSelectFolder,this));BX.addCustomEvent(this.container,"onUnSelectFolder",BX.proxy(this.onUnSelectFolder,this));BX.addCustomEvent("onRemoveRowFromDiskList",BX.proxy(this.onRemoveRowFromDiskList,this))};a.prototype.drawFirstNode=function(e){var t=this.buildTreeNode(e);var s=BX.create("ul",{props:{className:"bx-disk-wood-folder"}});t.appendChild(s);this.lastNode=t;BX.adjust(this.container,{children:[BX.create("ul",{props:{className:"bx-disk-wood-folder"},children:[t]})]})};a.prototype.loadSubFolders=function(e){if(!e){return}var t=e.getAttribute("data-object-id");if(!t){return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSubFoldersToAdd"),data:{objectId:t},onsuccess:BX.delegate(function(t){if(!t||t.status!="success"){BX.Disk.showModalWithStatusAction(t);return}this.buildTree(e,t);window.jsDD.refreshDestArea()},this)})};a.prototype.buildTree=function(e,t){if(!t||t.status!="success"){BX.Disk.showModalWithStatusAction(t);return}var s=BX.create("ul",{props:{className:"bx-disk-wood-folder"}});e.appendChild(s);if(t.items&&t.items.length){for(var i in t.items){if(!t.items.hasOwnProperty(i)){continue}s.appendChild(this.buildTreeNode(t.items[i]))}}else{var a=BX.findChild(e,{className:"bx-disk-wf-arrow"},true);if(a){BX.cleanNode(a)}}BX.removeClass(e,"bx-disk-close");BX.addClass(e,"bx-disk-open");BX.addClass(e,"bx-disk-loaded")};a.prototype.buildTreeNode=function(e){this.lastNode=BX.create("li",{props:{className:"bx-disk-folder-container bx-disk-parent bx-disk-close"},attrs:{"data-object-id":e.id},children:[BX.create("div",{props:{className:"bx-disk-folder-container"},children:[BX.create("table",{children:[BX.create("tr",{children:[BX.create("td",{props:{className:"bx-disk-wf-arrow"},events:{click:BX.delegate(function(e){var t=e.target||e.srcElement;var s=BX.findParent(t,{className:"bx-disk-parent"});if(BX.hasClass(s,"bx-disk-open")){BX.removeClass(s,"bx-disk-open");BX.addClass(s,"bx-disk-close");return}if(BX.hasClass(s,"bx-disk-loaded")){BX.removeClass(s,"bx-disk-close");BX.addClass(s,"bx-disk-open");return}this.loadSubFolders(s)},this)},children:[e.hasSubFolders?BX.create("span"):null]}),BX.create("td",{props:{className:"bx-disk-wf-folder-icon"},children:[BX.create("span")]}),BX.create("td",{props:{className:"bx-disk-wf-folder-name"},events:{click:BX.delegate(function(e){var t=e.target||e.srcElement;var s=BX.findParent(t,{className:"bx-disk-parent"});if(BX.hasClass(s,"selected")){BX.removeClass(s,"selected");BX.onCustomEvent(this.container,"onUnSelectFolder",[s]);return}BX.addClass(s,"selected");BX.onCustomEvent(this.container,"onSelectFolder",[s])},this)},children:[BX.create("span",{text:e.name})]})]})]})]})]});var s=BX.findChild(this.lastNode,{className:"bx-disk-folder-container"});if(!s){return this.lastNode}s.onbxdestdraghout=function(){BX.removeClass(this.parentNode,"selected")};s.onbxdestdragfinish=BX.delegate(function(e,t,s){if(!e.getAttribute("data-object-id")){return false}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","moveTo"),data:{objectId:e.getAttribute("data-object-id"),targetObjectId:BX.proxy_context.parentNode.getAttribute("data-object-id")},onsuccess:function(e){BX.Disk.showModalWithStatusAction(e)}});return true},this);s.onbxdestdraghover=function(e,t,s){if(!e.getAttribute("data-object-id")){return false}if(BX.hasClass(this.parentNode,"selected")){return}BX.addClass(this.parentNode,"selected");if(BX.hasClass(this.parentNode,"bx-disk-open")){return}var i=BX.findChild(this,{className:"bx-disk-wf-arrow"},true);if(!i)return;BX.fireEvent(i,"click");return true};window.jsDD.registerDest(s);t&&i(this.lastNode);return this.lastNode};a.prototype.lazyLoadSubFolders=function(e){t=false;var i=BX.clone(s());var a=[];var r=this.buildTreeNode(this.rootObject);i.unshift(r);for(var o in i){if(!i.hasOwnProperty(o)){continue}var n=i[o].getAttribute("data-object-id");if(typeof n!=="undefined"&&n!="undefined"){a.push(n)}}if(!a.length){return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","showManySubFolders"),data:{objectIds:a},onsuccess:BX.delegate(function(t){if(!t||t.status!="success"){BX.Disk.showModalWithStatusAction(t);return}var s=0;var i=null;var r=null;var o;var n;var d;while(a.length){d=a.shift();n=a.shift();if(n){a.unshift(n)}o=BX.create("ul",{props:{className:"bx-disk-wood-folder"}});r=i;if(t.items[d]&&t.items[d].length){for(var l in t.items[d]){if(!t.items[d].hasOwnProperty(l)){continue}var c=this.buildTreeNode(t.items[d][l]);if(t.items[d][l].id==n){i=c}o.appendChild(c)}}if(s==0){BX.cleanNode(this.container);BX.adjust(this.container,{children:[o]})}else if(r){r.appendChild(o);BX.removeClass(r,"bx-disk-close");BX.addClass(r,"bx-disk-open");BX.addClass(r,"bx-disk-loaded")}s++}e()},this)})};return a}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:91:"/bitrix/components/bitrix/disk.file.upload/templates/.default/script.min.js?151131648415950";s:6:"source";s:71:"/bitrix/components/bitrix/disk.file.upload/templates/.default/script.js";s:3:"min";s:75:"/bitrix/components/bitrix/disk.file.upload/templates/.default/script.min.js";s:3:"map";s:75:"/bitrix/components/bitrix/disk.file.upload/templates/.default/script.map.js";}"*/
(function(){if(BX.DiskUpload)return;var e=[];BX.DiskUpload=function(e){this.bp=e["bp"];this.bpParameters=e["bpParameters"];this.bpParametersRequired=e["bpParametersRequired"];this.storageId=e["storageId"];this.ajaxUrl="/bitrix/components/bitrix/disk.folder.list/ajax.php";this.CID=e["CID"];this.nodeContent=BX.create("DIV",{style:{display:"none"},attrs:{id:e["CID"]+"ContentNode"},html:BX.message("DFU_TEMPLATE").replace(/#id#/gi,this.CID)+'<div class="wduf-uploader area">'+BX.message("DFU_DND_TEMPLATE")+"</div>"});document.body.appendChild(this.nodeContent);this.counter={all:[],uploaded:[],uploading:[]};this.init(e);return this};BX.DiskUpload.prototype={_camelToSNAKE:function(e){var t={},i,s;for(i in e){if(e.hasOwnProperty(i)){s=i.replace(/(.)([A-Z])/g,"$1_$2").toUpperCase();t[s]=e[i];t[i]=e[i]}}return t},initAttempt:0,init:function(e){this.initAttempt++;if(this.initAttempt>10||this.agent)return;this.placeHolder=BX(this.CID+"PlaceHolder");if(this.placeHolder){this.templates={"new":BX.message("DFU_NODE_TEMPLATE"),done:BX.message("DFU_NODE_TEMPLATE_DONE"),canceled:BX.message("DFU_NODE_TEMPLATE_CANCELED"),error:BX.message("DFU_NODE_TEMPLATE_ERROR"),error_double:BX.message("DFU_NODE_TEMPLATE_ERROR_DOUBLE")};var t,i,s,o,r,a;for(t in this.templates){o={};if(this.templates.hasOwnProperty(t)){i=this.templates[t];if(/^<tr(.*?)>/gi.test(i)){s=/^<tr(.*?)>/gi.exec(i);s=s[1].split(" ");if(s&&s.length>0){for(r=0;r<s.length;r++){a=s[r].split("=");if(a&&a.length==2){a[0]=a[0].replace(/['"]/gi,"");a[1]=a[1].replace(/['"]/gi,"");o[a[0]]=a[1]}}}}this.templates[t]={node:"TR",attrs:o,text:i.replace(/^<tr(.*?)>/i,"").replace(/<\/tr>$/i,"")}}}var n;if(this.bp){if(this.bpParameters){n="deferred"}else{if(BX("formPostAjax").getElementsByTagName("div").length){BX("formPostAjax").removeChild(BX("divStartBizProc"))}var d=BX("divStartBizProc").cloneNode(true);BX("formPostAjax").appendChild(d);n="immediate"}this.agent=BX.Uploader.getInstance({id:this.CID,streams:1,allowUpload:"A",uploadFormData:"Y",uploadMethod:n,uploadFileUrl:e["urlUpload"],showImage:false,sortItems:false,input:e["input"],dropZone:e["dropZone"],placeHolder:this.placeHolder,phpMaxFileUploads:1,queueFields:{thumb:{tagName:"TR",className:"bxu-item"}},fields:{thumb:{tagName:"",template:this.templates["new"].text}}})}else{this.agent=BX.Uploader.getInstance({id:this.CID,streams:1,allowUpload:"A",uploadFormData:"Y",uploadMethod:"immediate",uploadFileUrl:e["urlUpload"],showImage:false,sortItems:false,input:e["input"],dropZone:e["dropZone"],placeHolder:this.placeHolder,phpMaxFileUploads:1,queueFields:{thumb:{tagName:"TR",className:"bxu-item"}},fields:{thumb:{tagName:"",template:this.templates["new"].text}}})}this._onItemIsAdded=BX.delegate(this.onItemIsAdded,this);this._onFileIsInited=BX.delegate(this.onFileIsInited,this);this._onStart=BX.delegate(this.onStart,this);this._onError=BX.delegate(this.onError,this);if(BX(this.agent.fileInput)&&!this.agent.fileInput.hasAttribute("id"))this.agent.fileInput.setAttribute("id","diskUbloadFileInput"+this.CID);BX.addCustomEvent(this.agent,"onItemIsAdded",this._onItemIsAdded);BX.addCustomEvent(this.agent,"onFileIsInited",this._onFileIsInited);BX.addCustomEvent(this.agent,"onStart",this._onStart);BX.addCustomEvent(this.agent,"onError",this._onError);this._onFileIsAppended=BX.delegate(this.onFileIsAppended,this);this._onUploadStart=BX.delegate(this.onUploadStart,this);this._onUploadProgress=BX.delegate(this.onUploadProgress,this);this._onUploadDone=BX.delegate(this.onUploadDone,this);this._onUploadError=BX.delegate(this.onUploadError,this);this._onUploadWindowClose=BX.delegate(this.onUploadWindowClose,this);this._onUploadWindowFirstShow=BX.delegate(this.onUploadWindowFirstShow,this);this._onStartBizproc=BX.delegate(this.onStartBizproc,this);if(BX(e["dropZone"])){var l=BX.create("DIV",{attrs:{className:"wduf-uploader area"},html:BX.message("DFU_DND_TEMPLATE")}),p=BX.pos(e["dropZone"]);BX.adjust(e["dropZone"],{style:{position:"relative"},children:[l]});BX.addCustomEvent(this.agent.dropZone,"dragEnter",function(){var e=BX.GetWindowInnerSize(),t=BX.GetWindowScrollPos();p["height"]=e["innerHeight"]-(p["top"]-t["scrollTop"]);l.style.height=p["height"]+"px"})}}else{setTimeout(BX.delegate(function(){this.init(e)},this),500)}},onItemIsAdded:function(){if(this.popup)this.popup.show();else if(this.bp&&this.bpParameters){var e=BX.findChildren(this.nodeContent);e.unshift(BX("parametersFormBp"));this.popup=BX.Disk.modalWindow({modalId:"bx-dfu-upload-"+this.CID,title:BX.message("DFU_UPLOAD_TITLE1"),contentClassName:" tac bx-disk-upload-file",withoutWindowManager:true,content:e,events:{onPopupFirstShow:this._onUploadWindowFirstShow,onPopupClose:function(){BX.reload()}},zIndex:-200,htmlButtons:[BX.create("A",{text:BX.message("DFU_SAVE_BP"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-green mb0"},events:{click:this._onStartBizproc},attrs:{id:"bx-disk-savebp-button"}}),BX.create("LABEL",{text:BX.message("DFU_UPLOAD"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-green mb0 bx-hide-button"},attrs:{id:"bx-disk-upload-button","for":this.agent.fileInput.getAttribute("id")}}),BX.create("A",{text:BX.message("DFU_CLOSE"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-gray mb0"},attrs:{id:this.CID+"ButtonClose",disabled:true},events:{click:this._onUploadWindowClose}})]})}else{this.popup=BX.Disk.modalWindow({modalId:"bx-dfu-upload-"+this.CID,title:BX.message("DFU_UPLOAD_TITLE1"),contentClassName:" tac bx-disk-upload-file",content:BX.findChildren(this.nodeContent),events:{onPopupFirstShow:this._onUploadWindowFirstShow,onPopupClose:BX.delegate(function(){BX.addCustomEvent(this.agent,"onItemIsAdded",this._onItemIsAdded)},this)},htmlButtons:[BX.create("LABEL",{text:BX.message("DFU_UPLOAD"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-green mb0"},attrs:{"for":this.agent.fileInput.getAttribute("id")}}),BX.create("A",{text:BX.message("DFU_CLOSE"),props:{className:"bx-disk-btn bx-disk-btn-big bx-disk-btn-gray mb0"},attrs:{id:this.CID+"ButtonClose",disabled:true},events:{click:this._onUploadWindowClose}})]})}this.popup.destroy=BX.DoNothing;BX.removeCustomEvent(this.agent,"onItemIsAdded",this._onItemIsAdded)},onStartBizproc:function(){if(BX("formPostAjax").getElementsByTagName("div").length){BX("formPostAjax").removeChild(BX("divStartBizProc"))}var e=BX("divStartBizProc").cloneNode(true),t=BX("parametersFormBp").querySelectorAll("textarea"),i=BX("parametersFormBp").querySelectorAll("select"),s=e.querySelectorAll("textarea"),o=e.querySelectorAll("select"),r;if(t.length){for(r in t){if(t.hasOwnProperty(r)){s[r].value=t[r].value}}}if(i.length){for(r in i){if(i.hasOwnProperty(r)){o[r].value=i[r].value}}}BX("formPostAjax").appendChild(e);var a=BX.ajax.prepareForm(BX("formPostAjax")),n=this.agent;BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","validateParameterAutoloadBizProc"),data:{required:this.bpParametersRequired,data:a,storageId:this.storageId},onsuccess:function(e){if(e.status=="success"){n.submit();BX("formPostAjax").removeChild(BX("divStartBizProc"));BX("errorTd").innerHTML="";if(!BX.hasClass(BX("bx-disk-savebp-button"),"bx-hide-button")){BX.toggleClass(BX("bx-disk-upload-button"),"bx-hide-button");BX.toggleClass(BX("bx-disk-savebp-button"),"bx-hide-button")}}else{if(BX("formPostAjax").getElementsByTagName("div").length){BX("formPostAjax").removeChild(BX("divStartBizProc"))}for(r in e["errors"]){if(e["errors"].hasOwnProperty(r)){BX("errorTd").innerHTML=e["errors"][r].message}}if(BX.hasClass(BX("bx-disk-savebp-button"),"bx-hide-button")){BX.toggleClass(BX("bx-disk-upload-button"),"bx-hide-button");BX.toggleClass(BX("bx-disk-savebp-button"),"bx-hide-button")}}}})},onFileIsInited:function(e,t){this.counter.all.push(e);BX.addCustomEvent(t,"onFileIsAppended",this._onFileIsAppended);BX.addCustomEvent(t,"onUploadStart",this._onUploadStart);BX.addCustomEvent(t,"onUploadProgress",this._onUploadProgress);BX.addCustomEvent(t,"onUploadDone",this._onUploadDone);BX.addCustomEvent(t,"onUploadError",this._onUploadError);this.__checkButton();if(this.bp&&this.bpParameters&&this.popup){this.onStartBizproc()}},onFileIsAppended:function(e,t){var i=this.agent.getItem(e);this.__bindEventsToNode(i.node,t)},onUploadStart:function(e){this.counter.uploading.push(e.id);e.__progressBar=BX(e.id+"Progress");e.__progressBarWidth=5;if(e.__progressBar)e.__progressBar.style.width=e.__progressBarWidth+"%"},onUploadProgress:function(e,t){t=Math.min(t,96);if(t>e.__progressBarWidth){e.__progressBarWidth=Math.ceil(t);e.__progressBarWidth=e.__progressBarWidth>100?100:e.__progressBarWidth;if(e.__progressBar)e.__progressBar.style.width=e.__progressBarWidth+"%"}},onUploadDone:function(e,t){if(e.__progressBar)e.__progressBar.style.width="100%";this.counter.uploading=BX.util.deleteFromArray(this.counter.uploading,BX.util.array_search(e.id,this.counter.uploading));this.counter.uploaded.push(e.id);e.fileId=t["file"]["fileId"];var i=this.agent.getItem(e.id).node,s=this._camelToSNAKE(t["file"]);if(BX(i)){var o=this.templates.done.text;for(var r in s){if(s.hasOwnProperty(r)){o=o.replace(new RegExp("#"+r.toLowerCase()+"#","gi"),s[r]).replace(new RegExp("#"+r.toUpperCase()+"#","gi"),s[r])}}var a;if(BX.browser.IsIE8()){a=i;while(a.cells.length>0){a.deleteCell(0)}var n=0;o.replace(/<\/td>/gi,"").replace(/<td([^>]+)>([^\002]+)\002/gi,function(e,t,i){var s=a.insertCell(n);s.innerHTML=i;t.replace(/class=["']([a-z\-\s]+)['"]/,function(e,t){s.className=t});n++;return""})}else{a=BX.create("TR",{attrs:this.templates.done.attrs,html:o});a.setAttribute("id",i.getAttribute("id"));i.parentNode.replaceChild(a,i)}}else{this.onUploadError(e,t)}this.__bindEventsToNode(i,e);this.__checkButton()},onUploadError:function(e,t,i){this.counter.uploading=BX.util.deleteFromArray(this.counter.uploading,BX.util.array_search(e.id,this.counter.uploading));t=typeof t=="object"&&t?t:{};var s=this.agent.getItem(e.id).node,o=this._camelToSNAKE(t);if(BX(s)&&(i==true||!BX(s).hasAttribute("bx-disk-error"))){o=!!o&&typeof o=="object"?o:{};var r=o["file"]&&o["file"]["isNotUnique"]?this.templates.error_double:this.templates.error,a=r.text,n;for(n in e){if(e.hasOwnProperty(n)&&typeof e[n]=="string"){a=a.replace(new RegExp("#"+n.toLowerCase()+"#","gi"),e[n]).replace(new RegExp("#"+n.toUpperCase()+"#","gi"),e[n])}}if(o){for(n in o){if(o.hasOwnProperty(n)){a=a.replace(new RegExp("#"+n.toLowerCase()+"#","gi"),o[n]).replace(new RegExp("#"+n.toUpperCase()+"#","gi"),o[n])}}if(o["file"]){for(n in o["file"]){if(o["file"].hasOwnProperty(n)){a=a.replace(new RegExp("#"+n.toLowerCase()+"#","gi"),o["file"][n]).replace(new RegExp("#"+n.toUpperCase()+"#","gi"),o["file"][n])}}}}var d=BX.create("TR",{attrs:r.attrs,html:a});d.setAttribute("id",s.getAttribute("id"));d.setAttribute("bx-disk-error","Y");s.parentNode.replaceChild(d,s);this.__bindEventsToNode(d,e);this.__checkButton();if(this.uploadParams.errored<=0){var l=BX.pos(d),p=BX.pos(this.placeHolder);this.placeHolder.parentNode.scrollTop=l.top-p.top}this.uploadParams.errored++}else{BX.debug("BX.Disk.Upload: node for error does not exist.")}},uploadParams:{errored:0},onStart:function(){this.uploadParams.errored=0},onError:function(e,t,i){if(i&&i.status==="restriction"&&BX("bx-bitrix24-business-tools-info")){BX.PopupWindowManager.create("bx-disk-business-tools-info",null,{content:BX("bx-bitrix24-business-tools-info"),closeIcon:true,onPopupClose:function(){this.destroy()},autoHide:true}).show()}var s="Uploading error.",o=s,r,a;if(i){if(i["error"]&&typeof i["error"]=="string")o=i["error"];else if(i["message"]&&typeof i["message"]=="string")o=i["message"];else if(BX.type.isArray(i["errors"])&&i["errors"].length>0){o=[];for(var n=0;n<i["errors"].length;n++){if(typeof i["errors"][n]=="object"&&i["errors"][n]["message"])o.push(i["errors"][n]["message"])}if(o.length<=0)o.push(s);o=o.join(" ")}}e["files"]=e.files||{};for(a in e["files"]){if(e["files"].hasOwnProperty(a)){r=this.agent.queue.items.getItem(a);this.onUploadError(r,{error:o},o!=s)}}},deleteFile:function(e,t){BX.addClass(e,"bx-disk-popup-upload-file-delete-event");var i=BX.findChild(e,{className:"file-delete"},true),s=BX.util.array_search(t.id,this.counter.uploaded);if(s>=0)this.counter.uploaded=BX.util.deleteFromArray(this.counter.uploaded,s);s=BX.util.array_search(t.id,this.counter.uploading);if(s>=0)this.counter.uploading=BX.util.deleteFromArray(this.counter.uploading,s);this.counter.all=BX.util.deleteFromArray(this.counter.all,BX.util.array_search(t.id,this.counter.all));delete t.hash;setTimeout(function(){t.deleteFile("deleteFile")},400);if(!!i&&i.getAttribute("href").length>0)BX.ajax.post(i.href,{sessid:BX.bitrix_sessid()});this.__checkButton()},replaceFile:function(e,t){if(BX(e)){var i=this.templates["new"].text;for(var s in t){if(t.hasOwnProperty(s)){i=i.replace(new RegExp("#"+s.toLowerCase()+"#","gi"),t[s]).replace(new RegExp("#"+s.toUpperCase()+"#","gi"),t[s])}}var o=BX.create("TR",{attrs:this.templates["new"].attrs,html:i});o.setAttribute("id",e.getAttribute("id"));e.parentNode.replaceChild(o,e);this.__bindEventsToNode(e,t);this.__checkButton();var r=t.file.uploadStatus;this.agent.queue.restoreFiles(new BX.UploaderUtils.Hash(t.id,t),true);t.file.uploadStatus=r;if(this.agent.post){this.agent.post.data["REPLACE_FILE"]=this.agent.post.data["REPLACE_FILE"]||[];this.agent.post.data["REPLACE_FILE"].push(t.id)}var a;if(this.agent.form){a=BX.create("INPUT",{attrs:{id:"input"+t.id},props:{name:"REPLACE_FILE[]",value:t.id}});this.agent.form.appendChild(a)}this.agent.submit();if(this.agent.post){this.agent.post.data["REPLACE_FILE"].pop()}if(this.agent.form){BX.remove(a)}}},__checkButton:function(){var e=BX(this.CID+"ButtonClose"),t=BX(this.CID+"Number"),i=BX(this.CID+"Count");if(e)BX.adjust(e,{props:{disabled:this.counter.uploading.length>0}});if(t)t.innerHTML=this.counter.uploaded.length;if(i)i.innerHTML=this.counter.all.length},__bindEventsToNode:function(e,t){var i=BX.delegate(function(){this.deleteFile(e,t)},this),s=BX.delegate(function(){this.replaceFile(e,t)},this),o=BX.findChild(e,{attribute:{id:t.id+"Cancel"}},true),r=BX.findChild(e,{attribute:{id:t.id+"Replace"}},true);if(o&&!o.hasAttribute("bx-bound")){o.setAttribute("bx-bound","Y");BX.bind(o,"click",i)}if(r&&!r.hasAttribute("bx-bound")){r.setAttribute("bx-bound","Y");BX.bind(r,"click",s)}},onUploadWindowFirstShow:function(e){this.agent.initDropZone(e.contentContainer);if(this.bp&&this.bpParameters){var t=BX.findChildrenByClassName(BX("parametersFormBp"),"bx-html-editor"),i;for(var s in t){if(t.hasOwnProperty(s)){i=t[s].getAttribute("id").replace("bx-html-editor-","");window["BXHtmlEditor"].editors[i].CheckAndReInit()}}}},onUploadWindowClose:function(){if(this.popup&&this.counter.uploading.length<=0){this.popup.close();if(this.counter.uploaded.length>0){var e,t;while((t=this.agent.getItem(this.counter.uploaded.pop()))&&t&&t["item"]&&(t=t["item"])){if(t["fileId"]){e=BX.Disk.getUrlToShowObjectInGrid(t["fileId"]);break}}BX.reload(e)}}}};BX.DiskUpload.initialize=function(t){if(!BX(t["inputContainer"])){BX.debug("BX.Disk.Uploader: inputContainer is not found.")}else{t["CID"]=t["CID"]?t["CID"]:"DiskUpload";var i=BX(t["inputContainer"]),s=BX.create("INPUT",{attrs:{id:"inputContainer"+t["CID"]},props:{type:"file",multiple:true,title:BX.message("DFU_UPLOAD_TITLE1")}}),o=BX.create("FORM",{attrs:{id:"formPostAjax"},children:[s,t["targetFileId"]?BX.create("INPUT",{props:{type:"hidden",name:"targetFileId",value:t["targetFileId"]}}):BX.create("INPUT",{props:{type:"hidden",name:"targetFolderId",value:t["targetFolderId"]}})]}),r=BX.create("LABEL",{attrs:{className:i.className,id:i.id,title:BX.message("DFU_UPLOAD_TITLE1"),"for":"inputContainer"+t["CID"]},html:i.innerHTML});i.parentNode.replaceChild(r,i);r.appendChild(o);t["input"]=s;if(!e[t["CID"]]){e[t["CID"]]=new BX.DiskUpload(t)}}return e[t["CID"]]};BX.DiskUpload.getObj=function(t){return e[t]}})();
/* End */
;; /* /bitrix/components/bitrix/socialnetwork.admin.set/templates/.default/script.js?15113165822527*/
; /* /bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.min.js?15113164847121*/
; /* /bitrix/components/bitrix/disk.folder.list/templates/.default/script.min.js?151131648493149*/
; /* /bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.min.js?15113164843353*/
; /* /bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.min.js?151131648433670*/
; /* /bitrix/components/bitrix/disk.help.network.drive/templates/.default/script.js?1511316484302*/
; /* /bitrix/components/bitrix/disk.breadcrumbs.tree/templates/.default/script.min.js?15113164846283*/
; /* /bitrix/components/bitrix/disk.file.upload/templates/.default/script.min.js?151131648415950*/

//# sourceMappingURL=page_9d9829e41b4c3ccccb44e610ffcb2f43.map.js