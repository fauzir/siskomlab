
; /* Start:"a:4:{s:4:"full";s:93:"/bitrix/components/bitrix/socialnetwork.admin.set/templates/.default/script.js?15113165822527";s:6:"source";s:78:"/bitrix/components/bitrix/socialnetwork.admin.set/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
var waitDiv = null;
var waitPopup = null;
var waitTimeout = null;
var waitTime = 500;

function __SASSetAdmin()
{
	__SASShowWait();
	BX.ajax({
		url: '/bitrix/components/bitrix/socialnetwork.admin.set/ajax.php',
		method: 'POST',
		dataType: 'json',
		data: {'ACTION': 'SET', 'sessid': BX.bitrix_sessid(), 'site': BX.util.urlencode(BX.message('SASSiteId'))},
		onsuccess: function(data) { __SASProcessAJAXResponse(data); }
	});
}

function __SASProcessAJAXResponse(data)
{
	if (data["SUCCESS"] != "undefined" && data["SUCCESS"] == "Y")
	{
		BX.reload();
		return false;
	}
	else if (data["ERROR"] != "undefined" && data["ERROR"].length > 0)
	{
		if (data["ERROR"].indexOf("SESSION_ERROR", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorSessionWrong'));
			BX.reload();
		}
		else if (data["ERROR"].indexOf("CURRENT_USER_NOT_ADMIN", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorNotAdmin'));
			return false;
		}
		else if (data["ERROR"].indexOf("CURRENT_USER_NOT_AUTH", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorCurrentUserNotAuthorized'));
			return false;
		}
		else if (data["ERROR"].indexOf("SONET_MODULE_NOT_INSTALLED", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorModuleNotInstalled'));
			return false;
		}
		else
		{
			__SASShowError(data["ERROR"]);
			return false;		
		}
	}
}
				
function __SASShowError(errorText) 
{
	__SASCloseWait();

	var errorPopup = new BX.PopupWindow('sas-error' + Math.random(), window, {
		autoHide: true,
		lightShadow: false,
		zIndex: 2,
		content: BX.create('DIV', {props: {'className': 'sonet-adminset-error-text-block'}, html: errorText}),
		closeByEsc: true,
		closeIcon: true
	});
	errorPopup.show();

}

function __SASShowWait(timeout)
{
	if (timeout !== 0)
	{
		return (waitTimeout = setTimeout(function(){
			__SASShowWait(0)
		}, 50));
	}

	if (!waitPopup)
	{
		waitPopup = new BX.PopupWindow('sas_wait', window, {
			autoHide: true,
			lightShadow: true,
			zIndex: 2,
			content: BX.create('DIV', {
				props: {
					className: 'sonet-adminset-wait-cont'
				},
				children: [
					BX.create('DIV', {
						props: {
							className: 'sonet-adminset-wait-icon'
						}
					}),
					BX.create('DIV', {
						props: {
							className: 'sonet-adminset-wait-text'
						},
						html: BX.message('SASWaitTitle')
					})
				]
			})
		});
	}
	else
		waitPopup.setBindElement(window);

	waitPopup.show();
}

function __SASCloseWait()
{
	if (waitTimeout)
	{
		clearTimeout(waitTimeout);
		waitTimeout = null;
	}

	if (waitPopup)
		waitPopup.close();
}
/* End */
;
; /* Start:"a:4:{s:4:"full";s:93:"/bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.min.js?15113164847121";s:6:"source";s:74:"/bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.js";s:3:"min";s:78:"/bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.min.js";s:3:"map";s:78:"/bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.map.js";}"*/
BX.namespace("BX.Disk");BX.Disk.FolderToolbarClass=function(){var e=function(e){this.id=e.id;this.destFormName=e.destFormName;this.toolbarContainer=e.toolbarContainer||null;this.createBlankFileUrl=e.createBlankFileUrl;this.renameBlankFileUrl=e.renameBlankFileUrl;this.targetFolderId=e.targetFolderId;this.defaultService=e.defaultService;this.defaultServiceLabel=e.defaultServiceLabel;this.ajaxUrl="/bitrix/components/bitrix/disk.folder.toolbar/ajax.php";this.setEvents()};e.prototype.setEvents=function(){};e.prototype.emptyTrashCan=function(){BX.onCustomEvent("onEmptyTrashCan",[])};e.prototype.createFolder=function(){BX.Disk.modalWindow({modalId:"bx-disk-create-folder",title:BX.message("DISK_FOLDER_TOOLBAR_TITLE_CREATE_FOLDER"),contentClassName:"",contentStyle:{paddingTop:"30px",paddingBottom:"70px"},events:{onAfterPopupShow:function(){BX.focus(BX("disk-new-create-filename"))},onPopupClose:function(){this.destroy()}},content:[BX.create("label",{props:{className:"bx-disk-popup-label","for":"disk-new-create-filename"},children:[BX.create("span",{props:{className:"req"},text:"*"}),BX.message("DISK_FOLDER_TOOLBAR_LABEL_NAME_CREATE_FOLDER")]}),BX.create("input",{props:{id:"disk-new-create-filename",className:"bx-disk-popup-input",type:"text",value:""},style:{fontSize:"16px",marginTop:"10px"}})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CREATE_FOLDER"),className:"popup-window-button-accept",events:{click:BX.delegate(function(){var e=BX("disk-new-create-filename").value;if(!e){BX.focus(BX("disk-new-create-filename"));return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","addFolder"),data:{targetFolderId:this.targetFolderId,name:e},onsuccess:function(e){if(!e){return}if(e.status&&e.status=="success"){document.location=BX.Disk.getUrlToShowObjectInGrid(e.folder.id)}else{BX.Disk.showModalWithStatusAction(e)}}})},this)}}),new BX.PopupWindowButton({text:BX.message("DISK_FOLDER_TOOLBAR_BTN_CLOSE"),events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})};e.prototype.removeShared=function(e){var i=e.item.id;var s=e.item.name;var a=e.item.avatar;var o=e.type;delete t[i];var r=BX.findChild(BX("bx-disk-popup-shared-people-list"),{attribute:{"data-dest-id":""+i+""}},true);if(r){BX.remove(r)}};var t={};var i=0;e.prototype.appendNewShared=function(e){t[e.item.id]={destFormName:this.destFormName,item:e.item,type:e.type,right:"disk_access_read"};BX.Disk.appendNewShared(e)};e.prototype.createExtendedFolder=function(){t={};BX.onCustomEvent("onCreateExtendedFolder",[])};e.prototype.createFile=function(){BX.Disk.modalWindow({modalId:"bx-disk-create-file",title:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_FILE_TITLE"),contentClassName:"tac bx-disk-create-file-big",contentStyle:{paddingTop:"30px",paddingBottom:"70px"},events:{onPopupClose:function(){BX.PopupMenu.destroy("disk_open_menu_with_services")}},content:[BX.create("div",{props:{className:"bx-disk-create-file-section"},children:[BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_FILE_TEXT")+" ",BX.create("span",{style:{cursor:"pointer"},children:[BX.create("span",{text:this.defaultServiceLabel,props:{className:"bx-disk-create-file-bdbdotted",id:"bx-disk-default-service-label"}}),BX.create("SPAN",{html:"&nbsp;"}),BX.create("span",{props:{className:"bx-disk-create-file-big-icon"}})],events:{click:BX.delegate(function(e){this.openMenuWithServices(BX("bx-disk-default-service-label"));BX.PreventDefault(e)},this)}})]}),BX.create("div",{props:{className:"bx-disk-create-file-section"},children:[BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_TYPE_DOC"),props:{className:"bx-disk-create-file-big-icon bx-disk-create-file-big-doc"},style:{cursor:"pointer"},events:{click:BX.delegate(function(e){this.runCreatingFile("docx");BX.PreventDefault(e)},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_TYPE_XLS"),props:{className:"bx-disk-create-file-big-icon bx-disk-create-file-big-table"},style:{cursor:"pointer"},events:{click:BX.delegate(function(e){this.runCreatingFile("xlsx");BX.PreventDefault(e)},this)}}),BX.create("a",{text:BX.message("DISK_FOLDER_TOOLBAR_MW_CREATE_TYPE_PPT"),props:{className:"bx-disk-create-file-big-icon bx-disk-create-file-big-pres"},style:{cursor:"pointer"},events:{click:BX.delegate(function(e){this.runCreatingFile("pptx");BX.PreventDefault(e)},this)}})]})]})};e.prototype.openMenuWithServices=function(e){var t=new BX.CViewer({});BX.PopupMenu.show("disk_open_menu_with_services",BX(e),[{text:BX.message("DISK_FOLDER_TOOLBAR_LABEL_LOCAL_BDISK_EDIT"),className:"bx-viewer-popup-item item-b24",href:"#",onclick:BX.delegate(function(e){if(BX.CViewer.isEnableLocalEditInDesktop()){this.setEditService("l");BX.adjust(BX("bx-disk-default-service-label"),{text:BX.message("DISK_FOLDER_TOOLBAR_LABEL_LOCAL_BDISK_EDIT")});BX.PopupMenu.destroy("disk_open_menu_with_services")}else{this.helpDiskDialog()}return BX.PreventDefault(e)},t)},{text:t.getNameEditService("google"),className:"bx-viewer-popup-item item-gdocs",href:"#",onclick:BX.delegate(function(e){this.setEditService("google");BX.adjust(BX("bx-disk-default-service-label"),{text:this.getNameEditService("google")});BX.PopupMenu.destroy("disk_open_menu_with_services");return BX.PreventDefault(e)},t)},{text:t.getNameEditService("office365"),className:"bx-viewer-popup-item item-office365",href:"#",onclick:BX.delegate(function(e){this.setEditService("office365");BX.adjust(BX("bx-disk-default-service-label"),{text:this.getNameEditService("office365")});BX.PopupMenu.destroy("disk_open_menu_with_services");return BX.PreventDefault(e)},t)},{text:t.getNameEditService("skydrive"),className:"bx-viewer-popup-item item-office",href:"#",onclick:BX.delegate(function(e){this.setEditService("skydrive");BX.adjust(BX("bx-disk-default-service-label"),{text:this.getNameEditService("skydrive")});BX.PopupMenu.destroy("disk_open_menu_with_services");return BX.PreventDefault(e)},t)}],{angle:{position:"top",offset:45},autoHide:true,overlay:{opacity:.01}})};e.prototype.blockFeatures=function(){BX.PopupWindowManager.create("bx-disk-business-tools-info",null,{content:BX("bx-bitrix24-business-tools-info"),closeIcon:true,onPopupClose:function(){this.destroy()},autoHide:true,zIndex:11e3}).show()};e.prototype.runCreatingFile=function(e){if(BX.message("disk_restriction")){this.blockFeatures();return}var t=new BX.CViewer({createDoc:true});var i=t.createBlankElementByParams({targetFolderId:this.targetFolderId,docType:e,editUrl:this.createBlankFileUrl,renameUrl:this.renameBlankFileUrl});t.setCurrent(i);i.afterSuccessCreate=function(e){if(e&&e.status=="success"){if(!BX.CViewer.isLocalEditService(t.initEditService())){window.document.location=BX.Disk.getUrlToShowObjectInGrid(e.objectId)}else{window.onbeforeunload=function(){if(!window.diskUnloadCreateDoc){window.diskUnloadCreateDoc=true;setTimeout(function(){window.document.location=BX.Disk.getUrlToShowObjectInGrid(e.objectId)},250)}}}}};t.runActionByCurrentElement("create",{obElementViewer:t});try{BX.PreventDefault()}catch(s){}return false};return e}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:97:"/bitrix/components/bitrix/disk.external.link.list/templates/.default/script.min.js?15113164847442";s:6:"source";s:78:"/bitrix/components/bitrix/disk.external.link.list/templates/.default/script.js";s:3:"min";s:82:"/bitrix/components/bitrix/disk.external.link.list/templates/.default/script.min.js";s:3:"map";s:82:"/bitrix/components/bitrix/disk.external.link.list/templates/.default/script.map.js";}"*/
BX.namespace("BX.Disk");BX.Disk.ExternalLinkListClass=function(){var e=function(e){this.grid=e.grid;this.gridGroupActionButton=BX(e.gridGroupActionButton);this.gridShowTreeButton=BX(e.gridShowTreeButton);this.rootObject=e.rootObject||{};this.checkboxes={};this.resetCheckboxes();this.ajaxUrl="/bitrix/components/bitrix/disk.external.link.list/ajax.php";this.grid.SetActionName("delete");this.setEvents()};e.prototype.resetCheckboxes=function(){var e=BX.findChildren(this.grid.tableNode,{tagName:"input",attr:{type:"checkbox"}},true);for(var t in e){if(!e.hasOwnProperty(t)){continue}var i=e[t];if(i.getAttribute("name")==="ID[]"){i.checked=false}}};e.prototype.setEvents=function(){BX.bind(BX("delete_button_"+this.grid.table_id),"click",BX.proxy(this.onClickDeleteGroup,this));BX.addCustomEvent("onSelectRow",BX.proxy(this.onSelectRow,this));BX.addCustomEvent("onUnSelectRow",BX.proxy(this.onUnSelectRow,this))};e.prototype.removeRow=function(e,t){this.grid.removeRow(e,t)};e.prototype.getRow=function(e){return this.grid.getRow(e)};e.prototype.getRowByCheckBox=function(e){return this.grid.getRowByCheckBox(e)};e.prototype.getCheckbox=function(e){return this.grid.getCheckbox(e)};e.prototype.disableExternalLink=function(e,t){BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(this.ajaxUrl,"action","disableExternalLink"),{id:"status-action",responseType:"json",postData:{externalId:e,objectId:t},afterSuccessLoad:BX.delegate(function(t){if(!t||t.status!="success"){BX.Disk.showModalWithStatusAction(t);return}this.removeRow(e,function(){BX.Disk.showModalWithStatusAction(t)})},this)});return false};e.prototype.onClickDeleteGroup=function(e){if(!this.grid.IsActionEnabled())return false;var t=document.getElementById("actallrows_"+this.grid.table_id);this.openConfirmDeleteGroup({attemptDeleteAll:t&&t.checked});BX.PreventDefault(e);return false};e.prototype.openConfirmDeleteGroup=function(e){var t=BX.message("DISK_EXTERNAL_LINK_LIST_DELETE_GROUP_CONFIRM");var i=[new BX.PopupWindowButton({text:BX.message("DISK_EXTERNAL_LINK_LIST_DELETE_BUTTON"),className:"popup-window-button-accept",events:{click:BX.delegate(function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);this.grid.ActionDelete();return false},this)}}),new BX.PopupWindowButton({text:BX.message("DISK_EXTERNAL_LINK_LIST_CANCEL_DELETE_BUTTON"),events:{click:function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);return false}}})];BX.Disk.modalWindow({modalId:"bx-link-unlink-confirm",title:BX.message("DISK_EXTERNAL_LINK_LIST_DELETE_TITLE"),contentClassName:"tac",contentStyle:{paddingTop:"70px",paddingBottom:"70px"},content:t,buttons:i})};e.prototype.showInfoPanelManyObject=function(e){var t="bx-file-icon-container-small bx-disk-file-icon";var i=[];i.push(BX.create("a",{text:BX.message("DISK_EXTERNAL_LINK_LIST_DELETE_BUTTON"),style:{width:"145px"},props:{className:"bx-disk-btn bx-disk-btn-medium bx-disk-btn-lightgray"},events:{click:BX.delegate(function(e){BX.fireEvent(BX("delete_button_"+this.grid.table_id),"click")},this)}}));this.showInfoPanel({buttons:i,isFolder:false,icon:{className:t},title:{text:BX.Disk.getNumericCase(e.length,BX.message("DISK_EXTERNAL_LINK_LIST_SELECTED_OBJECT_1"),BX.message("DISK_EXTERNAL_LINK_LIST_SELECTED_OBJECT_21"),BX.message("DISK_EXTERNAL_LINK_LIST_SELECTED_OBJECT_2_4"),BX.message("DISK_EXTERNAL_LINK_LIST_SELECTED_OBJECT_5_20")).replace("#COUNT#",e.length)}})};e.prototype.showInfoPanelSingleObject=function(e){this.currentObjectIdInInfoPanel=e;var t=[];var i="";var n=this.getRow(e);var o=BX.findChild(n,{tagName:"a",className:"bx-disk-folder-title"},true);var s="bx-file-icon-container-small bx-disk-file-icon";var a=BX.findChild(n,function(e){return BX.type.isElementNode(e)&&(BX.hasClass(e,"bx-disk-file-icon")||BX.hasClass(e,"bx-disk-folder-icon"))},true);if(a){s=a.className}if(!o){return}if(!n.oncontextmenu){return}var r=n.oncontextmenu();for(var c in r){if(!r.hasOwnProperty(c)){continue}var l=r[c];if(l&&l["PSEUDO_NAME"]){switch(l["PSEUDO_NAME"].toLowerCase()){case"download":if(t.length>0){t.push(BX.create("SPAN",{html:"&nbsp;"}))}t.push(BX.create("a",{attrs:{onclick:l["ONCLICK"]},text:l["TEXT"],style:{width:"145px"},props:{className:"bx-disk-btn bx-disk-btn-medium bx-disk-btn-green"}}));break;case"disable_external_link":if(t.length>0){t.push(BX.create("SPAN",{html:"&nbsp;"}))}t.push(BX.create("a",{attrs:{onclick:l["ONCLICK"]},text:l["SHORT_TEXT"],style:{width:"145px"},props:{className:"bx-disk-btn bx-disk-btn-medium bx-disk-btn-lightgray"}}));break}}}this.showInfoPanel({buttons:t,isFolder:BX.hasClass(a,"bx-disk-folder-icon"),icon:{className:s},objectId:e,title:{text:o.text,href:o.getAttribute("href"),date:o.getAttribute("data-bx-dateModify")}})};e.prototype.showInfoPanel=function(e){var t=e.title||{};var i=e.icon||{};var n=e.buttons||[];var o=e.internalLink||"";var s=e.isFolder;var a=e.objectId||null;if(!t){return}var r=BX("disk_info_panel");var c=BX("bx_disk_empty_select_section");if(c)BX.hide(c);BX.cleanNode(r);this.containerWithExtAndIntLinks=null;var l=BX.create("div");r.appendChild(l);l.appendChild(BX.create("div",{props:{className:"bx-disk-info-panel"},children:[BX.create("div",{props:{className:"bx-disk-info-panel-relative"},children:[BX.create("div",{props:{className:"bx-disk-info-panel-icon"},children:[BX.create("div",{props:{className:i.className}})]}),BX.create("div",{props:{className:"bx-disk-info-panel-element-name-container"},children:[BX.create("div",{props:{id:"disk_info_panel_name",className:"bx-disk-info-panel-name"},children:[BX.create("a",{text:t.text,props:{title:t.text,href:t.href||"javascript:void(0);"}})]}),BX.create("div",{text:t.date,props:{className:"bx-disk-info-panel-date"}})]}),BX.create("div",{props:{className:"bx-disk-info-panel-context"}})]}),BX.create("div",{props:{className:"tal"},children:n})]}));new BX.easing({duration:300,start:{opacity:0,height:0},finish:{opacity:100,height:l.offsetHeight},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(e){r.style.height=e.height+"px";r.style.opacity=e.opacity/100},complete:BX.delegate(function(){r.style.cssText=""},this)}).animate()};e.prototype.addCheckbox=function(e){var t=e.value;if(!this.checkboxes[t]){this.checkboxes[t]=true}};e.prototype.deleteCheckbox=function(e){var t=e.value;if(this.checkboxes[t]){this.checkboxes[t]=false}};e.prototype.onSelectRow=function(e,t,i){this.addCheckbox(i);if(t==1){this.showInfoPanelSingleObject(i.value)}else{var n=this.grid.GetCheckedCheckboxes();var o=[];for(var s in n){if(!n.hasOwnProperty(s)||n[s].name!="ID[]"){continue}o.push(n[s].value)}this.showInfoPanelManyObject(o)}};e.prototype.onUnSelectRow=function(e,t,i){this.deleteCheckbox(i);if(t==0){var n=i.value;var o=BX("disk_info_panel");var s=BX.firstChild(o);new BX.easing({duration:300,start:{opacity:100,height:s.offsetHeight},finish:{opacity:0,height:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(e){o.style.height=e.height+"px";o.style.opacity=e.opacity/10},complete:BX.delegate(function(){var e=BX("bx_disk_empty_select_section");if(e)BX.show(e,"block")},this)}).animate()}else{this.onSelectRow(e,t,this.getFirstSelectedCheckbox())}};e.prototype.getFirstSelectedCheckbox=function(){var e;for(e in this.checkboxes){if(this.checkboxes.hasOwnProperty(e)&&typeof e!=="function"&&this.checkboxes[e]==true){break}}return this.getCheckbox(e)};return e}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:90:"/bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.min.js?15113164843353";s:6:"source";s:71:"/bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.js";s:3:"min";s:75:"/bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.min.js";s:3:"map";s:75:"/bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.map.js";}"*/
BX.namespace("BX.Disk");BX.Disk.BreadcrumbsClass=function(){var t=function(t){this.containerId=t.containerId;this.collapsedCrumbs=t.collapsedCrumbs||[];this.showOnlyDeleted=t.showOnlyDeleted||0;this.container=BX(this.containerId);this.ajaxUrl="/bitrix/components/bitrix/disk.breadcrumbs/ajax.php";this.container.style.opacity=1;this.setEvents()};t.prototype.setEvents=function(){BX.bindDelegate(this.container,"click",{className:"icon-arrow"},BX.proxy(this.onClickArrow,this));BX.bind(BX("root_dots_"+this.containerId),"click",BX.proxy(this.onClickDots,this))};t.prototype.adjust=function(){var t=BX.findParent(this.container,{className:"bx-disk-interface-toolbar-container"},BX("workarea-content"));if(t){var e=BX.findChild(t,{className:"bx-disk-interface-sort"},true)}var i=this.container.offsetWidth;var a=t?t.offsetWidth:0;var r=e?e.offsetWidth:0;if(!a){return}var n=r+i;if(a>n){return}var o=BX.findChildren(this.container,{tagName:"span",className:"bx-disk-interface-bread-crumbs-item"},true);var s=o.shift();var d=o.pop();this.collapsedCrumbs=[];for(var c in o){if(r+this.container.offsetWidth-a<=0){break}if(!o.hasOwnProperty(c)){continue}var u=o[c];var l=BX.nextSibling(u);var h=0;if(BX.hasClass(l,"bx-disk-bread-crumbs-separator")){h=l.offsetWidth}else{l=null}this.collapsedCrumbs.push({text:u.getAttribute("data-objectName"),title:u.getAttribute("data-objectName"),href:u.getAttribute("data-objectParentPath")});BX.hide(u);l&&BX.hide(l)}if(r+this.container.offsetWidth-a>0){this.collapsedCrumbs.unshift({text:s.getAttribute("data-objectName"),title:s.getAttribute("data-objectName"),href:s.getAttribute("data-objectParentPath")});BX.hide(s)}BX("root_dots_"+this.containerId).style.display="inline-block";BX("root_arrow_"+this.containerId).style.display="none";BX.bind(BX("root_dots_"+this.containerId),"click",BX.proxy(this.onClickDots,this))};t.prototype.expand=function(t,e,i){var a=t.getAttribute("data-objectId");var r=t.getAttribute("data-objectParentPath");if(r=="/"){r=""}else if(r.lastIndexOf("/")==r.length-1){r=r.substr(0,r.length-1)}var n=[];for(var o in i){if(!i.hasOwnProperty(o)){continue}var s=i[o];n.push({text:s["name"],title:s["name"],href:r+"/"+encodeURIComponent(s["name"])+"/"})}BX.PopupMenu.show("disk_breadcrumbs_"+a,e,n,{autoHide:true,angle:{offset:0},events:{onPopupClose:function(){}}})};t.prototype.onClickDots=function(t){var e=t.srcElement||t.target;BX.PopupMenu.show("disk_breadcrumbs_dots",e,this.collapsedCrumbs,{autoHide:true,angle:{offset:0},events:{onPopupClose:function(){}}});BX.PreventDefault(t)};t.prototype.onClickArrow=function(t){var e=t.srcElement||t.target;var i=BX.findParent(e,{className:"bx-disk-interface-bread-crumbs-item-container"},this.container);var a=i.getAttribute("data-objectId");var r=i.getAttribute("data-isRoot");if(!a){BX.PreventDefault(t);return}var n=BX.PopupMenu.getMenuById("disk_breadcrumbs_"+a);if(n&&n.popupWindow){if(n.popupWindow.isShown()){BX.PopupMenu.destroy("disk_breadcrumbs_"+a)}else{n.popupWindow.show()}BX.PreventDefault(t);return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSubFolders"),data:{objectId:a,showOnlyDeleted:this.showOnlyDeleted?1:0,isRoot:r?1:0},onsuccess:BX.delegate(function(t){if(!t){return}this.expand(i,e,t.items)},this)});BX.PreventDefault(t)};return t}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:130:"/bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.min.js?151131648433670";s:6:"source";s:110:"/bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.js";s:3:"min";s:114:"/bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.min.js";s:3:"map";s:114:"/bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.map.js";}"*/
function BxDiskInterfaceGrid(e){this.oActions={};this.oColsMeta={};this.oColsNames={};this.oEditData={};this.oSaveData={};this.oOptions={};this.oVisibleCols=null;this.vars={};this.menu=null;this.settingsMenu=[];this.filterMenu=[];this.checkBoxCount=0;this.bColsChanged=false;this.bViewsChanged=false;this.oFilterRows={};this.activeRow=null;var t=this;this.table_id=e;this.tableNode=BX(this.table_id);this.InitTable=function(){var e=document.getElementById(this.table_id);if(!e||e.rows.length<1||e.rows[0].cells.length<1)return;var i;var s=e.rows[0].cells.length;for(i=0;i<s;i++){var a;for(a=0;a<2;a++){var n=e.rows[a].cells[i];n.onmouseover=function(){t.HighlightGutter(this,true)};n.onmouseout=function(){t.HighlightGutter(this,false)};if(a==1){if(n.className&&(n.className=="bx-disk-actions-col"||n.className=="bx-disk-checkbox-col"))continue;if(this.vars.user_authorized){n.onbxdragstart=t.DragStart;n.onbxdragstop=t.DragStop;n.onbxdrag=t.Drag;n.onbxdraghout=function(){t.HighlightGutter(this,false)};jsDD.registerObject(n);n.onbxdestdraghover=t.DragHover;n.onbxdestdraghout=t.DragOut;n.onbxdestdragfinish=t.DragFinish;jsDD.registerDest(n)}}}}var l=e.rows.length;for(i=0;i<l;i++){var r=e.rows[i];if(r.className&&r.className=="bx-disk-grid-footer")continue;r.cells[0].className+=" bx-disk-left";r.cells[r.cells.length-1].className+=" bx-disk-right";if(i>=2){var o=r.cells[0].childNodes[0];if(o&&o.tagName&&o.tagName.toUpperCase()=="INPUT"&&o.type.toUpperCase()=="CHECKBOX"){o.onclick=function(){t.SelectRow(this);t.EnableActions()};BX.bind(r,"click",t.OnClickRow);this.checkBoxCount++}}if(r.oncontextmenu)BX.bind(r,"contextmenu",this.OnRowContext)}if(e.rows.length>2){e.rows[2].className+=" bx-top";var c=e.rows[e.rows.length-1];if(c.className&&c.className=="bx-disk-grid-footer")c=e.rows[e.rows.length-2];c.className+=" bx-disk-bottom"}};this.OnRowContext=function(e){if(!t.menu)return;if(!e)e=window.event;if(!phpVars.opt_context_ctrl&&e.ctrlKey||phpVars.opt_context_ctrl&&!e.ctrlKey)return;var i;if(e.target)i=e.target;else if(e.srcElement)i=e.srcElement;var s=i;while(s&&!(s.tagName&&s.tagName.toUpperCase()=="TD"&&s.oncontextmenu))s=BX.findParent(s,{tag:"td"});var a=null;if(s&&s.oncontextmenu){a=s.oncontextmenu();a[a.length]={SEPARATOR:true}}s=i;while(s&&!(s.tagName&&s.tagName.toUpperCase()=="TR"&&s.oncontextmenu))s=BX.findParent(s,{tag:"tr"});if(s.tagName.toUpperCase()=="TR"){t.showNewPopupMenu(e,BX.util.array_merge(a,s.oncontextmenu()));e.returnValue=false;if(e.preventDefault)e.preventDefault();return}var n=t.menu;n.PopupHide();t.activeRow=s;if(t.activeRow)t.activeRow.className+=" bx-active";n.OnClose=function(){if(t.activeRow){t.activeRow.className=t.activeRow.className.replace(/\s*bx-active/i,"");t.activeRow=null}t.SaveColumns()};var l=BX.util.array_merge(a,s.oncontextmenu());if(l.length==0)return;n.SetItems(l);n.BuildItems();var r=BX.GetWindowScrollPos();var o=e.clientX+r.scrollLeft;var c=e.clientY+r.scrollTop;var h={};h["left"]=h["right"]=o;h["top"]=h["bottom"]=c;n.PopupShow(h);e.returnValue=false;if(e.preventDefault)e.preventDefault()};this.showNewPopupMenu=function(e,t){var i=[];for(var s in t){if(!t.hasOwnProperty(s)){continue}if(t[s].hasOwnProperty("SHOW")&&t[s]["SHOW"]==false){continue}if(BX.type.isArray(t[s]["MENU"])){i.push({onclick:function(e,t){var i=t.submenu;var s=[];for(var t in i){if(!i.hasOwnProperty(t)){continue}s.push({onclick:i[t]["ONCLICK"],text:i[t]["TEXT"]})}BX.PopupMenu.show("action_bizproc",e,s,{autoHide:true,closeByEsc:true,events:{onPopupClose:function(){BX.PopupMenu.destroy("action_bizproc")}}})},submenu:t[s]["MENU"],text:t[s]["TEXT"]})}else{i.push({onclick:t[s]["ONCLICK"],text:t[s]["TEXT"]})}}BX.PopupMenu.show("grid_action_pm",e,i,{autoHide:true,closeByEsc:true,events:{onAfterPopupShow:function(e){BX.bindDelegate(BX("popup-window-content-menu-popup-grid_action_pm"),"click",{className:"menu-popup-item"},function(t){e.close()})},onPopupClose:function(){BX.PopupMenu.destroy("grid_action_pm")}}})};this.ShowActionMenu=function(e,i){t.menu.PopupHide();t.activeRow=BX.findParent(e,{tag:"tr"});if(t.activeRow)t.activeRow.className+=" bx-active";this.showNewPopupMenu(e,t.oActions[i]);return};this.HighlightGutter=function(e,t){var i=e.parentNode.parentNode.parentNode;var s=i.rows[0].cells[e.cellIndex];var a=s.className.indexOf("bx-disk-sorted")!=-1;if(t){if(a){s.className+=" bx-over-sorted";e.className+=" bx-over-sorted"}else{s.className+=" bx-over";e.className+=" bx-over"}}else{if(a){s.className=s.className.replace(/\s*bx-over-sorted/i,"");e.className=e.className.replace(/\s*bx-over-sorted/i,"")}else{s.className=s.className.replace(/\s*bx-over/i,"");e.className=e.className.replace(/\s*bx-over/i,"")}}};this.HighlightRow=function(e,t){if(t)e.className+=" bx-over";else e.className=e.className.replace(/\s*bx-over/i,"")};this.SelectRow=function(e){var t=e.parentNode.parentNode;var i=t.parentNode.parentNode;var s=document.getElementById(i.id+"_selected_span");var a=parseInt(s.innerHTML);if(e.checked){t.className+=" bx-selected selected";a++}else{t.className=t.className.replace(/\s*bx-selected/gi,"");t.className=t.className.replace(/\s*selected/gi,"");a--}s.innerHTML=a.toString();var n=document.getElementById(i.id+"_check_all");if(a==this.checkBoxCount)n.checked=true;else n.checked=false;if(e.checked){BX.onCustomEvent("onSelectRow",[this,a,e])}else{BX.onCustomEvent("onUnSelectRow",[this,a,e])}};this.OnClickRow=function(e){if(!e)e=window.event;var i=e.target?e.target:e.srcElement?e.srcElement:null;if(!i)return;if(!i.parentNode.cells)return;var s=i.parentNode.cells[0].childNodes[0];if(s&&s.tagName&&s.tagName.toUpperCase()=="INPUT"&&s.type.toUpperCase()=="CHECKBOX"&&!s.disabled){s.checked=!s.checked;t.SelectRow(s)}else{var a=BX.findParent(i,{tagName:"tr",className:"bx-disk-table-body"},this.tableNode);if(a){var n=BX.findChild(a,{tagName:"td",className:"bx-disk-checkbox-col"});if(n){s=BX.findChild(n,{tagName:"input",property:{type:"checkbox"}});if(s){s.checked=!s.checked;t.SelectRow(s)}}}}t.EnableActions()};this.SelectAllRows=function(e){var t=document.getElementById(this.table_id);var i=e.checked;var s;var a=t.rows.length;for(s=2;s<a;s++){var n=t.rows[s].cells[0].childNodes[0];if(n&&n.tagName&&n.tagName.toUpperCase()=="INPUT"&&n.type.toUpperCase()=="CHECKBOX"){if(n.checked!=i&&!n.disabled){n.checked=i;this.SelectRow(n)}}}this.EnableActions()};this.EnableActions=function(){var e=document.forms["form_"+this.table_id];if(!e)return;var t=this.IsActionEnabled();var i=this.IsActionEnabled("edit");if(e.apply)e.apply.disabled=!t;var s=document.getElementById("edit_button_"+this.table_id);s=document.getElementById("delete_button_"+this.table_id)};this.IsActionEnabled=function(e){var t=document.forms["form_"+this.table_id];if(!t)return;var i=false;var s=document.getElementById(this.table_id+"_selected_span");if(s&&parseInt(s.innerHTML)>0)i=true;var a=t["action_all_rows_"+this.table_id];if(e=="edit")return!(a&&a.checked)&&i;else return a&&a.checked||i};this.SwitchActionButtons=function(e){var t=document.getElementById("bx_grid_"+this.table_id+"_action_buttons");var i=t;while(i=BX.findNextSibling(i,{tag:"td"}))i.style.display=e?"none":"";t.style.display=e?"":"none";if(e&&window.jsDD){window.jsDD.Disable()}else{window.jsDD.Enable()}};this.getSwitchActionButtonsContainer=function(){return BX("bx_grid_"+this.table_id+"_action_buttons")};this.ActionEdit=function(e){if(this.IsActionEnabled("edit")){var t=document.forms["form_"+this.table_id];if(!t)return;this.SwitchActionButtons(true);var i=t["ID[]"];if(!i.length)i=new Array(i);for(var s=0;s<i.length;s++){var a=i[s];if(a.checked){var n=BX.findParent(a,{tag:"tr"});BX.denyEvent(n,"dblclick");var l=BX.findParent(a,{tag:"td"});l=BX.findNextSibling(l,{tag:"td"});if(l.className=="bx-disk-actions-col")l=BX.findNextSibling(l,{tag:"td"});var r=a.value;this.oSaveData[r]={};for(var o in this.oColsMeta){if(this.oColsMeta[o].editable==true&&this.oEditData[r][o]!==false){this.oSaveData[r][o]=l.innerHTML;l.innerHTML="";var c=this.oEditData[r][o];var h="FIELDS["+r+"]["+o+"]";switch(this.oColsMeta[o].type){case"checkbox":l.appendChild(BX.create("INPUT",{props:{type:"hidden",name:h,value:"N"}}));l.appendChild(BX.create("INPUT",{props:{type:"checkbox",name:h,value:"Y",checked:c=="Y",defaultChecked:c=="Y"}}));break;case"list":var d=[];for(var f in this.oColsMeta[o].items){d[d.length]=BX.create("OPTION",{props:{value:f,selected:f==c},text:this.oColsMeta[o].items[f]})}l.appendChild(BX.create("SELECT",{props:{name:h},children:d}));break;case"date":var u=BX.create("SPAN",{style:{whiteSpace:"nowrap"}});u.appendChild(BX.create("INPUT",{props:{type:"text",name:h,value:c,size:this.oColsMeta[o].size?this.oColsMeta[o].size:10}}));u.appendChild(BX.create("A",{props:{href:"javascript:void(0);",title:this.vars.mess.calend_title},html:'<img src="'+this.vars.calendar_image+'" alt="'+this.vars.mess.calend_title+'" class="calendar-icon" onclick="BX.calendar({node:this, field:\''+h+"', bTime: true, currentTime: '"+this.vars.server_time+'\'});" onmouseover="this.className+=\' calendar-icon-hover\';" onmouseout="this.className = this.className.replace(/s*calendar-icon-hover/ig, \'\');" border="0"/>'}));l.appendChild(u);break;default:var v={className:"bx-disk-folder-title list",type:"text",name:h,value:c,size:this.oColsMeta[o].size?this.oColsMeta[o].size:15};if(this.oColsMeta[o].maxlength)v.maxLength=this.oColsMeta[o].maxlength;l.appendChild(BX.create("INPUT",{props:v}));break}}l=BX.findNextSibling(l,{tag:"td"})}}a.disabled=true}t.elements["action_button_"+this.table_id].value="edit"}};this.ActionCancel=function(){var e=document.forms["form_"+this.table_id];if(!e)return;this.SwitchActionButtons(false);var t=e["ID[]"];if(!t.length)t=new Array(t);for(var i=0;i<t.length;i++){var s=t[i];if(s.checked){var a=BX.findParent(s,{tag:"tr"});BX.allowEvent(a,"dblclick");var n=BX.findParent(s,{tag:"td"});n=BX.findNextSibling(n,{tag:"td"});if(n.className=="bx-disk-actions-col")n=BX.findNextSibling(n,{tag:"td"});var l=s.value;for(var r in this.oColsMeta){if(this.oColsMeta[r].editable==true&&this.oEditData[l][r]!==false)n.innerHTML=this.oSaveData[l][r];n=BX.findNextSibling(n,{tag:"td"})}}s.disabled=false}e.elements["action_button_"+this.table_id].value=""};this.ActionDelete=function(){var e=document.forms["form_"+this.table_id];if(!e)return;e.elements["action_button_"+this.table_id].value="delete";BX.submit(e)};this.SetActionName=function(e){var t=this.GetForm();if(!t)return;t.elements["action_button_"+this.table_id].value=e};this.GetForm=function(){return document.forms["form_"+this.table_id]};this.GetCheckedCheckboxes=function(){var e=[];for(var t=0,i=this.GetForm().elements.length;t<i;t++){var s=this.GetForm().elements[t];if(s.type.toLowerCase()=="checkbox"&&s.checked){e.push(s)}}return e};this.ActionCustom=function(e){this.SetActionName(e);BX.submit(form)};this.DeleteItem=function(e,t){var i=document.getElementById("ID_"+e);if(i){if(confirm(t)){var s=document.forms["form_"+this.table_id];if(!s)return;var a=s["ID[]"];if(!a.length)a=new Array(a);for(var n=0;n<a.length;n++){a[n].checked=false}i.checked=true;this.ActionDelete()}}};this.ForAllClick=function(e){if(e.checked&&!confirm(this.vars.mess.for_all_confirm)){e.checked=false;return}var t=e.form["ID[]"];if(t){if(!t.length)t=new Array(t);for(var i=0;i<t.length;i++)t[i].disabled=e.checked}this.EnableActions()};this.Sort=function(e,t,i,s){if(t==""){var a=null,n=false;if(s.length>0)a=s[0];if(!a)a=window.event;if(a)n=a.ctrlKey;e+=n?i=="acs"?"desc":"asc":i}else if(t=="asc")e+="desc";else e+="asc";this.Reload(e)};this.InitVisCols=function(){if(this.oVisibleCols==null){this.oVisibleCols={};for(var e in this.oColsMeta)this.oVisibleCols[e]=true}};this.CheckColumn=function(e,t){var i=this.menu.GetMenuByItemId(t.id);var s=!(i.GetItemInfo(t).ICON=="checked");i.SetItemIcon(t,s?"checked":"");this.InitVisCols();this.oVisibleCols[e]=s;this.bColsChanged=true};this.HideColumn=function(e){this.InitVisCols();this.oVisibleCols[e]=false;this.bColsChanged=true;this.SaveColumns()};this.ApplySaveColumns=function(){this.menu.PopupHide();this.SaveColumns()};this.SaveColumns=function(e){var i="";if(e){i=e}else{if(!t.bColsChanged)return;for(var s in t.oVisibleCols)if(t.oVisibleCols[s])i+=(i!=""?",":"")+s}BX.ajax.get("/bitrix/components"+t.vars.component_path+"/settings.php?GRID_ID="+t.table_id+"&action=showcolumns&columns="+i+"&sessid="+t.vars.sessid,function(){t.Reload()})};this.Reload=function(e){jsDD.Disable();if(!e){e=this.vars.current_url}if(this.vars.ajax.AJAX_ID!=""){BX.ajax.insertToNode(e+(e.indexOf("?")==-1?"?":"&")+"bxajaxid="+this.vars.ajax.AJAX_ID,"comp_"+this.vars.ajax.AJAX_ID)}else{window.location=e}};this.SetTheme=function(e,i){BX.loadCSS(this.vars.template_path+"/themes/"+i+"/style.css");BX(t.table_id).className="bx-disk-interface-grid bx-disk-interface-grid-theme-"+i;var s=this.menu.GetMenuByItemId(e.id);s.SetAllItemsIcon("");s.SetItemIcon(e,"checked");BX.ajax.get("/bitrix/components"+t.vars.component_path+"/settings.php?GRID_ID="+t.table_id+"&action=settheme&theme="+i+"&sessid="+t.vars.sessid)};this.SetView=function(e){var i=t.oOptions.views[e].saved_filter;var s=i&&t.oOptions.filters[i]?function(){t.ApplyFilter(i)}:function(){t.Reload()};BX.ajax.get("/bitrix/components"+t.vars.component_path+"/settings.php?GRID_ID="+t.table_id+"&action=setview&view_id="+e+"&sessid="+t.vars.sessid,s)};this.EditCurrentView=function(){this.ShowSettings(this.oOptions.views[this.oOptions.current_view],function(){t.SaveSettings(t.oOptions.current_view,true)})};this.AddView=function(){var e="view_"+Math.round(Math.random()*1e6);var i={};for(var s in this.oOptions.views[this.oOptions.current_view])i[s]=this.oOptions.views[this.oOptions.current_view][s];i.name=this.vars.mess.viewsNewView;this.ShowSettings(i,function(){var i=t.SaveSettings(e);t.oOptions.views[e]={name:i.name,columns:i.columns,sort_by:i.sort_by,sort_order:i.sort_order,page_size:i.page_size,saved_filter:i.saved_filter};t.bViewsChanged=true;var s=document["views_"+t.table_id];s.views_list.options[s.views_list.length]=new Option(i.name!=""?i.name:t.vars.mess.viewsNoName,e,true,true)})};this.EditView=function(e){this.ShowSettings(this.oOptions.views[e],function(){var i=t.SaveSettings(e);t.oOptions.views[e]={name:i.name,columns:i.columns,sort_by:i.sort_by,sort_order:i.sort_order,page_size:i.page_size,saved_filter:i.saved_filter};t.bViewsChanged=true;var s=document["views_"+t.table_id];s.views_list.options[s.views_list.selectedIndex].text=i.name!=""?i.name:t.vars.mess.viewsNoName})};this.DeleteView=function(e){if(!confirm(this.vars.mess.viewsDelete))return;var i=document["views_"+this.table_id];var s=i.views_list.selectedIndex;i.views_list.remove(s);i.views_list.selectedIndex=s<i.views_list.length?s:i.views_list.length-1;this.bViewsChanged=true;BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?GRID_ID="+this.table_id+"&action=delview&view_id="+e+"&sessid="+t.vars.sessid)};this.ShowSettings=function(e,t){var i=false;if(!window["settingsDialog"+this.table_id]){window["settingsDialog"+this.table_id]=new BX.CDialog({content:'<form name="settings_'+this.table_id+'"></form>',title:this.vars.mess.settingsTitle,width:this.vars.settingWndSize.width,height:this.vars.settingWndSize.height,resize_id:"InterfaceGridSettingWnd"});i=true}window["settingsDialog"+this.table_id].ClearButtons();window["settingsDialog"+this.table_id].SetButtons([{title:this.vars.mess.settingsSave,action:function(){t();this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]);window["settingsDialog"+this.table_id].Show();var s=document["settings_"+this.table_id];if(i)s.appendChild(BX("view_settings_"+this.table_id));s.view_name.focus();s.view_name.value=e.name;var a=[];if(e.columns!=""){a=e.columns.split(",")}else{for(var n in this.oColsMeta)a[a.length]=n}var l={},r;for(n=0,r=a.length;n<r;n++)l[a[n]]=true;jsSelectUtils.deleteAllOptions(s.view_all_cols);for(n in this.oColsNames)if(!l[n])s.view_all_cols.options[s.view_all_cols.length]=new Option(this.oColsNames[n],n,false,false);jsSelectUtils.deleteAllOptions(s.view_cols);for(n in l)s.view_cols.options[s.view_cols.length]=new Option(this.oColsNames[n],n,false,false);jsSelectUtils.selectOption(s.view_sort_by,e.sort_by);jsSelectUtils.selectOption(s.view_sort_order,e.sort_order);jsSelectUtils.selectOption(s.view_page_size,e.page_size);jsSelectUtils.deleteAllOptions(s.view_filters);s.view_filters.options[0]=new Option(this.vars.mess.viewsFilter,"");for(n in this.oOptions.filters)s.view_filters.options[s.view_filters.length]=new Option(this.oOptions.filters[n].name,n,n==e.saved_filter,n==e.saved_filter);if(s.set_default_settings){s.set_default_settings.checked=false;s.delete_users_settings.disabled=true}};this.SaveSettings=function(e,i){var s=document["settings_"+this.table_id];var a="";var n=s.view_cols.length;for(var l=0;l<n;l++)a+=(a!=""?",":"")+s.view_cols[l].value;var r={GRID_ID:this.table_id,view_id:e,action:"savesettings",sessid:this.vars.sessid,name:s.view_name.value,columns:a,sort_by:s.view_sort_by.value,sort_order:s.view_sort_order.value,page_size:s.view_page_size.value,saved_filter:s.view_filters.value};if(s.set_default_settings){r.set_default_settings=s.set_default_settings.checked?"Y":"N";r.delete_users_settings=s.delete_users_settings.checked?"Y":"N"}var o=null;if(i===true){o=function(){if(r.saved_filter&&t.oOptions.filters[r.saved_filter]){t.ApplyFilter(r.saved_filter)}else{t.Reload()}}}BX.ajax.post("/bitrix/components"+t.vars.component_path+"/settings.php",r,o);return r};this.ReloadViews=function(){if(t.bViewsChanged)t.Reload()};this.ShowViews=function(){this.bViewsChanged=false;var e=false;if(!window["viewsDialog"+this.table_id]){var i=new BX.CWindowButton({title:this.vars.mess.viewsApply,hint:this.vars.mess.viewsApplyTitle,action:function(){var e=document["views_"+t.table_id];if(e.views_list.selectedIndex!=-1)t.SetView(e.views_list.value);window["bxGrid_"+t.table_id].bViewsChanged=false;this.parentWindow.Close()}});window["viewsDialog"+this.table_id]=new BX.CDialog({content:'<form name="views_'+this.table_id+'"></form>',title:this.vars.mess.viewsTitle,buttons:[i,BX.CDialog.prototype.btnClose],width:this.vars.viewsWndSize.width,height:this.vars.viewsWndSize.height,resize_id:"InterfaceGridViewsWnd"});BX.addCustomEvent(window["viewsDialog"+this.table_id],"onWindowUnRegister",this.ReloadViews);e=true}window["viewsDialog"+this.table_id].Show();var s=document["views_"+this.table_id];if(e)s.appendChild(BX("views_list_"+this.table_id))};this.DragStart=function(){var e=document.body.appendChild(document.createElement("DIV"));e.style.position="absolute";e.style.zIndex=10;e.className="bx-drag-object";e.innerHTML=this.innerHTML;e.style.width=this.clientWidth+"px";this.__dragCopyDiv=e;this.className+=" bx-drag-source";var t=document.body.appendChild(document.createElement("DIV"));t.style.position="absolute";t.style.zIndex=20;t.className="bx-drag-arrow";this.__dragArrowDiv=t;return true};this.Drag=function(e,t){var i=this.__dragCopyDiv;i.style.left=e+"px";i.style.top=t+"px";return true};this.DragStop=function(){this.className=this.className.replace(/\s*bx-grid-drag-source/gi,"");this.__dragCopyDiv.parentNode.removeChild(this.__dragCopyDiv);this.__dragCopyDiv=null;this.__dragArrowDiv.parentNode.removeChild(this.__dragArrowDiv);this.__dragArrowDiv=null;return true};this.DragHover=function(e,i,s){if(BX.hasClass(e,"draggable")){return}t.HighlightGutter(this,true);this.className+=" bx-drag-over";var a=e.__dragArrowDiv;var n=BX.pos(this);if(typeof e.cellIndex=="undefined"){return}if(this.cellIndex<=e.cellIndex)a.style.left=n["left"]-6+"px";else a.style.left=n["right"]-6+"px";a.style.top=n["top"]-12+"px";return true};this.DragOut=function(e,i,s){if(BX.hasClass(e,"draggable")){return}if(typeof e.cellIndex=="undefined"){return}t.HighlightGutter(this,false);this.className=this.className.replace(/\s*bx-drag-over/gi,"");var a=e.__dragArrowDiv;a.style.left="-1000px";return true};this.DragFinish=function(e,i,s,a){if(e.tagName.toUpperCase()!="TD")return false;t.HighlightGutter(this,false);this.className=this.className.replace(/\s*bx-drag-over/gi,"");if(this==e)return true;var n=BX(t.table_id);var l=0;for(var r=0;r<2;r++){var o=n.rows[1].cells[r];if(o.className&&(o.className.indexOf("bx-disk-actions-col")!=-1||o.className.indexOf("bx-disk-checkbox-col")!=-1))l++}var c=[];for(var h in t.oColsMeta)c[c.length]=h;var d=e.cellIndex-l;var f=this.cellIndex-l;var u=c[d];if(f<d){for(r=d;r>f;r--)c[r]=c[r-1]}else{for(r=d;r<f;r++)c[r]=c[r+1]}c[f]=u;var v="";for(r=0;r<c.length;r++)v+=(v!=""?",":"")+c[r];t.SaveColumns(v);return true};this.InitFilter=function(){var e=BX("flt_header_"+this.table_id);if(e)BX.bind(e,"contextmenu",this.OnRowContext)};this.SwitchFilterRow=function(e,t){if(t){var i=this.menu.GetMenuByItemId(t.id);i.SetItemIcon(t,this.oFilterRows[e]?"":"checked")}else{var s=this.filterMenu[0].MENU;for(var a=0;a<s.length;a++){if(s[a].ID=="flt_"+this.table_id+"_"+e){s[a].ICONCLASS=this.oFilterRows[e]?"":"checked";break}}}var n=BX("flt_row_"+this.table_id+"_"+e);n.style.display=this.oFilterRows[e]?"none":"";this.oFilterRows[e]=this.oFilterRows[e]?false:true;var l=BX("a_minmax_"+this.table_id);if(l&&l.className.indexOf("bx-filter-max")!=-1)this.SwitchFilter(l);this.SaveFilterRows()};this.SwitchFilterRows=function(e){this.menu.PopupHide();var t=0;for(var i in this.oFilterRows){t++;if(t==1&&e==false)continue;this.oFilterRows[i]=e;var s=BX("flt_row_"+this.table_id+"_"+i);s.style.display=e?"":"none"}var a=this.filterMenu[0].MENU;for(t=0;t<a.length;t++){if(t==0&&e==false)continue;if(a[t].SEPARATOR==true)break;a[t].ICONCLASS=e?"checked":""}var n=BX("a_minmax_"+this.table_id);if(n&&n.className.indexOf("bx-filter-max")!=-1)this.SwitchFilter(n);this.SaveFilterRows()};this.SaveFilterRows=function(){var e="";for(var t in this.oFilterRows)if(this.oFilterRows[t])e+=(e!=""?",":"")+t;BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?GRID_ID="+this.table_id+"&action=filterrows&rows="+e+"&sessid="+this.vars.sessid)};this.SwitchFilter=function(e){var t=e.className.indexOf("bx-filter-min")!=-1;e.className=t?"bx-filter-btn bx-filter-max":"bx-filter-btn bx-filter-min";e.title=t?this.vars.mess.filterShow:this.vars.mess.filterHide;var i=BX("flt_content_"+this.table_id);i.style.display=t?"none":"";BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?GRID_ID="+this.table_id+"&action=filterswitch&show="+(t?"N":"Y")+"&sessid="+this.vars.sessid)};this.ClearFilter=function(e){for(var t=0,i=e.elements.length;t<i;t++){var s=e.elements[t];switch(s.type.toLowerCase()){case"text":case"textarea":s.value="";break;case"select-one":s.selectedIndex=0;break;case"select-multiple":for(var a=0,n=s.options.length;a<n;a++)s.options[a].selected=false;break;case"checkbox":s.checked=false;break;default:break}if(s.onchange)s.onchange()}BX.onCustomEvent(e,"onGridClearFilter",[]);e.clear_filter.value="Y";BX.submit(e)};this.ShowFilters=function(){var e=false;if(!window["filtersDialog"+this.table_id]){var i=new BX.CWindowButton({title:this.vars.mess.filtersApply,hint:this.vars.mess.filtersApplyTitle,action:function(){var e=document["filters_"+t.table_id];if(e.filters_list.value)t.ApplyFilter(e.filters_list.value);this.parentWindow.Close()}});window["filtersDialog"+this.table_id]=new BX.CDialog({content:'<form name="filters_'+this.table_id+'"></form>',title:this.vars.mess.filtersTitle,buttons:[i,BX.CDialog.prototype.btnClose],width:this.vars.filtersWndSize.width,height:this.vars.filtersWndSize.height,resize_id:"InterfaceGridFiltersWnd"});e=true}window["filtersDialog"+this.table_id].Show();var s=document["filters_"+this.table_id];if(e)s.appendChild(BX("filters_list_"+this.table_id))};this.AddFilter=function(e){if(!e)e={};var i="filter_"+Math.round(Math.random()*1e6);var s={name:this.vars.mess.filtersNew,fields:e};this.ShowFilterSettings(s,function(){var e=t.SaveFilter(i);t.oOptions.filters[i]={name:e.name,fields:e.fields};var s=document["filters_"+t.table_id];s.filters_list.options[s.filters_list.length]=new Option(e.name!=""?e.name:t.vars.mess.viewsNoName,i,true,true);if(t.filterMenu.length==4)t.filterMenu=BX.util.insertIntoArray(t.filterMenu,1,{SEPARATOR:true});var a={ID:"mnu_"+t.table_id+"_"+i,TEXT:BX.util.htmlspecialchars(e.name),TITLE:t.vars.mess.ApplyTitle,ONCLICK:"bxGrid_"+t.table_id+".ApplyFilter('"+i+"')"};t.filterMenu=BX.util.insertIntoArray(t.filterMenu,2,a)})};this.AddFilterAs=function(){var e=document.forms["filter_"+this.table_id];var t=this.GetFilterFields(e);this.ShowFilters();this.AddFilter(t)};this.EditFilter=function(e){this.ShowFilterSettings(this.oOptions.filters[e],function(){var i=t.SaveFilter(e);t.oOptions.filters[e]={name:i.name,fields:i.fields};var s=document["filters_"+t.table_id];s.filters_list.options[s.filters_list.selectedIndex].text=i.name!=""?i.name:t.vars.mess.viewsNoName;for(var a=0,n=t.filterMenu.length;a<n;a++){if(t.filterMenu[a].ID&&t.filterMenu[a].ID=="mnu_"+t.table_id+"_"+e){t.filterMenu[a].TEXT=BX.util.htmlspecialchars(i.name);break}}})};this.DeleteFilter=function(e){if(!confirm(this.vars.mess.filtersDelete))return;var i=document["filters_"+this.table_id];var s=i.filters_list.selectedIndex;i.filters_list.remove(s);i.filters_list.selectedIndex=s<i.filters_list.length?s:i.filters_list.length-1;for(var a=0,n=this.filterMenu.length;a<n;a++){if(t.filterMenu[a].ID&&t.filterMenu[a].ID=="mnu_"+t.table_id+"_"+e){this.filterMenu=BX.util.deleteFromArray(this.filterMenu,a);if(this.filterMenu.length==5)this.filterMenu=BX.util.deleteFromArray(this.filterMenu,1);break}}delete this.oOptions.filters[e];BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?GRID_ID="+this.table_id+"&action=delfilter&filter_id="+e+"&sessid="+t.vars.sessid)};this.ShowFilterSettings=function(e,t){var i=false;if(!window["filterSettingsDialog"+this.table_id]){window["filterSettingsDialog"+this.table_id]=new BX.CDialog({content:'<form name="flt_settings_'+this.table_id+'"></form>',title:this.vars.mess.filterSettingsTitle,width:this.vars.filterSettingWndSize.width,height:this.vars.filterSettingWndSize.height,resize_id:"InterfaceGridFilterSettingWnd"});i=true}window["filterSettingsDialog"+this.table_id].ClearButtons();window["filterSettingsDialog"+this.table_id].SetButtons([{title:this.vars.mess.settingsSave,action:function(){t();this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]);window["filterSettingsDialog"+this.table_id].Show();var s=document["flt_settings_"+this.table_id];if(i)s.appendChild(BX("filter_settings_"+this.table_id));s.filter_name.focus();s.filter_name.value=e.name;this.SetFilterFields(s,e.fields)};this.SetFilterFields=function(e,t){for(var i=0,s=e.elements.length;i<s;i++){var a=e.elements[i];if(a.name=="filter_name")continue;var n=t[a.name]||"";switch(a.type.toLowerCase()){case"select-one":case"text":case"textarea":a.value=n;break;case"radio":case"checkbox":a.checked=a.value==n;break;case"select-multiple":var l=a.name.substr(0,a.name.length-2);var r=false;for(var o=0,c=a.options.length;o<c;o++){var h=t[l]?t[l]["sel"+a.options[o].value]:null;a.options[o].selected=a.options[o].value==h;if(a.options[o].value==h)r=true}if(!r&&a.options.length>0&&a.options[0].value=="")a.options[0].selected=true;break;default:break}if(a.onchange)a.onchange()}};this.GetFilterFields=function(e){var t={};for(var i=0,s=e.elements.length;i<s;i++){var a=e.elements[i];if(a.name=="filter_name")continue;switch(a.type.toLowerCase()){case"select-one":case"text":case"textarea":t[a.name]=a.value;break;case"radio":case"checkbox":if(a.checked)t[a.name]=a.value;break;case"select-multiple":var n=a.name.substr(0,a.name.length-2);t[n]={};for(var l=0,r=a.options.length;l<r;l++)if(a.options[l].selected)t[n]["sel"+a.options[l].value]=a.options[l].value;break;default:break}}return t};this.SaveFilter=function(e){var i=document["flt_settings_"+this.table_id];var s={GRID_ID:this.table_id,filter_id:e,action:"savefilter",sessid:this.vars.sessid,name:i.filter_name.value,fields:this.GetFilterFields(i)};BX.ajax.post("/bitrix/components"+t.vars.component_path+"/settings.php",s);return s};this.ApplyFilter=function(e){var t=document.forms["filter_"+this.table_id];this.SetFilterFields(t,this.oOptions.filters[e].fields);BX.submit(t)};this.OnDateChange=function(e){var t=false,i=false,s=false,a=false,n=false;if(e.value=="interval")n=t=i=s=true;else if(e.value=="before")i=true;else if(e.value=="after"||e.value=="exact")t=true;else if(e.value=="days")a=true;BX.findNextSibling(e,{tag:"span","class":"bx-filter-from"}).style.display=t?"":"none";BX.findNextSibling(e,{tag:"span","class":"bx-filter-to"}).style.display=i?"":"none";BX.findNextSibling(e,{tag:"span","class":"bx-filter-hellip"}).style.display=s?"":"none";BX.findNextSibling(e,{tag:"span","class":"bx-filter-days"}).style.display=a?"":"none";var l=BX.findNextSibling(e,{tag:"span","class":"bx-filter-br"});if(l)l.style.display=n?"":"none"};this.getRowByCheckBox=function(e){return e.parentNode.parentNode};this.removeRow=function(e,t){var i=this.getRow(e);new BX.easing({duration:600,start:{opacity:100,height:i.scrollHeight},finish:{opacity:0,height:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(e){i.style.height=e.height+"px";i.style.opacity=e.opacity/10},complete:BX.delegate(function(){var s=this.getCheckbox(e);if(s.checked){s.checked=false;this.SelectRow(s)}BX.remove(i);t&&t()},this)}).animate();var s=BX("bx-disk-total-grid-item");if(s){BX.adjust(s,{text:""+(parseInt(s.textContent||s.innerText,10)-1)})}};this.getRow=function(e){var t=this.getCheckbox(e);return this.getRowByCheckBox(t)};this.getCheckbox=function(e){return BX("ID_"+e)};this.getDeleteButton=function(){return BX("delete_button_"+this.table_id)}}function BxInterfaceTile(e){BxInterfaceTile.superclass.constructor.apply(this,arguments);this.isTile=true;this.tableNode=BX(this.table_id);this.tileNode=BX.findChild(this.tableNode,{tagName:"div",className:"bx-disk-interface-tile"},false,false);var t=this;this.InitTable=function(){var e=BX.findChildren(this.tileNode,{tagName:"div",className:"bx-disk-file-container"});e=e||[];for(var t=0;t<e.length;t++){var i=e[t];if(i.oncontextmenu){BX.bind(i,"contextmenu",this.OnRowContext)}}};this.SetActionName=function(e){};this.OnRowContext=function(e){if(!t.menu)return;if(!e)e=window.event;if(!phpVars.opt_context_ctrl&&e.ctrlKey||phpVars.opt_context_ctrl&&!e.ctrlKey)return;var i=e.target||e.srcElement;var s=i;if(!BX.hasClass(s,"bx-disk-file-container")){s=BX.findParent(i,{tagName:"div",className:"bx-disk-file-container"},this.tileNode)}var a=t.menu;a.PopupHide();var n=s.oncontextmenu();if(n.length==0)return;t.showNewPopupMenu(e,s.oncontextmenu());e.returnValue=false;if(e.preventDefault)e.preventDefault()};this.clickAndSelectRow=function(e,t){var i=t||window.event;if(i){var s=i.target||i.srcElement;if(s.tagName.toUpperCase()=="A"){return}}var a=this.getCheckbox(e);if(a&&a.tagName&&a.tagName.toUpperCase()=="INPUT"&&a.type.toUpperCase()=="CHECKBOX"&&!a.disabled){a.checked=!a.checked;this.SelectRow(a);this.EnableActions();BX.PreventDefault(i)}};this.SelectRow=function(e){var t=this.getRowByCheckBox(e);var i=document.getElementById(this.table_id+"_selected_span");var s=parseInt(i.innerHTML);if(e.checked){t.className+=" checked";BX.addClass(BX.firstChild(t),"selected");s++}else{t.className=t.className.replace(/\s*checked/gi,"");BX.removeClass(BX.firstChild(t),"selected");s--}i.innerHTML=s.toString();if(e.checked){BX.onCustomEvent("onSelectRow",[this,s,e])}else{BX.onCustomEvent("onUnSelectRow",[this,s,e])}};this.SelectAllRows=function(e){var t=BX.findChildren(this.tableNode,{tagName:"input",attribute:{type:"checkbox"}},true);if(t==null){return}for(var i=0;i<t.length;i++){var s=t[i];if(s.checked!=e&&!s.disabled){s.checked=e;this.SelectRow(s)}}this.EnableActions()};this.getRowByCheckBox=function(e){return e.parentNode.parentNode.parentNode};this.ActionEdit=function(e){if(this.IsActionEnabled("edit")){var t=document.forms["form_"+this.table_id];if(!t)return;this.SwitchActionButtons(true);var i=t["ID[]"];
if(!i.length)i=new Array(i);for(var s=0;s<i.length;s++){var a=i[s];if(a.checked){var n=this.getRowByCheckBox(a);var l=BX.findChild(n,{tagName:"a",className:"bx-disk-folder-title"},true);if(!l){continue}BX.denyEvent(l,"dblclick");BX.denyEvent(l,"click");var r=a.value;this.oSaveData[r]={};if(this.oColsMeta["NAME"].editable==true&&this.oEditData[r]["NAME"]!==false){this.oSaveData[r]["NAME"]=l.innerHTML;l.innerHTML="";var o=this.oEditData[r]["NAME"];var c="FIELDS["+r+"]["+"NAME"+"]";var h="id-FIELDS-"+r+"-"+"NAME"+"";if(BX(h)){continue}switch(this.oColsMeta["NAME"].type){default:var d={className:"bx-disk-folder-title",id:h,type:"text",name:c,value:o,size:this.oColsMeta["NAME"].size?this.oColsMeta["NAME"].size:15};if(this.oColsMeta["NAME"].maxlength)d.maxLength=this.oColsMeta["NAME"].maxlength;l.parentNode.appendChild(BX.create("INPUT",{props:d}));break}}}a.disabled=true}t.elements["action_button_"+this.table_id].value="edit"}};this.ActionCancel=function(){var e=document.forms["form_"+this.table_id];if(!e)return;this.SwitchActionButtons(false);var t=e["ID[]"];if(!t.length)t=new Array(t);for(var i=0;i<t.length;i++){var s=t[i];if(s.checked){var a=this.getRowByCheckBox(s);var n=BX.findChild(a,{tagName:"a",className:"bx-disk-folder-title"},true);if(!n){continue}BX.allowEvent(n,"dblclick");BX.allowEvent(n,"click");var l=s.value;if(this.oColsMeta["NAME"].editable==true&&this.oEditData[l]["NAME"]!==false){BX.adjust(n,{text:this.oSaveData[l]["NAME"]});var r="id-FIELDS-"+l+"-"+"NAME"+"";BX.remove(BX(r))}}s.disabled=false}e.elements["action_button_"+this.table_id].value=""}}BX.extend(BxInterfaceTile,BxDiskInterfaceGrid);
/* End */
;; /* /bitrix/components/bitrix/socialnetwork.admin.set/templates/.default/script.js?15113165822527*/
; /* /bitrix/components/bitrix/disk.folder.toolbar/templates/.default/script.min.js?15113164847121*/
; /* /bitrix/components/bitrix/disk.external.link.list/templates/.default/script.min.js?15113164847442*/
; /* /bitrix/components/bitrix/disk.breadcrumbs/templates/.default/script.min.js?15113164843353*/
; /* /bitrix/components/bitrix/disk.interface.grid/templates/.default/bitrix/main.interface.grid/.default/script.min.js?151131648433670*/

//# sourceMappingURL=page_c8780a7669c7facdb5f56f1745195066.map.js